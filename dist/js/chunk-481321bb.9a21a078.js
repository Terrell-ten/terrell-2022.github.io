(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-481321bb"],{5537:function(e,r,t){"use strict";t("ad93")},ad93:function(e,r,t){},d9c9:function(e,r,t){"use strict";t.r(r);var o=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"login"},[t("h1",{staticClass:"title"},[e._v("华项生产加工进销存系统")]),t("div",{staticClass:"form"},[t("div",{staticClass:"swiths"},[t("div",{ref:"change1",staticClass:"box1",on:{click:e.changeName}},[e._v("用户名登录")]),t("div",{ref:"change2",staticClass:"box2",on:{click:e.changePhone}},[e._v("手机号登录")])]),t("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"0",size:"medium"}},[t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.checkedName,expression:"checkedName==true"}],attrs:{label:"",prop:"username"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入账号"},nativeOn:{keyup:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.submitForm("ruleForm")}},model:{value:e.ruleForm.username,callback:function(r){e.$set(e.ruleForm,"username","string"===typeof r?r.trim():r)},expression:"ruleForm.username"}},[t("i",{staticClass:"el-input__icon el-icon-user",attrs:{slot:"prefix"},slot:"prefix"})])],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==e.isSwitch,expression:"isSwitch==true"}],attrs:{label:"",prop:"phone"}},[t("el-input",{attrs:{autocomplete:"off",placeholder:"请输入手机号"},nativeOn:{keyup:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.submitForm("ruleForm")}},model:{value:e.ruleForm.phone,callback:function(r){e.$set(e.ruleForm,"phone","string"===typeof r?r.trim():r)},expression:"ruleForm.phone"}},[t("i",{staticClass:"el-input__icon el-icon-phone",attrs:{slot:"prefix"},slot:"prefix"})])],1),t("el-form-item",{attrs:{label:"",prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"请输入密码"},nativeOn:{keyup:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.submitForm("ruleForm")}},model:{value:e.ruleForm.password,callback:function(r){e.$set(e.ruleForm,"password","string"===typeof r?r.trim():r)},expression:"ruleForm.password"}},[t("i",{staticClass:"el-input__icon el-icon-lock",attrs:{slot:"prefix"},slot:"prefix"})])],1),t("div",{staticClass:"line"},[t("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:1==e.checkedName,expression:"checkedName==true"}],on:{change:e.selectChange},model:{value:e.checked,callback:function(r){e.checked=r},expression:"checked"}},[e._v("记住用户名")]),t("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:1==e.isSwitch,expression:"isSwitch==true"}],on:{change:e.selectChangePhone},model:{value:e.checkedPhone,callback:function(r){e.checkedPhone=r},expression:"checkedPhone"}},[e._v("记住手机号")]),t("div",[t("span",{staticClass:"forget",on:{click:e.forget}},[e._v("忘记密码")])])],1),t("el-form-item",[t("el-button",{staticClass:"submit",attrs:{type:"primary",disabled:e.loading},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("登录")])],1)],1)],1)])},s=[],i=(t("d3b7"),t("b64b"),{name:"Login",data:function(){return{checked:!1,checkedPhone:!1,checkedName:!0,loading:!1,isSwitch:!1,ruleForm:{username:"",password:"",phone:"",hxUserId:"",hxUserSecretkey:""},message_b:null,rules:{phone:[{required:!1,message:"请输入手机号",trigger:"blur"}],username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:32,message:"长度在 6 到 32 个字符",trigger:"blur"}]},redirect:void 0,otherQuery:{}}},created:function(){var e=this.$cookie.get("name"),r=this.$cookie.get("phone");e&&(this.ruleForm.username=e,this.checked=!0),r&&(this.ruleForm.phone=r,this.checkedPhone=!0)},watch:{$route:{handler:function(e){var r=e.query;r&&(this.redirect=r.redirect,this.otherQuery=this.getOtherQuery(r),void 0!==this.otherQuery.hxUserId&&void 0!==this.otherQuery.hxUserSecretkey&&(this.ruleForm.hxUserId=this.otherQuery.hxUserId,this.ruleForm.hxUserSecretkey=this.otherQuery.hxUserSecretkey,this.ruleForm.hxLoginBoolean="2",this.thirdLogin()))},immediate:!0}},methods:{thirdLogin:function(){var e=this;e.loading=!0;var r={hxUserId:e.ruleForm.hxUserId,hxUserSecretkey:e.ruleForm.hxUserSecretkey};e.$store.dispatch("user/thirdLogin",r).then((function(){e.loading=!1,e.$router.push({path:e.redirect||"/"},(function(){}))})).catch((function(r){e.loading=!1}))},forget:function(){this.$alert("请找系统管理员重置",{confirmButtonText:"确定"})},changePhone:function(){this.$refs.change2.style.color="#fff",this.$refs.change1.style.color="antiquewhite",this.isSwitch=!0,this.checkedName=!1,this.ruleForm.password=""},changeName:function(){this.$refs.change2.style.color="antiquewhite",this.$refs.change1.style.color="#fff",this.checkedName=!0,this.isSwitch=!1,this.ruleForm.password=""},selectChangePhone:function(){this.checkedPhone?""!==this.ruleForm.phone&&this.$cookie.set("phone",this.ruleForm.phone,"0"):this.$cookie.delete("phone")},selectChange:function(){this.checked?""!==this.ruleForm.username&&this.$cookie.set("name",this.ruleForm.username,"0"):this.$cookie.delete("name")},submitForm:function(e){var r=this,t=this;t.$refs[e].validate((function(e){if(!e)return!1;t.loading=!0,r.checked&&r.$cookie.set("name",r.ruleForm.username,"0"),r.checkedPhone&&r.$cookie.set("phone",r.ruleForm.phone,"0");var o={};r.checkedName&&(o={username:t.ruleForm.username,password:t.ruleForm.password}),r.isSwitch&&(o={phone:t.ruleForm.phone,password:t.ruleForm.password}),t.$store.dispatch("user/login",o).then((function(e){t.$store.commit("app/APP_MAIN_LOADING",!1),t.loading=!1,200===e.code?location.reload():r.message_b.close()})).catch((function(e){r.message_b.close(),t.loading=!1}))}))},getOtherQuery:function(e){return Object.keys(e).reduce((function(r,t){return"redirect"!==t&&(r[t]=e[t]),r}),{})}}}),n=i,c=(t("5537"),t("2877")),a=Object(c["a"])(n,o,s,!1,null,"0f50702c",null);r["default"]=a.exports}}]);