(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2c5b31a5"],{"2dd1":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingWeb,expression:"loadingWeb"}],staticClass:"main-conent main-conent-minheight flex-main-conent",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[a("div",{staticClass:"flex-box"},[a("div",{staticClass:"flex-top"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0},model:{value:t.formQuery,callback:function(e){t.formQuery=e},expression:"formQuery"}},[a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"日期从："}},[a("div",{staticClass:"block"},[a("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",align:"right",placeholder:"开始日期","value-format":"yyyy-MM-dd","picker-options":{disabledDate:t.starDataMax}},model:{value:t.formQuery.startDate,callback:function(e){t.$set(t.formQuery,"startDate",e)},expression:"formQuery.startDate"}}),t._v(" - "),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",align:"right",placeholder:"结束时间","value-format":"yyyy-MM-dd","picker-options":{disabledDate:t.endDataMin}},model:{value:t.formQuery.endDate,callback:function(e){t.$set(t.formQuery,"endDate",e)},expression:"formQuery.endDate"}})],1)]),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"工厂名称："}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:t.formQuery.factoryId,callback:function(e){t.$set(t.formQuery,"factoryId",e)},expression:"formQuery.factoryId"}},t._l(t.FactoryNameList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.factoryName,value:t.id}})})),1)],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"供应商名称："}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:t.formQuery.supplierId,callback:function(e){t.$set(t.formQuery,"supplierId",e)},expression:"formQuery.supplierId"}},t._l(t.tableOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.namecode,value:t.id}})})),1)],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"状态："}},[a("el-select",{attrs:{placeholder:"状态"},on:{change:t.onSubmit},model:{value:t.formQuery.nodetype,callback:function(e){t.$set(t.formQuery,"nodetype",e)},expression:"formQuery.nodetype"}},t._l(t.stateList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.namecode,value:t.id}})})),1)],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"采购类型："}},[a("el-select",{attrs:{clearable:"",placeholder:"采购类型"},on:{change:t.onSubmit},model:{value:t.formQuery.type,callback:function(e){t.$set(t.formQuery,"type",e)},expression:"formQuery.type"}},[a("el-option",{attrs:{label:"公司采购",value:102302}}),a("el-option",{attrs:{label:"工厂采购",value:102301}})],1)],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"订单编号："}},[a("el-input",{model:{value:t.formQuery.orderNo,callback:function(e){t.$set(t.formQuery,"orderNo",e)},expression:"formQuery.orderNo"}})],1),a("el-form-item",{staticClass:"overall",staticStyle:{"margin-right":"30px"}},[a("el-button",{attrs:{type:"primary",loading:t.loadingQuery},on:{click:t.onSubmit}},[t._v("查询")])],1),t.buttonPermissions.indexOf(10056)>=0?[a("el-form-item",{staticClass:"overall",staticStyle:{"margin-right":"30px"}},[[101601].indexOf(t.formQuery.nodetype)>=0?a("el-button",{attrs:{type:"primary",loading:t.loadingQuery},on:{click:function(e){return t.clickProcurement()}}},[t._v(" "+t._s("批量确认通过")+" ")]):t._e()],1)]:t._e(),t.buttonPermissions.indexOf(10057)>=0?[[101601].indexOf(t.formQuery.nodetype)>=0?a("el-form-item",{staticClass:"overall",staticStyle:{"margin-right":"30px"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.rejectClick(0)}}},[t._v(t._s("批量驳回"))])],1):t._e()]:t._e()],2)],1),a("div",{staticClass:"flex-cont"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingTab,expression:"loadingTab"}],ref:"TableData",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",height:"100%",stripe:"","tooltip-effect":"dark","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[t.searchCleOderBool?t._e():a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"id",label:"标识",width:"50",align:"center"}}),a("el-table-column",{attrs:{prop:"orderNo",label:"订单编号",align:"center"}}),a("el-table-column",{attrs:{property:"optdate",label:"日期",align:"center"}}),a("el-table-column",{attrs:{property:"factoryName",label:"工厂名称",align:"center"}}),a("el-table-column",{attrs:{property:"amount",label:"费用总金额（元）",align:"center"}}),a("el-table-column",{attrs:{property:"planner",label:"计划人",align:"center"}}),a("el-table-column",{attrs:{property:"auditUser",label:"审核人",align:"center"}}),a("el-table-column",{attrs:{property:"supplierName",label:"供应商名称",align:"center"}}),a("el-table-column",{attrs:{property:"settypeName",label:"采购类型",align:"center"}}),a("el-table-column",{attrs:{property:"nodetypeName",label:"状态",align:"center"}}),a("el-table-column",{attrs:{property:"lastdate",label:" 最迟交货期",align:"center"}}),a("el-table-column",{attrs:{property:"postil",label:"备注",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",[t._v(t._s(e.row.postil))])]),[101601].indexOf(t.formQuery.nodetype)>=0?[e.row.postil?a("span",[t._v(t._s(t._f("postil_substring")(e.row.postil,6))+" "),a("i",{staticClass:"el-icon-edit",staticStyle:{color:"dodgerblue","margin-left":"2px",cursor:"pointer"},on:{click:function(a){return t.clickPostil(e.row,2)}}})]):a("a",{staticStyle:{cursor:"pointer",color:"dodgerblue"},on:{click:function(a){return t.clickPostil(e.row,2)}}},[t._v("备注")])]:a("span",[t._v(t._s(t._f("postil_substring")(e.row.postil,6)))])],2)]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-dropdown",{attrs:{size:"small"}},[a("el-button",{attrs:{type:"primary"}},[t._v(" 菜单"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(a){return t.clickDetail(e.row)}}},[t._v("查看明细")]),a("el-dropdown-item",{directives:[{name:"show",rawName:"v-show",value:"待确认"===e.row.nodetypeName,expression:"scope.row.nodetypeName==='待确认'"}],nativeOn:{click:function(a){return t.clickLatestDate(e.row)}}},[t._v("修改最迟交货期")]),[101600,101605,101601].indexOf(Number(e.row.nodetype))>=0&&t.buttonPermissions.indexOf(10083)>=0?a("el-dropdown-item",{nativeOn:{click:function(a){return t.cancelProduction(1,e.row.id)}}},[t._v("取 消")]):t._e()],1)],1)]}}])})],1)],1),a("div",{staticClass:"flex-button"},[a("div",{staticClass:"margin-t16 text-right"},[a("AppPaging",{attrs:{total:t.allTate,pageSize:t.paramData.pageSize,currentPage:t.paramData.page,layout:"total,sizes,prev, pager, next"},on:{handleCurrentChange:t.clickCurrentChange,handleSizeChange:t.clickSizeChange}})],1)])]),a("el-dialog",{attrs:{title:"公司采购计划单管理-查看明细",visible:t.outerVisible,width:"86%"},on:{"update:visible":function(e){t.outerVisible=e}}},[a("div",{staticClass:"detail_top"},[a("div",[t._v("订单编号："+t._s(t.purchaseDetali.namecode))]),a("div",[t._v("生成日期："+t._s(t.purchaseDetali.optdate))]),a("div",[t._v("工厂名称："+t._s(t.purchaseDetali.factoryName))]),a("div",[t._v("计划人："+t._s(t.purchaseDetali.planner))]),a("div",[t._v("审核人："+t._s(t.purchaseDetali.auditUser))]),a("div",[t._v("费用总金额："+t._s(t.purchaseDetali.amount)+"（元）")]),a("div",[t._v("最迟交货期："+t._s(t.purchaseDetali.lastdate))]),a("div",[t._v("供应商名称："+t._s(t.purchaseDetali.supplierName))]),a("div",[t._v("状态："+t._s(t.purchaseDetali.nodetypeName))])]),a("div",{staticStyle:{display:"flex","justify-content":"flex-end","margin-bottom":"15px"}},[[101600,101605,101601].indexOf(t.paramData.nodetype)>=0&&t.buttonPermissions.indexOf(10084)>=0?a("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.cancelProductionDetails(3)}}},[t._v("批量勾选取消")]):t._e()],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.purchasePlanDetailList,border:"",stripe:""}},[a("el-table-column",{attrs:{property:"namecode",label:"产品名称",align:"center"}}),a("el-table-column",{attrs:{property:"specif",label:"规格",align:"center"}}),a("el-table-column",{attrs:{property:"unit",label:"单位",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{},[t._v(t._s(e.row.unit))])]}}])}),a("el-table-column",{attrs:{property:"num",label:"数量",align:"center"}}),a("el-table-column",{attrs:{property:"amount",label:"金额（元）",align:"center"}}),a("el-table-column",{attrs:{property:"miniNum",label:"起订量",align:"center"}}),a("el-table-column",{attrs:{property:"price",label:"采购单价（元）",align:"center"}}),a("el-table-column",{attrs:{property:"stock",label:"库存",align:"center"}}),a("el-table-column",{attrs:{property:"nodetypeName",label:"状态",align:"center"}}),a("el-table-column",{attrs:{property:"postil",label:"备注",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",[t._v(t._s(e.row.postil?e.row.postil:"(点击修改)"))])]),["101601"].indexOf(t.purchaseDetali.nodetype)>=0?[e.row.postil?a("span",[t._v(t._s(t._f("postil_substring")(e.row.postil,6))+" "),a("i",{staticClass:"el-icon-edit",staticStyle:{color:"dodgerblue","margin-left":"2px",cursor:"pointer"},on:{click:function(a){return t.clickPostil(e.row,1)}}})]):a("a",{staticStyle:{cursor:"pointer",color:"dodgerblue"},on:{click:function(a){return t.clickPostil(e.row,1)}}},[t._v("备注")])]:a("span",[t._v(t._s(t._f("postil_substring")(e.row.postil,6)))])],2)]}}])}),a("el-table-column",{attrs:{property:"nodetypeName",label:"操作",align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(a){return t.clickPaymentRecords(e.row)}}},[t._v("支付记录")]),[101600,101611,101601].indexOf(t.paramData.nodetype)>=0&&t.buttonPermissions.indexOf(10084)>=0?a("el-button",{attrs:{type:"danger"},on:{click:function(a){return t.cancelProductionDetails(1,e.row.id)}}},[t._v("取消")]):t._e()]}}])})],1),a("div",{staticClass:"dialog-footer",staticStyle:{display:"flex","justify-content":"space-between"},attrs:{slot:"footer"},slot:"footer"},[a("div",[[101601].indexOf(t.paramData.nodetype)>=0&&t.buttonPermissions.indexOf(10057)>=0?[a("span",{staticStyle:{color:"#999"}},[t._v("备注：")]),a("div",{staticStyle:{display:"inline-block","margin-right":"30px",width:"400px"}},[a("el-input",{attrs:{placeholder:"驳回原因"},model:{value:t.RejectPostil,callback:function(e){t.RejectPostil=e},expression:"RejectPostil"}})],1),a("el-button",{attrs:{size:"medium",type:"danger"},on:{click:function(e){return t.rejectClick2()}}},[t._v("驳回")])]:t._e()],2),a("div",[t.buttonPermissions.indexOf(10056)>=0?[a("el-button",{attrs:{size:"medium",disabled:[101601].indexOf(Number(t.purchaseDetali.nodetype))<0,type:"primary"},on:{click:t.detailAudit}},[[101602].indexOf(Number(t.purchaseDetali.nodetype))>=0?a("span",[t._v("确认通过")]):a("span",[t._v("提交审核")])])]:t._e(),t.buttonPermissions.indexOf(10058)>=0?[a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:t.detailExport}},[t._v("导出excel")])]:t._e(),a("el-button",{attrs:{size:"medium"},on:{click:function(e){t.outerVisible=!1}}},[t._v("返 回")])],2)])],1),a("el-dialog",{attrs:{title:t.postilDialog.stateName,visible:t.postilDialog.sync,width:"30%"},on:{"update:visible":function(e){return t.$set(t.postilDialog,"sync",e)}}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.postilDialog.value,callback:function(e){t.$set(t.postilDialog,"value",e)},expression:"postilDialog.value"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.postilDialog.sync=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.clickPostils()}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"采购计划单-支付记录",visible:t.dialogPaymentRecords,width:"86%"},on:{"update:visible":function(e){t.dialogPaymentRecords=e}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formQueryInfo}}),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.PaymentRecordsList,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"标识",align:"center",width:"60"}}),a("el-table-column",{attrs:{prop:"applyUser",label:"申请人",align:"center",width:"60"}}),a("el-table-column",{attrs:{prop:"requdate",label:"申请日期",align:"center",width:"98"}}),a("el-table-column",{attrs:{prop:"payableAmount",label:"应付金额",align:"center"}}),a("el-table-column",{attrs:{prop:"amount",label:"实付金额",align:"center"}}),a("el-table-column",{attrs:{prop:"inman",label:"付款人",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"setType",label:"状态类型",align:"center",width:"100"}}),a("el-table-column",{attrs:{prop:"optdate",label:"付款时间",align:"center"}}),a("el-table-column",{attrs:{prop:"getname",label:"收款账号",align:"center"}}),a("el-table-column",{attrs:{prop:"payDocumentUrl",label:"付款凭证",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.payDocumentUrl?a("div",t._l(e.row.payDocumentUrl,(function(t,i){return a("el-image",{key:i,staticStyle:{width:"40px",height:"40px"},attrs:{src:t,"preview-src-list":e.row.payDocumentUrl,fit:"contain"}})})),1):a("p",[t._v("-")])]}}])}),a("el-table-column",{attrs:{prop:"remarks",label:"备注",align:"center",width:"60"}})],1),a("div",{staticClass:"margin-t16 text-right"},[a("pagination",{attrs:{"current-page":t.queryInfo.page,total:t.total,layout:"prev, pager, next","page-size":t.queryInfo.pageSize},on:{handleSizeChange:t.PayhandleSizeChange,handleCurrentChange:t.PayhandleCurrentChange}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogPaymentRecords=!1}}},[t._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"添加支付记录",visible:t.dialogPayAdd,width:"40%"},on:{"update:visible":function(e){t.dialogPayAdd=e},close:t.AddPayDialogClosed}},[a("div",{staticClass:"pay_add"},[a("div",[t._v("采购单ID： "+t._s(t.AddRelaId))]),a("div",[t._v("供应商： "+t._s(t.PayEditSupplierName))])]),a("el-form",{ref:"AddPayFormRef",staticClass:"demo-form-inline formInput",attrs:{inline:!0,model:t.formPayAdd,rules:t.AddPayFormRules}},[a("el-form-item",{attrs:{label:"收付款方账号信息：",prop:"namecode"}},[a("el-input",{attrs:{clearable:""},model:{value:t.formPayAdd.namecode,callback:function(e){t.$set(t.formPayAdd,"namecode",e)},expression:"formPayAdd.namecode"}})],1),a("el-form-item",{attrs:{label:"付款金额（元）：",prop:"amount"}},[a("el-input",{attrs:{clearable:""},model:{value:t.formPayAdd.amount,callback:function(e){t.$set(t.formPayAdd,"amount",e)},expression:"formPayAdd.amount"}})],1),a("el-form-item",{attrs:{label:"状态类型：",prop:"nodetype"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择类型"},model:{value:t.formPayAdd.nodetype,callback:function(e){t.$set(t.formPayAdd,"nodetype",e)},expression:"formPayAdd.nodetype"}},[a("el-option",{attrs:{label:"预付",value:"102101"}}),a("el-option",{attrs:{label:"续付",value:"102102"}}),a("el-option",{attrs:{label:"返还抵扣",value:"102103"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium "},on:{click:function(e){t.dialogPayAdd=!1}}},[t._v("取 消")]),a("el-button",{attrs:{size:"medium ",type:"primary"},on:{click:t.PayAddClick}},[t._v("保 存")])],1)],1),a("el-dialog",{attrs:{title:"编辑支付记录",visible:t.dialogPayEdit,width:"40%"},on:{"update:visible":function(e){t.dialogPayEdit=e},close:t.editPayDialogClosed}},[a("div",{staticClass:"pay_add"},[a("div",[t._v("采购单ID："+t._s(t.AddRelaId))]),a("div",[t._v("工厂："+t._s(t.PayEditSupplierName))])]),a("el-form",{ref:"editPayFormRef",staticClass:"demo-form-inline formInput",attrs:{inline:!0,model:t.PayEditForm,rules:t.editPayFormRules}},[a("el-form-item",{attrs:{label:"收付款方账号信息：",prop:"namecode"}},[a("el-input",{model:{value:t.PayEditForm.namecode,callback:function(e){t.$set(t.PayEditForm,"namecode",e)},expression:"PayEditForm.namecode"}})],1),a("el-form-item",{attrs:{label:"付款金额（元）：",prop:"amount"}},[a("el-input",{model:{value:t.PayEditForm.amount,callback:function(e){t.$set(t.PayEditForm,"amount",e)},expression:"PayEditForm.amount"}})],1),a("el-form-item",{attrs:{label:"状态类型：",prop:"nodetype"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择类型"},model:{value:t.PayEditForm.nodetype,callback:function(e){t.$set(t.PayEditForm,"nodetype",e)},expression:"PayEditForm.nodetype"}},[a("el-option",{attrs:{label:"预付",value:"102101"}}),a("el-option",{attrs:{label:"续付",value:"102102"}}),a("el-option",{attrs:{label:"返还抵扣",value:"102103"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium "},on:{click:function(e){t.dialogPayEdit=!1}}},[t._v("取 消")]),a("el-button",{attrs:{size:"medium ",type:"primary"},on:{click:t.dialogPayEditSave}},[t._v("保 存")])],1)],1),a("el-dialog",{attrs:{title:"添加采购计划单",visible:t.dialogFormVisibleAdd,width:"86%"},on:{"update:visible":function(e){t.dialogFormVisibleAdd=e}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0},model:{value:t.formPurchase,callback:function(e){t.formPurchase=e},expression:"formPurchase"}},[a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"计划人:"}},[a("span",[t._v(t._s(t.name))])]),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"审核人:"}},[a("span",[t._v(t._s(t.name))])]),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"工厂名称:"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:t.formPurchase.factoryId,callback:function(e){t.$set(t.formPurchase,"factoryId",e)},expression:"formPurchase.factoryId"}},t._l(t.factoryList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.factoryName,value:t.id}})})),1)],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"计划日期: "}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.formPurchase.optdate,callback:function(e){t.$set(t.formPurchase,"optdate",e)},expression:"formPurchase.optdate"}})],1)]),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"交货日期："}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.formPurchase.lastdate,callback:function(e){t.$set(t.formPurchase,"lastdate",e)},expression:"formPurchase.lastdate"}})],1)])],1),a("div",[t._v("添加采购计划单（添加包材）： "),a("el-button",{attrs:{type:"primary"},on:{click:t.clickPlanGoods}},[t._v("添加")])],1),a("el-table",{attrs:{data:t.dataNewPlanGoods,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),a("el-table-column",{attrs:{property:"namecode",label:"商品名称",align:"center"}}),a("el-table-column",{attrs:{property:"specif",label:"规格",align:"center"}}),a("el-table-column",{attrs:{property:"price",label:"单价(元)",align:"center"}}),a("el-table-column",{attrs:{property:"unit",label:"单位",align:"center"}}),a("el-table-column",{attrs:{property:"num",label:"计划数量",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{model:{value:e.row.num,callback:function(a){t.$set(e.row,"num",a)},expression:"scope.row.num"}})]}}])}),a("el-table-column",{attrs:{property:"miniNum",label:"起订量",align:"center"}}),a("el-table-column",{attrs:{property:"amount",label:"金额(元)",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s((e.row.num*e.row.price).toFixed(2)))])]}}])}),a("el-table-column",{attrs:{property:"name",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{cursor:"pointer"},attrs:{type:"danger"},on:{click:function(a){return t.delePurchase(e.row.id)}}},[t._v("删除")])]}}])})],1),a("el-dialog",{attrs:{width:"80%",title:"添加采购计划单-添加包材",visible:t.innerVisiblePlanGoods,"append-to-body":""},on:{"update:visible":function(e){t.innerVisiblePlanGoods=e}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0},model:{value:t.formPurchase,callback:function(e){t.formPurchase=e},expression:"formPurchase"}},[a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"供应商:"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},on:{change:t.supplierList,clear:t.supplierListClear},model:{value:t.purchaseId,callback:function(e){t.purchaseId=e},expression:"purchaseId"}},t._l(t.options,(function(t){return a("el-option",{key:t.id,attrs:{label:t.namecode,value:t.id}})})),1)],1)],1),a("el-table",{attrs:{data:t.dataPlanGoods,border:"",stripe:""}},[a("el-table-column",{attrs:{property:"name",label:"操作",width:"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{cursor:"pointer"},attrs:{type:"primary",disabled:e.row.states},on:{click:function(a){return t.clicPlanGoods(e.row)}}},[t._v("添加")])]}}])}),a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"}}),a("el-table-column",{attrs:{property:"namecode",label:"包材名称",align:"center"}}),a("el-table-column",{attrs:{property:"specif",label:"规格",width:"200",align:"center"}}),a("el-table-column",{attrs:{property:"unit",label:"单位",align:"center"}}),a("el-table-column",{attrs:{property:"price",label:"采购单价(元)",align:"center"}}),a("el-table-column",{attrs:{property:"miniNum",label:"起订量",align:"center"}}),a("el-table-column",{attrs:{property:"stock",label:"库存数",align:"center"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisibleAdd=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.putPurchase}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"修改最迟交货期",visible:t.dialogVisibleDate,width:"30%"},on:{"update:visible":function(e){t.dialogVisibleDate=e}}},[a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.latestDataTime,callback:function(e){t.latestDataTime=e},expression:"latestDataTime"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisibleDate=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.clickDates()}}},[t._v("确 定")])],1)],1),a("el-dialog",{staticStyle:{"margin-top":"15vh"},attrs:{title:"导出提示",visible:t.dialogExport,width:"30%"},on:{"update:visible":function(e){t.dialogExport=e}}},[a("span",[t._v(t._s(t.ExportHints))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.dialogExportClick}},[t._v("确 定")])],1)]),a("UpUnit",{ref:"UpUnit",on:{output_unit:t.output_unit}}),a("el-dialog",{attrs:{title:"",visible:t.GoodsModifyDemo.sync,width:"50%"},on:{"update:visible":function(e){return t.$set(t.GoodsModifyDemo,"sync",e)}}},[a("el-form",{staticClass:"demo-form-inline GoodsModifycss",attrs:{"label-position":"left"}},[a("div",{staticStyle:{display:"flex"}},[a("el-form-item",{staticStyle:{"margin-right":"30px",width:"40%"},attrs:{"label-width":"80px",label:"产品名称:"}},[t._v(t._s(t.GoodsModifyDemo.data.namecode))]),a("el-form-item",{staticStyle:{"margin-right":"30px",width:"30%"},attrs:{label:"规格:"}},[t._v(" "+t._s(t.GoodsModifyDemo.data.specif))])],1),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{margin:"0 15px 0 0"},attrs:{label:"工厂名称:"}},[a("span",[t._v(t._s(t.GoodsModifyDemo.data.factoryName))])])],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticStyle:{margin:"0 15px 0 0"},attrs:{label:"起订量:"}},[a("span",[t._v(t._s(t.GoodsModifyDemo.data.miniNum))])])],1),a("el-col",{attrs:{span:4}},[a("el-form-item",{staticStyle:{margin:"0 15px 0 0"},attrs:{label:"单位:"}},[a("span",[t._v(t._s(t.GoodsModifyDemo.data.unit))])])],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticStyle:{margin:"0 0px 0 0"},attrs:{label:"采购单价:","label-width":"80px"}},[a("span",[t._v(t._s(t.GoodsModifyDemo.data.price))])])],1)],1),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{margin:"0 0px 0 0"},attrs:{label:"华项库存:"}},[a("span",[t._v(t._s(t.GoodsModifyDemo.setdata.hxInventory||0))])])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{margin:"0 0px 0 0"},attrs:{label:"当前库存:"}},[a("span",[t._v(t._s(t.GoodsModifyDemo.setdata.inventory||0))])])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{margin:"0 0px 0 0"},attrs:{label:"金额:","label-width":"60px"}},[a("el-input-number",{staticStyle:{display:"none"},attrs:{min:0},model:{value:t.GoodsModifyDemo.data.amount_modify,callback:function(e){t.$set(t.GoodsModifyDemo.data,"amount_modify",e)},expression:"GoodsModifyDemo.data.amount_modify"}}),a("el-input",{attrs:{type:"number"},model:{value:t.GoodsModifyDemo.data.amount_modify,callback:function(e){t.$set(t.GoodsModifyDemo.data,"amount_modify",e)},expression:"GoodsModifyDemo.data.amount_modify"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{margin:"0 0px 0 0"},attrs:{label:"待采购数量:"}},[a("span",[t._v(t._s(t.GoodsModifyDemo.setdata.waitnum||"0"))])])],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{margin:"0 0px 0 0"},attrs:{label:"正在采购数量:"}},[a("span",[t._v(t._s(t.GoodsModifyDemo.setdata.propnum||"0"))])])],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticStyle:{margin:"0 0px 0 0"},attrs:{label:"已补库存数:"}},[a("span",[t._v(t._s(t.GoodsModifyDemo.setdata.bknum||"0"))])])],1)],1),a("el-row",[a("el-col",{attrs:{span:7}},[a("el-form-item",{staticStyle:{margin:"0 0px 0 0"},attrs:{label:"采购数量:","label-width":"100px"}},[a("el-input-number",{staticStyle:{display:"none"},attrs:{min:0},model:{value:t.GoodsModifyDemo.data.num_modify,callback:function(e){t.$set(t.GoodsModifyDemo.data,"num_modify",e)},expression:"GoodsModifyDemo.data.num_modify"}}),a("el-input",{attrs:{type:"number"},model:{value:t.GoodsModifyDemo.data.num_modify,callback:function(e){t.$set(t.GoodsModifyDemo.data,"num_modify",e)},expression:"GoodsModifyDemo.data.num_modify"}})],1)],1)],1),a("el-row",[a("el-form-item",{staticStyle:{margin:"0 0px 0 0"},attrs:{label:"备注:"}},[a("span",[t._v(t._s(t.GoodsModifyDemo.data.postil))])])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.setGoodsModify}},[t._v("确 定")]),a("el-button",{attrs:{size:"medium"},on:{click:function(e){t.GoodsModifyDemo.sync=!1}}},[t._v("返 回")])],1)],1),a("el-dialog",{attrs:{width:"25%",title:"驳回",visible:t.rejectData.sync,"append-to-body":""},on:{"update:visible":function(e){return t.$set(t.rejectData,"sync",e)}}},[""==t.RejectId?a("el-input",{attrs:{placeholder:"请输入驳回理由"},model:{value:t.rejectData.val,callback:function(e){t.$set(t.rejectData,"val",e)},expression:"rejectData.val"}}):a("span",[t._v("你确定要对已选的数据进行驳回吗？")]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.rejectData.sync=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.rejectClick(1)}}},[t._v("确 定")])],1)],1)],1)},n=[],o=a("1da1"),r=a("5530"),s=(a("96cf"),a("d3b7"),a("159b"),a("b0c0"),a("25f0"),a("b64b"),a("d81d"),a("7c58")),l=a("062d"),c=a("ba10"),d=a("2f62"),u=a("4795"),m=a("faca"),p=a("0ad1"),f=a("2f88"),h={components:{UpUnit:p["a"],AppPaging:f["a"],pagination:m["a"]},data:function(){return{scrollTop:0,scrollLeft:0,RejectId:"",table_id_arr:[],RejectPostil:"",table_id_arr_detail:[],table_plan_arr_detail:[],rejectData:{param:{},sync:!1,val:""},clickDetail_id:"",GoodsModifyDemo:{sync:!1,data:{price_demo:"",unit_modify:"",num_modify:"",amount_modify:"",price_modify:""},setdata:{},paramData:{}},click_settype:"",click_factoryId:"",postilDialog:{type:0,sync:!1,stateName:"修改备注",value:"",row:{},id:""},conversionRatio:"",unitBitstr:"",Nowid:"",NowUnit:"",editUnit:"",isunitList:!1,unitList:[],loadingWeb:!0,batchList:[],gridData:[],outerVisible:!1,innerVisible:!1,loadingTab:!1,loadingQuery:!1,svalue1:"",svalue2:"",info:{isTrue:!1,isShow:!0},checked:!1,value1:"",value2:"",tableData:[],stateList:[],searchCleOderBool:!1,formQuery:{supplierId:"",nodetype:101601,timeData:"",factoryId:"",orderNo:""},allTate:0,currentPage:1,paramData:{page:1,pageSize:24},multipleSelection:[],purchaseDetali:{},dialogFormVisibleAdd:!1,formPurchase:{lastdate:"",optdate:"",id:"",factoryId:"",packMaterialInfoList:[],supplierId:""},tableOptions:[],FactoryNameList:[],options:[],factoryList:[],factoryId:"",purchaseId:"",dataPlanGoods:[],dataNewPlanGoods:[],loadingPutPurchase:!1,updateId:"",innerVisiblePlanGoods:!1,idList:[],DetailId:[],ConfirmPurchaseId:[],dialogExport:!1,ExportHints:"",purchasePlanDetailList:[],DetailParameter:{optId:"",factoryId:"",planId:"",purchaseType:"",instantOutbound:!0},dialogPaymentRecords:!1,PaymentRecordsList:[],formQueryInfo:{supplierId:"",timeData:""},AddPayFormRules:{namecode:[{required:!0,message:"请输入收付款方账号信息",trigger:"blur"}],amount:[{required:!0,message:"请输入付款金额",trigger:"blur"}],nodetype:[{required:!0,message:"请选择类型",trigger:"blur"}]},dialogPayAdd:!1,AddRelaId:"",manufacturerId:"",formPayAdd:{namecode:"",amount:"",nodetype:""},queryInfo:{page:1,pageSize:24},total:0,dialogPayEdit:!1,PayEditForm:{},PayEditSupplierName:"",editPayFormRules:{namecode:[{required:!0,message:"请输入收付款方账号信息",trigger:"blur"}],amount:[{required:!0,message:"请输入付款金额",trigger:"blur"}],nodetype:[{required:!0,message:"请选择类型",trigger:"blur"}]},EditPayId:"",dialogVisibleDate:!1,latestDataTime:"",buttonPermissions:[],total_queryInfo:0,rela:""}},computed:Object(r["a"])({},Object(d["c"])({roles:"roles",userId:"user/userId",name:"user/name"})),created:function(){this.buttonPermissions=this.roles[0].buttonPermissions,this.provinceList=this.data;var t=this.changeData();this.provinceList=this.data,this.onSubmit(),this.getSupplierList(),this.getFactoryList(),this.getFactoryName(),this.formQueryInfo.timeData=t},mounted:function(){this.init_StateList()},methods:{get_getPurchorderPaymentList:function(t){var e=this;Object(c["F"])(t).then((function(t){if(200===t.code){var a=t.data||{};e.PaymentRecordsList=a.list||[],e.total_queryInfo=a.total||0,e.PaymentRecordsList.forEach((function(t){var e=t.vdata||{};t.payDocumentUrl=e.payDocumentUrl||"",t.remarks=e.remarks||""}))}}))},clickPaymentRecords:function(t){this.rela=t.id,this.dialogPaymentRecords=!0,this.queryInfo.rela=t.id,this.queryInfo.page=1,this.get_getPurchorderPaymentList(this.queryInfo),this.AddRelaId=t.id,this.PayEditSupplierName=t.supplierName,this.manufacturerId=t.supplierId},PayhandleSizeChange:function(t){this.queryInfo.pageSize=t,this.PayhandleCurrentChange(1)},PayhandleCurrentChange:function(t){this.queryInfo.page=t,this.get_getPurchorderPaymentList(this.queryInfo)},detailsSelectionChange:function(t){var e=this;this.table_id_arr_detail=[],this.table_plan_arr_detail=[],t.length>0&&(this.table_plan_arr_detail=t,t.forEach((function(t){e.table_id_arr_detail.push(t.id)})))},cancelProductionDetails:function(t,e){var a=this,i={operator:this.name,planId:this.idLists,remarks:""},n="你确定要取消选中的包材吗？";if(1===t&&(i.planDetailIds=[e]),3===t){if(this.table_id_arr_detail.length<=0)return void this.$message.warning("请您选择要操作的数据！");n="你确定要取消当前选中的"+this.table_id_arr_detail.length+"个包材吗？",i.planDetailIds=this.table_id_arr_detail}this.$confirm(n,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",showInput:!0,inputPlaceholder:"请输入取消原因"}).then((function(t){i.remarks=t.value,Object(s["d"])(i).then((function(t){200===t.code&&(a.$message.success(t.message),i.planDetailIds.length>=a.purchasePlanDetailList.length&&(a.outerVisible=!1),a.getPurchaseDetali(a.idLists),a.getTable(a.paramData))}))})).catch((function(){}))},cancelProduction:function(t,e){var a=this,i={operator:this.name,remarks:""},n="你确定要取消当前的采购计划单吗？";if(1===t&&(i.planId=e),3===t){if(this.table_id_arr.length<=0)return void this.$message.warning("请您选择要操作的数据！");n="你确定要取消当前选中的"+this.table_id_arr.length+"条采购计划单吗？",i.planId=this.table_id_arr}this.$confirm(n,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",showInput:!0,inputPlaceholder:"请输入取消原因"}).then((function(t){i.remarks=t.value,a.set_cancelPurchasePlan(i)})).catch((function(){}))},set_cancelPurchasePlan:function(t){var e=this;Object(s["c"])(t).then((function(t){200===t.code&&(e.$message.success(t.message),e.outerVisible=!1,e.getTable(e.paramData))}))},starDataMax:function(t){if(this.formQuery.endDate)return t.getTime()>=Date.parse(this.formQuery.endDate)},endDataMin:function(t){if(this.formQuery.startDate)return t.getTime()<=Date.parse(this.formQuery.startDate)-828e5},rejectClick:function(t){if(0===t||2===t){if(!this.table_id_arr.length)return void this.$message({type:"warning",message:"请您选择要操作的数据！"});0===t&&(this.RejectId=""),this.rejectData.sync=!0,this.rejectData.val="",this.rejectData.param={planId:this.table_id_arr,status:101605},2===t&&(this.rejectData.val=this.RejectPostil||"")}if(1===t){var e={I_postil:this.rejectData.val||"",I_ids:this.rejectData.param.planId.toString(),I_optuser:this.name,I_optType:"101605"};this.get_I_purchase_plan(e)}},set_auditPurchPlan:function(t){var e=this;Object(s["b"])(t).then((function(t){e.loadingWeb=!1,200===t.code?(e.$message.success("驳回成功!"),e.paramData.page=1,e.getTable(e.paramData),e.outerVisible=!1,e.rejectData.sync=!1):e.$message.warning(t.message)}))},rejectClick2:function(){this.RejectId=this.clickDetail_id,this.table_id_arr=[],this.table_id_arr.push(this.RejectId),this.rejectClick(2)},setGoodsModify:function(){var t=this,e={planDetailId:this.GoodsModifyDemo.data.id},a=!0;this.GoodsModifyDemo.data.amount_modify!==this.GoodsModifyDemo.data.amount&&(e.amount=this.GoodsModifyDemo.data.amount_modify,a=!1),this.GoodsModifyDemo.data.num_modify!==this.GoodsModifyDemo.data.num&&(e.num=this.GoodsModifyDemo.data.num_modify,a=!1),a?this.GoodsModifyDemo.sync=!1:(e.unit=this.GoodsModifyDemo.data.unit,e.unitBit=this.GoodsModifyDemo.data.unitbit,e.num=this.GoodsModifyDemo.data.num_modify,e.amount=this.GoodsModifyDemo.data.amount_modify,Object(s["fb"])(e).then((function(e){200===e.code&&(t.$message.success("修改成功！"),t.getPurchaseDetali(t.clickDetail_id),t.GoodsModifyDemo.sync=!1)})))},clickDetail:function(t){this.outerVisible=!0,this.clickDetail_id=t.id,this.getPurchaseDetali(t.id),this.RejectPostil=t.postil,this.click_settype=t.settype,this.click_factoryId=t.factoryId,this.DetailParameter={optId:this.userId,factoryId:t.factoryId,planId:t.id,purchaseType:t.settype,instantOutbound:!0},this.DetailId=t.id},GoodsModifyOpen:function(t){var e=this;this.GoodsModifyDemo.data=Object(r["a"])(Object(r["a"])({},this.GoodsModifyDemo.data),t),this.GoodsModifyDemo.data.unit_modify=this.GoodsModifyDemo.data.unit,this.GoodsModifyDemo.data.num_modify=this.GoodsModifyDemo.data.num,this.GoodsModifyDemo.data.price_modify=this.GoodsModifyDemo.data.price,this.GoodsModifyDemo.data.unitbit_d=this.GoodsModifyDemo.data.unitbit,this.GoodsModifyDemo.data.amount_modify=this.GoodsModifyDemo.data.amount,this.GoodsModifyDemo.sync=!0;var a={pid:t.id,factoryId:this.click_factoryId,nodeType:this.click_settype,productId:t.productId};Object(s["q"])(a).then((function(t){200===t.code&&(e.GoodsModifyDemo.setdata=t.data||{})}))},goProductplan:function(t){this.$router.push({path:t,query:{path:!0}})},init_StateList:function(){this.stateList=[{id:101600,namecode:"未提交"},{id:101601,namecode:"待确认"},{id:101602,namecode:"确认采购"},{id:101603,namecode:"已完成"},{id:101605,namecode:"驳回"},{id:101606,namecode:"已取消"}]},init_getStateList:function(){var t=this;Object(s["N"])().then((function(e){200===e.code&&(t.stateList=e.data)}))},clickPostil:function(t,e){this.postilDialog.sync=!0,this.postilDialog.value=t.postil,this.postilDialog.row=t,this.postilDialog.id=t.id,this.postilDialog.type=e},clickPostils:function(){var t=this;""===this.postilDialog.value&&this.$message.warning("备注内容不能为空");var e=this.postilDialog.row.vdata||{};e.postil=this.postilDialog.value;var a={id:this.postilDialog.id,remarks:this.postilDialog.value,postscript:e};1===this.postilDialog.type?Object(s["eb"])(a).then((function(e){200===e.code&&t.clickPostils_demo(1,a)})):2===this.postilDialog.type?Object(s["hb"])(a).then((function(e){200===e.code&&t.clickPostils_demo(2,a)})):this.$message.success("更多功能，尚未开发")},clickPostils_demo:function(t,e){this.postilDialog.sync=!1;var a=[];1===t?a=this.purchasePlanDetailList:2===t&&(a=this.tableData);for(var i=0;i<a.length;i++)a[i].id===e.id&&(a[i].postil=e.remarks);this.$message.success("添加备注成功")},output_unit:function(t){this.unitBitstr=t.data,this.editUnit=t.namecode;var e={detailId:this.Nowid,unit:this.editUnit,unitBit:this.unitBitstr};this.save_Unit(e)},save_Unit:function(t){var e=this;Object(s["gb"])(t).then((function(t){200===t.code?(e.$message({message:"修改单位成功！",type:"success"}),e.getPurchaseDetali(e.clickDetail_id),e.getTable(e.paramData),e.isunitList=!1):e.$message({message:t.message,type:"warning"})}))},gotounit2:function(t){this.Nowid=t.id,this.NowUnit=t.unit,this.$refs["UpUnit"].InitDemo(t.data,t.unit)},upUnit:function(t){var e=this;this.unitList.forEach((function(a){a.namecode===t&&(e.conversionRatio=a.conversionRatio)}))},saveUnit:function(){var t=this;for(var e in this.unitList)this.unitList[e].namecode===this.editUnit&&(this.unitBitstr=this.unitList[e].data);Object(s["gb"])({detailId:this.Nowid,unit:this.editUnit,unitBit:this.unitBitstr}).then((function(e){200===e.code?(t.$message({message:"修改单位成功！",type:"success"}),t.getPurchaseDetali(t.clickDetail_id),t.getTable(t.paramData),t.isunitList=!1):t.$message({message:e.message,type:"warning"})}))},gotounit:function(t){var e=this;Object(s["R"])({productId:t.data,unit:t.unit}).then((function(a){200===a.code?(e.unitList=a.data,e.unitList.length>0?(e.editUnit=a.data[0].namecode,e.NowUnit=t.unit,e.Nowid=t.id,e.conversionRatio=a.data[0].conversionRatio,e.isunitList=!0):e.$message({message:"没有更多单位可以修改了",type:"warning"})):e.$message({message:a.message,type:"warning"})}))},getFactoryName:function(){var t=this;Object(l["o"])({}).then((function(e){if(200===e.code){var a=[];e.data.forEach((function(t){1!==t.data&&a.push(t)})),t.FactoryNameList=a}}))},getPurchaseDetali:function(t){var e=this,a={id:t};Object(s["B"])(a).then((function(t){200===t.code?(e.purchaseDetali=t.data,t.data.purchasePlanDetailList.list.forEach((function(t){t.postil="",t.vdata&&(t.postil=t.vdata.postil||"")})),e.purchasePlanDetailList=t.data.purchasePlanDetailList.list,e.formPurchase=t.data,e.purchaseId=t.data.supplerId+""):e.$message({message:t.message,type:"warning"})}))},getSupplierList:function(){var t=this;Object(s["P"])({}).then((function(e){200===e.code?(t.tableOptions=e.data,t.options=e.data):t.$message({message:e.message,type:"warning"})}))},getFactoryList:function(){var t=this;Object(l["o"])({}).then((function(e){200===e.code?t.factoryList=e.data:t.$message({type:"warning",message:e.message})}))},onSubmit:function(){var t=this.formQuery;[101600,101605,101601].indexOf(t.nodetype)>=0?this.searchCleOderBool=!1:this.searchCleOderBool=!0;var e=Object(r["a"])({page:1,pageSize:this.paramData.pageSize},t);delete e.timeData,Object.keys(e).forEach((function(t){var a=e[t];""===a&&delete e[t]})),this.getTable(e)},getTimeData:function(t){var e=new Date(t),a=e.getFullYear()+"-"+this.p(e.getMonth()+1)+"-"+this.p(e.getDate());return a},p:function(t){return t<10?"0"+t:t},clickProcurement:function(){if(this.idList.length<=0)this.$message({type:"warning",message:"请选择要操作的数据"});else{var t=this.idList,e={I_postil:"",I_ids:t.toString(),I_optuser:this.name,I_optType:"101601"};if([101600,101605].indexOf(this.paramData.nodetype)>=0)this.get_I_purchase_plan(e);else{if(!([101601].indexOf(this.paramData.nodetype)>=0))return void this.$message.warning("当前状态对应功能还在开发中！");e.I_optType="101602",this.get_getConfirmPurchase({idList:t})}}},detailAudit:function(){var t=[this.DetailId],e={I_postil:"",I_ids:t.toString(),I_optuser:this.name,I_optType:"101601"};if([101600,101605].indexOf(this.paramData.nodetype)>=0)this.get_I_purchase_plan({nodetype:101601},t.toString());else{if(!([101601].indexOf(this.paramData.nodetype)>=0))return void this.$message.warning("当前状态对应功能还在开发中！");e.I_optType="101602",this.get_getConfirmPurchase({idList:t})}},get_I_purchase_plan:function(t){var e=this;Object(s["a"])(t).then((function(t){200===t.code&&t.flag?t.data&&t.data[0].flag>0?(e.$message.success(t.message),e.getTable(e.paramData),e.outerVisible=!1,e.rejectData.sync=!1):e.$message.warning(t.data[0].result||t.message):e.$message.warning(t.message)}))},get_getConfirmPurchase:function(t){var e=this;Object(s["i"])(t).then((function(t){200===t.code?(e.$message.success(t.message),e.getTable(e.paramData)):e.$message.warning(t.message),e.outerVisible=!1}))},clickPlan:function(){this.loadingPutPurchase=!1,this.dialogFormVisibleAdd=!0,this.updateId="",this.dataNewPlanGoods=[],this.formPurchase={lastdate:"",optdate:"",id:"",packMaterialInfoList:[],factoryId:""},this.purchaseId=""},clickPlanGoods:function(){var t=this.formPurchase.factoryId;t?(this.innerVisiblePlanGoods=!0,this.getTable(this.paramData)):this.$notify({title:"友情提示",message:"请选择工厂！",type:"warning"})},getPurchaseMaterialList:function(t){var e=this;Object(s["D"])(t).then((function(t){200===t.code?e.dataPlanGoods=t.data.list:e.$message({type:"warning",message:t.message})}))},supplierList:function(){var t=this.purchaseId,e=this.formPurchase.factoryId,a={supplierId:t,factoryId:e};t&&this.getPurchaseMaterialList(a)},supplierListClear:function(){this.dataPlanGoods=[]},clicPlanGoods:function(t){this.$message({type:"success",message:"添加成功!"}),this.dataNewPlanGoods.push(t),t.states=!0},putPurchase:function(){var t=this.formPurchase;t.supplierId=parseInt(this.purchaseId);var e=!0;if(this.dataNewPlanGoods.length)for(var a=0;a<this.dataNewPlanGoods.length;a++)this.dataNewPlanGoods[a].num||(e=!1);else e=!1;!1!==e?(t.packMaterialInfoList=this.dataNewPlanGoods,this.loadingPutPurchase=!0,this.updateId?this.getPurchaseUpdate(t):this.putPurchaseInsert(t)):this.$message({message:"请添加供应商商品数量值",type:"warning"})},getPurchaseUpdate:function(t){var e=this;Object(s["H"])(t).then((function(t){e.dialogFormVisibleAdd=!1,e.loadingPutPurchase=!1,200===t.code?(e.$message({type:"success",message:"修改成功!"}),e.getTable(e.paramData)):e.$message({message:t.message,type:"warning"})}))},putPurchaseInsert:function(t){var e=this;Object(s["Z"])(t).then((function(t){e.dialogFormVisibleAdd=!1,e.loadingPutPurchase=!1,200===t.code?(e.getTable(e.paramData),e.$message({type:"success",message:"添加成功!"})):e.$message({message:t.message,type:"warning"})}))},dialogExportClick:function(){this.dialogExport=!1,this.$message({type:"success",message:"操作成功"})},clickLatestDate:function(t){this.dialogVisibleDate=!0,this.latestDataTime=""},clickDates:function(){this.dialogVisibleDate=!1,this.latestDataTime},getTable:function(t){var e=this;this.paramData=t,this.loadingTab=!0,Object(s["C"])(t).then((function(t){if(e.loadingWeb=!1,e.loadingQuery=!1,200===t.code){var a=t.data.list;a.forEach((function(t){t.postil="",t.rejectReason="",t.vdata&&(t.postil=t.vdata.postil||"",t.rejectReason=t.vdata.rejectReason||"")})),e.loadingTab=!1,e.allTate=t.data.total,e.currentPage=t.data.pageNum,e.tableData=a}else e.$message({message:t.message,type:"warning"})}))},clickSizeChange:function(t){this.paramData.pageSize=t,this.clickCurrentChange(1)},clickCurrentChange:function(t){this.paramData.page=t,this.getTable(this.paramData)},handleSelectionChange:function(t){var e=t.map((function(t){return t.id}));this.idList=e,this.table_id_arr=e,this.batchList=t,this.multipleSelection=t},clickBatch:function(){var t=this.batchList;0===t.length&&this.$message({message:"警告哦，请选择需要处理的数据",type:"warning"})},delePurchase:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["a"])(e.dataNewPlanGoods,t),e.$message({type:"success",message:"删除成功!"})})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},inventory:function(){this.innerVisible=!0},PutInStorage:function(){var t=this,e=Object(r["a"])({},this.DetailParameter);this.$confirm("是否操作入库?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["L"])(e).then((function(e){200===e.code?(t.$message({type:"success",message:e.message}),t.onSubmit(),t.outerVisible=!1):t.$message({type:"warning",message:e.message})}))})).catch((function(){t.$message({type:"info",message:"已取消入库！"})}))},detailExport:function(){var t=this,e=this.formQuery,a={paramStr:e.paramStr,id:this.DetailId};delete a.timeData,e.startDate&&e.endDate?Object(s["S"])(a).then((function(e){200===e.code&&(t.ExportHints=e.data,t.dialogExport=!0,setTimeout((function(){t.outerVisible=!1}),1e3))})):this.$message({type:"warning",message:"请选择导出的时间跨度 ^_^"})},onSubmitPay:function(){var t=this.formQueryInfo;if(t.timeData){if(t.timeData.length){var e=t.timeData[0],a=t.timeData[1];t.startTime=e,t.endTime=a}}else delete t.startTime,delete t.endTime;var i=Object(r["a"])({},t);delete i.timeData,i.supplierId||delete i.supplierId,this.paramData=i,i.rela=this.rela,this.get_getPurchorderPaymentList(i)},clickPayAdd:function(){this.dialogPayAdd=!0},AddPayDialogClosed:function(){this.$refs.AddPayFormRef.resetFields()},PayAddClick:function(){var t=this;this.$refs.AddPayFormRef.validate(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(a){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=Object(r["a"])(Object(r["a"])({},t.formPayAdd),{},{rela:t.AddRelaId,data:t.manufacturerId,inman:t.userId}),e.next=4,Object(s["M"])(i).then((function(e){200===e.code?t.$message({type:"success",message:e.message}):t.$message({type:"warning",message:e.message})}));case 4:t.dialogPayAdd=!1,n={rela:t.AddRelaId},t.get_getPurchorderPaymentList(n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},PayhandleEdit:function(t){var e=this,a={id:t};Object(s["K"])(a).then((function(t){200===t.code?e.PayEditForm=t.data:e.$message({type:"warning",message:t.message})})),this.dialogPayEdit=!0,this.EditPayId=t},editPayDialogClosed:function(){this.$refs.editPayFormRef.resetFields()},dialogPayEditSave:function(){var t=this;this.$refs.editPayFormRef.validate(function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(a){var i,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=Object(r["a"])(Object(r["a"])({},t.PayEditForm),{},{rela:t.AddRelaId,data:t.manufacturerId,inman:t.userId,id:t.EditPayId}),e.next=4,Object(s["M"])(i).then((function(e){200===e.code?t.$message({type:"success",message:e.message}):t.$message({type:"warning",message:e.message})}));case 4:t.dialogPayEdit=!1,n={rela:t.AddRelaId},t.get_getPurchorderPaymentList(n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},PayhandleDelete:function(t){var e=this;this.$confirm("是否删除该支付记录？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function a(){var i,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return i={id:t},a.next=3,Object(s["l"])(i).then((function(t){200===t.code?e.$message({type:"success",message:t.message}):e.$message({type:"warning",message:t.message})}));case 3:n={rela:e.AddRelaId},e.get_getPurchorderPaymentList(n);case 5:case"end":return a.stop()}}),a)})))).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},getPurchaseDelete:function(t,e){var a=this;Object(s["A"])(t).then((function(t){if(a.loadingQuery=!1,a.dialogFormVisible=!1,200===t.code){var i=a.tableData;Object(u["a"])(i,e),a.$message({message:"删除成功",type:"success"})}else a.$message({message:t.message,type:"warning"})}))}},activated:function(){var t=this;setTimeout((function(){t.$refs.TableData.bodyWrapper.scrollTop=t.scrollTop,t.$refs.TableData.bodyWrapper.scrollLeft=t.scrollLeft}),60)},beforeRouteLeave:function(t,e,a){this.scrollTop=this.$refs.TableData.bodyWrapper.scrollTop,this.scrollLeft=this.$refs.TableData.bodyWrapper.scrollLeft,a()}},y=h,g=(a("f555"),a("2877")),b=Object(g["a"])(y,i,n,!1,null,"6d5cf402",null);e["default"]=b.exports},4795:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"a",(function(){return n}));a("a434");function i(t){var e=new Date(t),a=e.getMonth()+1,i=e.getDate();a>=1&&a<=9&&(a="0"+a),i>=0&&i<=9&&(i="0"+i);var n=e.getFullYear()+"-"+a+"-"+i+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();return n}function n(t,e){for(var a=t.length,i=0;i<a;i++)if(t[i].id===e)return 0===i?(t.shift(),t):i===a-1?(t.pop(),t):(t.splice(i,1),t)}},a923:function(t,e,a){},ba10:function(t,e,a){"use strict";a.d(e,"h",(function(){return o})),a.d(e,"M",(function(){return r})),a.d(e,"f",(function(){return s})),a.d(e,"g",(function(){return l})),a.d(e,"l",(function(){return c})),a.d(e,"D",(function(){return d})),a.d(e,"p",(function(){return u})),a.d(e,"E",(function(){return m})),a.d(e,"q",(function(){return p})),a.d(e,"z",(function(){return f})),a.d(e,"L",(function(){return h})),a.d(e,"r",(function(){return y})),a.d(e,"C",(function(){return g})),a.d(e,"N",(function(){return b})),a.d(e,"o",(function(){return v})),a.d(e,"y",(function(){return _})),a.d(e,"O",(function(){return P})),a.d(e,"v",(function(){return D})),a.d(e,"w",(function(){return w})),a.d(e,"m",(function(){return k})),a.d(e,"e",(function(){return O})),a.d(e,"H",(function(){return x})),a.d(e,"n",(function(){return I})),a.d(e,"t",(function(){return j})),a.d(e,"I",(function(){return S})),a.d(e,"s",(function(){return C})),a.d(e,"j",(function(){return G})),a.d(e,"k",(function(){return T})),a.d(e,"u",(function(){return $})),a.d(e,"K",(function(){return L})),a.d(e,"G",(function(){return M})),a.d(e,"c",(function(){return E})),a.d(e,"B",(function(){return N})),a.d(e,"J",(function(){return R})),a.d(e,"i",(function(){return A})),a.d(e,"A",(function(){return F})),a.d(e,"Z",(function(){return Q})),a.d(e,"X",(function(){return z})),a.d(e,"P",(function(){return B})),a.d(e,"b",(function(){return U})),a.d(e,"U",(function(){return V})),a.d(e,"S",(function(){return q})),a.d(e,"R",(function(){return W})),a.d(e,"T",(function(){return H})),a.d(e,"F",(function(){return J})),a.d(e,"d",(function(){return Y})),a.d(e,"a",(function(){return K})),a.d(e,"ab",(function(){return Z})),a.d(e,"Q",(function(){return X})),a.d(e,"Y",(function(){return tt})),a.d(e,"W",(function(){return et})),a.d(e,"x",(function(){return at})),a.d(e,"V",(function(){return it}));var i=a("5530"),n=a("83c3");function o(t){return Object(n["a"])({url:"/admin/customer/detail/schedule/getCustomerOrdersStatisticList",method:"GET",params:t})}function r(t){return Object(n["a"])({url:"/admin/excel/financeCustomerOrdersStatistic",method:"GET",params:t})}function s(t){return Object(n["a"])({url:"/admin/customer/order/getCustomer",method:"GET",params:t})}function l(t){return Object(n["a"])({url:"/admin/customer/detail/schedule/getCustomerOrdersFinanceList",method:"GET",params:t})}function c(t){return Object(n["a"])({url:"/admin/excel/financeCustomerOrdersDetail",method:"GET",params:t})}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(n["a"])({url:"/admin/data/selectByCond/I_purchase_plan_finance/find?pageNo="+e,method:"post",data:t})}function u(t){return Object(n["a"])({url:"/admin/excel/financeNormPurchase",method:"GET",params:t})}function m(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(n["a"])({url:"/admin/data/selectByCond/I_purchase_plan_details_list/find?pageNo="+e,method:"post",data:t})}function p(t){return Object(n["a"])({url:"/admin/excel/financePurchaseDetailTable",method:"GET",params:t})}function f(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(n["a"])({url:"/admin/data/selectByCond/I_purchase_warehouse/find?pageNo="+e,method:"post",data:t})}function h(t){return Object(n["a"])({url:"/admin/material/supplier/list/page",method:"post",data:Object(i["a"])(Object(i["a"])({},t),{},{pageSize:100})})}function y(t){return Object(n["a"])({url:"/admin/excel/financePurchaseWarehouseDetail",method:"GET",params:t})}function g(t){return Object(n["a"])({url:"/product/getAllProductInfo",method:"GET",params:t})}function b(t){return Object(n["a"])({url:"/admin/excel/financeDeliverOutboundDetail",method:"GET",params:t})}function v(t){return Object(n["a"])({url:"/admin/excel/financeProductionStatistical",method:"GET",params:t})}function _(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(n["a"])({url:"/admin/data/selectByCond/I_purchase_warehouse_details/findPurchaseWarehouseDetails?pageNo="+e,method:"post",data:t})}function P(t){return Object(n["a"])({url:"/admin/excel/financePurchaseStorage",method:"GET",params:t})}function D(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(n["a"])({url:"/admin/data/selectByCond/I_deliver_outbound/findDeliverOutboundList?pageNo="+e,method:"post",data:t})}function w(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(n["a"])({url:"/admin/data/selectByCond/I_deliver_outbound_details_list/findDeliverOutboundDetailsList?pageNo="+e,method:"post",data:t})}function k(t){return Object(n["a"])({url:"/admin/excel/financeDeliverOutbound",method:"GET",params:t})}function O(t){return Object(n["a"])({url:"/admin/customer/order/getCustomer",method:"GET",params:t})}function x(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(n["a"])({url:"/admin/data/selectByCond/I_outturn_plan_finance/findOutturnPlanList?pageNo="+e,method:"post",data:t})}function I(t){return Object(n["a"])({url:"/admin/excel/financeOutturnPlan",method:"GET",params:t})}function j(t){return Object(n["a"])({url:"/admin/excel/financeStandardLossOverflow",method:"GET",params:t})}function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(n["a"])({url:"/admin/data/selectByCond/I_outturn_plan_list_finance/findOutturnPlanDetailsList?pageNo="+e,method:"post",data:t})}function C(t){return Object(n["a"])({url:"/admin/excel/financeStandardLossOverflowDetail",method:"GET",params:t})}function G(){return Object(n["a"])({url:"/admin/factory/getFactoryList",method:"get"})}function T(t){return Object(n["a"])({url:"/admin/factory/getFactoryList",method:"GET",params:t})}function $(t){return Object(n["a"])({url:"/orderReturn/selectProdorderReturnList",method:"get",params:t})}function L(){return Object(n["a"])({url:"/admin/material/supplier/list",method:"get"})}function M(t){return Object(n["a"])({url:"/orderReturn/selectPurchorderReturnList",method:"get",params:t})}function E(t){return Object(n["a"])({url:"/admin/financial/breakageStatisticsAnalyse",method:"post",data:t})}function N(t){return Object(n["a"])({url:"/payment/getProdorderPaymentList",method:"GET",params:t})}function R(t){return Object(n["a"])({url:"/payment/saveProdorderPayment",method:"POST",data:t})}function A(t){return Object(n["a"])({url:"/payment/deleteProdorderPayment",method:"POST",data:t})}function F(t){return Object(n["a"])({url:"/payment/getProdorderPayment",method:"POST",data:t})}function Q(t){return Object(n["a"])({url:"/payment/selectPlanPaymentList",method:"GET",params:t})}function z(t){return Object(n["a"])({url:"/payment/savePaymentInfo",method:"POST",data:t})}function B(t){return Object(n["a"])({url:"/payment/insertPlanPayment",method:"POST",data:t})}function U(t){return Object(n["a"])({url:"/payment/auditPlanPayment",method:"POST",data:t})}function V(t){return Object(n["a"])({url:"/admin/purch/pay/selectPlanPaymentList",method:"GET",params:t})}function q(t){return Object(n["a"])({url:"/admin/purch/pay/insertPlanPayment",method:"POST",data:t})}function W(t){return Object(n["a"])({url:"/admin/purch/pay/auditPlanPayment",method:"POST",data:t})}function H(t){return Object(n["a"])({url:"/admin/purch/pay/savePaymentInfo",method:"POST",data:t})}function J(t){return Object(n["a"])({url:"/admin/purch/pay/getPurchorderPaymentList",method:"GET",params:t})}function Y(t){return Object(n["a"])({url:"/admin/purch/pay/deletePurchorderPayment",method:"POST",data:t})}function K(t){return Object(n["a"])({url:"/admin/purch/pay/updatePlanPayment",method:"POST",data:t})}function Z(t){return Object(n["a"])({url:"/payment/updatePlanPayment",method:"POST",data:t})}function X(t){return Object(n["a"])({url:"/admin/material/supplier/getPayeeInformation",method:"GET",params:t})}function tt(t){return Object(n["a"])({url:"/payment/savePlanPaymentOne",method:"post",data:t})}function et(t){return Object(n["a"])({url:"/admin/purch/pay/saveOnePlanPayment",method:"post",data:t})}function at(t){return Object(n["a"])({url:"/productionPlan/getPlanDetailPaymentList",method:"GET",params:t})}function it(t){return Object(n["a"])({url:"/payment/rejectPlanPayment",method:"post",data:t})}},f555:function(t,e,a){"use strict";a("a923")},faca:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page"},[a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-sizes":[24,100,200,500,1e3],"page-size":t.pageSize,layout:t.layout,total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},n=[],o=(a("a9e3"),{props:{pageSize:{type:Number,default:10},layout:{type:String,default:"sizes, prev, pager, next"},total:Number,currentPage:Number},data:function(){return{}},mounted:function(){},methods:{handleSizeChange:function(t){this.$emit("handleSizeChange",t)},handleCurrentChange:function(t){this.$emit("handleCurrentChange",t)}}}),r=o,s=a("2877"),l=Object(s["a"])(r,i,n,!1,null,"1021ea0e",null);e["a"]=l.exports}}]);