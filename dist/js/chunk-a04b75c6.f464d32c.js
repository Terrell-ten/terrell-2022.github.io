(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a04b75c6"],{"1fd2":function(t,e,a){"use strict";a("4799")},4799:function(t,e,a){},cfb3:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingWeb,expression:"loadingWeb"}],staticClass:"main-conent main-conent-minheight",attrs:{"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formQuery}},[a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"日期从："}},[a("div",{staticClass:"block"},[a("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.formQuery.timeData,callback:function(e){t.$set(t.formQuery,"timeData",e)},expression:"formQuery.timeData"}})],1)]),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"商品名称："}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择","filter-method":t.search,clearable:""},on:{change:t.searchCle,focus:t.GoodsFocus},model:{value:t.formQuery.productId,callback:function(e){t.$set(t.formQuery,"productId",e)},expression:"formQuery.productId"}},t._l(t.optionsGoods,(function(t){return a("el-option",{key:t.id,attrs:{label:t.namecode,value:t.id}})})),1)],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"原订单号："}},[a("el-input",{model:{value:t.formQuery.orderNo,callback:function(e){t.$set(t.formQuery,"orderNo",e)},expression:"formQuery.orderNo"}})],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"SKU："}},[a("el-input",{model:{value:t.formQuery.sku,callback:function(e){t.$set(t.formQuery,"sku",e)},expression:"formQuery.sku"}})],1),a("el-form-item",{staticClass:"overall",staticStyle:{"margin-right":"30px"}},[a("el-button",{attrs:{type:"primary",loading:t.loadingQuery},on:{click:t.onSubmit}},[t._v("查询")])],1),a("div",[a("el-form-item",{staticStyle:{"margin-right":"30px"}},[a("el-button",{attrs:{type:"primary",loading:t.loadingQuery},on:{click:function(e){return t.BatchMapping()}}},[t._v("勾选批量商品映射")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingTab,expression:"loadingTab"}],key:t.paramData.status,ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:"","tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",selectable:t.checkSelectable,align:"center"}}),a("el-table-column",{attrs:{property:"id",label:"明细标识",align:"center",width:"80"}}),a("el-table-column",{attrs:{property:"orderNo",label:"原订单号","min-width":"240",align:"center"}}),a("el-table-column",{attrs:{prop:"optdate",label:"订单日期时间",width:"110",align:"center","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{property:"namecode",width:"180",label:"商品名称",align:"center","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{property:"specif",label:"规格",align:"center","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{property:"sku",label:"SKU",align:"center",width:"200"}}),a("el-table-column",{attrs:{property:"unit",label:"生产单位",align:"center"}}),a("el-table-column",{attrs:{property:"num",label:"生产数量",align:"center"}}),a("el-table-column",{attrs:{property:"unit1",label:"销售单位",align:"center"}}),a("el-table-column",{attrs:{property:"scalnum",label:"销售数量",align:"center"}}),a("el-table-column",{attrs:{property:"script",label:"订单备注",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return null!=e.row.vdata.message?[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",[t._v(t._s(e.row.postil?e.row.postil:"(点击修改)"))])]),e.row.postil?a("span",[t._v(t._s(t._f("postil_substring")(e.row.postil,3))+" "),a("i",{staticClass:"el-icon-edit",staticStyle:{color:"dodgerblue","margin-left":"2px",cursor:"pointer"},on:{click:function(a){return t.clickDate(e.row.id,2,e.row)}}})]):a("a",{staticStyle:{cursor:"pointer",color:"dodgerblue"},on:{click:function(a){return t.clickDate(e.row.id,2,e.row)}}},[t._v("备注")])])]:void 0}}],null,!0)}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.row.loading,expression:"scope.row.loading"}],attrs:{type:"primary"},on:{click:function(a){return t.ClickMapping(e.row)}}},[t._v("商品映射")])]}}])})],1),a("div",{staticClass:"margin-t16 text-right"},[a("AppPage",{attrs:{allTate:t.allTate,state:0,pageSize:24,currentPage:t.currentPage},on:{handleSizeChange:t.clickSizeChange,handleCurrentChange:t.clickCurrentChange}})],1),a("el-dialog",{attrs:{title:t.stateName,visible:t.dialogVisibleDate,width:"30%"},on:{"update:visible":function(e){t.dialogVisibleDate=e}}},[1==t.statyNum?a("el-date-picker",{attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.latestDataTime,callback:function(e){t.latestDataTime=e},expression:"latestDataTime"}}):t._e(),2==t.statyNum?a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:t.stateInput,callback:function(e){t.stateInput=e},expression:"stateInput"}}):t._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisibleDate=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.clickDates()}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"关联包材单",visible:t.dialogPackaging,width:"80%"},on:{"update:visible":function(e){t.dialogPackaging=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.PackagingList,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"序号"}}),a("el-table-column",{attrs:{prop:"namecode",label:"材料名称"}}),a("el-table-column",{attrs:{prop:"specif",label:"规格"}}),a("el-table-column",{attrs:{prop:"num",label:"数量"}}),a("el-table-column",{attrs:{prop:"lossRate",label:"预损耗率"}}),a("el-table-column",{attrs:{prop:"price",label:"单价(元)"}}),a("el-table-column",{attrs:{prop:"unit",label:"单位"}}),a("el-table-column",{attrs:{prop:"unitbit",label:"单位配比"}}),a("el-table-column",{attrs:{prop:"nodetype",label:"状态"}}),a("el-table-column",{attrs:{prop:"lastdate",label:"完成时间"}}),a("el-table-column",{attrs:{prop:"vdata",label:"其他属性"}}),a("el-table-column",{attrs:{prop:"optdate",label:"计划时间"}})],1),a("div",{staticClass:"margin-t16 text-right"},[a("AppPage",{attrs:{allTate:t.allTatePack,state:0,pageSize:24,currentPage:t.currentPagePack},on:{handleSizeChange:t.clickSizeChangePack,handleCurrentChange:t.clickCurrentChangePack}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogPackaging=!1}}},[t._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"关联出库单",visible:t.dialogPackagingKK,width:"80%"},on:{"update:visible":function(e){t.dialogPackagingKK=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.PackagingKKList,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"序号"}}),a("el-table-column",{attrs:{prop:"namecode",label:"物品名称"}}),a("el-table-column",{attrs:{prop:"optdate",label:"出库时间"}}),a("el-table-column",{attrs:{prop:"outcount",label:"出库数量"}}),a("el-table-column",{attrs:{prop:"price",label:"金额(元)"}}),a("el-table-column",{attrs:{prop:"specif",label:"规格"}}),a("el-table-column",{attrs:{prop:"unit",label:"单位"}})],1),a("div",{staticClass:"margin-t16 text-right"},[a("AppPage",{attrs:{allTate:t.allTateKK,state:0,pageSize:24,currentPage:t.currentPageKK},on:{handleSizeChange:t.clickSizeChangeKK,handleCurrentChange:t.clickCurrentChangeKK}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogPackagingKK=!1}}},[t._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"关联生产单",visible:t.dialogProduction,width:"80%"},on:{"update:visible":function(e){t.dialogProduction=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.ProductionList,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"序号"}}),a("el-table-column",{attrs:{prop:"namecode",label:"商品名称"}}),a("el-table-column",{attrs:{prop:"specif",label:"规格"}}),a("el-table-column",{attrs:{prop:"num",label:"数量"}}),a("el-table-column",{attrs:{prop:"lossRate",label:"预损耗率"}}),a("el-table-column",{attrs:{prop:"price",label:"生产单价(元)"}}),a("el-table-column",{attrs:{prop:"unit",label:"单位"}}),a("el-table-column",{attrs:{prop:"nodetype",label:"状态"}}),a("el-table-column",{attrs:{prop:"lastdate",label:"完成时间"}}),a("el-table-column",{attrs:{prop:"optdate",label:"计划时间"}})],1),a("div",{staticClass:"margin-t16 text-right"},[a("AppPage",{attrs:{allTate:t.allTateOrder,state:0,pageSize:24,currentPage:t.currentPageOrder},on:{handleSizeChange:t.clickSizeChangeOrder,handleCurrentChange:t.clickCurrentChangeOrder}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogProduction=!1}}},[t._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:"生成生产计划",visible:t.dialogProductionPlan,width:"80%"},on:{"update:visible":function(e){t.dialogProductionPlan=e}}},[a("div",{staticStyle:{"margin-bottom":"20px",color:"red"}},[t._v("注：以下是按选择客户订单明细合并后的生产计划明细列表")]),a("el-table",{attrs:{data:t.idLists,border:"",stripe:"","row-class-name":t.tableRowClassName,"cell-class-name":t.tableCellClassName},on:{"cell-dblclick":t.dbclick}},[a("el-table-column",{attrs:{type:"index",label:"序号",width:"50",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.$index+1))])]}}])}),a("el-table-column",{attrs:{property:"factoryName",label:"工厂",align:"center"}}),a("el-table-column",{attrs:{property:"warehouseName",label:"仓库",align:"center"}}),a("el-table-column",{attrs:{property:"namecode",label:"物品名称",align:"center"}}),a("el-table-column",{attrs:{property:"specif",label:"规格",align:"center"}}),a("el-table-column",{attrs:{property:"sku",label:"SKU-code",align:"center"}}),a("el-table-column",{attrs:{property:"stock",label:"库存量",align:"center"}}),a("el-table-column",{attrs:{property:"miniStock",label:"最低预警",align:"center"}}),a("el-table-column",{attrs:{property:"prodQuantity",label:"报产起量",align:"center"}}),a("el-table-column",{attrs:{property:"num",label:"预生产量",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.index===t.rowIndex&&e.column.index===t.columnIndex&&"预生产量"==e.column.label?a("div",[a("el-input",{ref:"editInput",attrs:{type:"number"},on:{blur:t.inputBlur},model:{value:e.row.num,callback:function(a){t.$set(e.row,"num",a)},expression:"scope.row.num"}})],1):a("div",{staticStyle:{cursor:"pointer",color:"#009688"}},[t._v(t._s(e.row.num))])]}}])})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogProductionPlan=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.saveClick}},[t._v("确认生成")])],1)],1),a("el-dialog",{staticStyle:{"margin-top":"15vh"},attrs:{title:"修改工厂",visible:t.dialogcc,center:"",width:"30%"},on:{"update:visible":function(e){t.dialogcc=e}}},[a("el-table",{ref:"orderTable",attrs:{data:t.ccdatatable,border:"","tooltip-effect":"light","highlight-current-row":""},on:{"current-change":t.handleCurrentChange}},[a("el-table-column",{attrs:{label:"选择",width:"50",center:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-radio",{staticClass:"radio",attrs:{label:e.$index},nativeOn:{change:function(a){return t.getCurrentRow(e.$index)}},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("     ")])]}}])}),a("el-table-column",{attrs:{property:"id",label:"标识",align:"center"}}),a("el-table-column",{attrs:{property:"factoryName",label:"工厂名称",align:"center"}})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.updatecc2}},[t._v("确认")])],1)],1),a("el-dialog",{staticStyle:{"margin-top":"15vh"},attrs:{title:"该生产计划单，部分商品未达到起订量是否继续生产？",visible:t.dialogProcurement,width:"30%",center:""},on:{"update:visible":function(e){t.dialogProcurement=e}}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.dialogMinimumQuantity}},[t._v("按起订量生产（起订量："+t._s(t.prodQuantity)+" ）")]),a("el-button",{attrs:{type:"primary"},on:{click:t.dialogDemand}},[t._v("按需求量生产")]),a("el-button",{on:{click:function(e){t.dialogProcurement=!1}}},[t._v("暂不生产")])],1)]),a("el-dialog",{staticStyle:{"margin-top":"15vh"},attrs:{title:"导出提示",visible:t.dialogExport,width:"30%"},on:{"update:visible":function(e){t.dialogExport=e}}},[a("span",[t._v(t._s(t.ExportHints))]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.dialogExportClick}},[t._v("确 定")])],1)]),a("el-dialog",{staticStyle:{"margin-top":"15vh"},attrs:{title:t.successTitle,visible:t.productionSuccessDialog,width:"20%",center:""},on:{"update:visible":function(e){t.productionSuccessDialog=e}}},[a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.productionSuccessDialog=!1}}},[t._v("取消")])],1)]),a("el-dialog",{ref:"addFactoryDialg",staticStyle:{"margin-top":"15vh"},attrs:{title:"商品尚未设置工厂,请先设置",visible:t.addFactoryDialg.sync,width:"500px"},on:{"update:visible":function(e){return t.$set(t.addFactoryDialg,"sync",e)}}},[a("el-form",{staticClass:"demo-ruleForm",attrs:{model:t.addFactoryDialg,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"工厂：",prop:"factoryName"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.addFactoryDialg.factoryId,callback:function(e){t.$set(t.addFactoryDialg,"factoryId",e)},expression:"addFactoryDialg.factoryId"}},t._l(t.addFactoryDialg.factoryList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.factoryName,value:t.id}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.addFactoryDialg.sync=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.setFactory}},[t._v("确认")])],1)],1),a("el-dialog",{ref:"goodsFactoryDialg",staticStyle:{"margin-top":"15vh"},attrs:{title:"商品有多个工厂,请选择一个",visible:t.goodsFactoryDialg.sync,width:"500px"},on:{"update:visible":function(e){return t.$set(t.goodsFactoryDialg,"sync",e)}}},[a("el-form",{staticClass:"demo-ruleForm",attrs:{model:t.goodsFactoryDialg,"label-width":"150px"}},[a("el-form-item",{attrs:{label:"工厂：",prop:"factoryName"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.goodsFactoryDialg.factoryId,callback:function(e){t.$set(t.goodsFactoryDialg,"factoryId",e)},expression:"goodsFactoryDialg.factoryId"}},t._l(t.goodsFactoryDialg.factoryList,(function(t){return a("el-option",{key:t.factoryId,attrs:{label:t.factoryName,value:t.factoryId}})})),1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.goodsFactoryDialg.sync=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.setGoodsFactory}},[t._v("确认")])],1)],1)],1)},o=[],s=a("1da1"),r=a("5530"),n=(a("96cf"),a("d3b7"),a("159b"),a("c740"),a("b64b"),a("d81d"),a("e9c4"),a("ac1f"),a("1276"),a("25f0"),a("b0c0"),a("a434"),a("eab5")),l=a("da87"),c=a("2f62"),d=a("2a02"),u=a("062d"),g=a("ef7e"),p=a("dd90"),m=a("85ec"),h={components:{AppPage:m["a"]},data:function(){return{addFactoryDialg:{factoryList:[],sync:!1,factoryId:"",formQuery:{factoryId:""}},goodsFactoryDialg:{factoryList:[],sync:!1,factoryId:"",formQuery:{factoryId:""}},goodsBindFactory:{sync:!1,goodsBindFactoryList:[],bingRowId:"",bingFactoryId:"",radio:!1,order_data:[]},outerVisible:!1,innerVisible:!1,gridData:[],dialogPackaging:!1,PackagingList:[],allTatePack:24,currentPagePack:1,dialogPackagingKK:!1,PackagingKKList:[],allTateKK:24,currentPageKK:1,dialogProduction:!1,ProductionList:[],allTateOrder:24,currentPageOrder:1,dialogProductionPlan:!1,idLists:[],rownew:[],currentRow:null,radio:!1,num1:0,datass2:[],btnvisble:!1,productionSuccessDialog:!1,dialogcc:!1,currentPage:1,loadingWeb:!0,loadingTab:!1,loadingQuery:!1,batchList:[],dialogVisibleDate:!1,statyNum:1,stateName:"最迟交货日期",latestDataTimeId:"",latestDataTime:"",stateInput:"",svalue1:"",svalue2:"",info:{isTrue:!1,isShow:!0},checked:!1,value1:"",value2:"",tableData:[],FactoryNameList:[],optionsName:[],optionsGoods:[],formQuery:{customerId:"",productName:"",status:100540,timeData:"",factoryId:"",sku:"",orderNo:""},searchCleOderBool:!1,options:[{namecode:"映射商品",id:100540}],allTate:100,paramData:{page:1,pageSize:24},multipleSelection:[],packagingId:"",factureOrderId:"",invoiceId:"",isEditingInput:!1,idList:[],prodQuantity:"",rowIndex:-1,columnIndex:-1,dialogProcurement:!1,productionPlanMerge:[],dialogExport:!1,ExportHints:"",max_history:10,historyList:[],ccdatatable:[],ccdata:[],ccid:0,successTitle:""}},computed:Object(r["a"])({},Object(c["c"])({userId:"user/userId",name:"user/name"})),created:function(){this.provinceList=this.datas;var t={page:1,pageSize:24,status:100540};this.getCustomerScheduleOrder(t),this.getCustomerOrderDetailStatusList(),this.getCustomer(),this.getFactoryList()},porps:{chooseData:{type:Object}},methods:{ClickMapping:function(t){var e=this;this.addFactoryDialg.row=t,t.loading=!0,Object(n["y"])({orderDetailId:t.id}).then((function(a){if(t.loading=!1,200===a.code){if(3===a.data.flag)return e.$message({message:"操作成功！",type:"success"}),void e.getCustomerScheduleOrder(e.paramData);if(2===a.data.flag||1===a.data.flag)return e.addFactoryDialg.productid=a.data.productid,void e.getfactoyList(t.sku);if(4===a.data.flag)return e.$message({message:"操作成功！",type:"success"}),void e.getCustomerScheduleOrder(e.paramData)}})).catch((function(e){t.loading=!1}))},BatchMapping:function(){var t=this;this.batchList.length<=0?this.$message({message:"请选择要操作的数据！",type:"warning"}):this.$confirm("你确定对已选的数据进行商品映射吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.loadingQuery=!0;var e=[];t.batchList.forEach((function(t){e.push(t.id)}));var a={ids:e};Object(n["x"])(a).then((function(e){t.loadingQuery=!1,200===e.code&&(t.$alert("<span style='word-wrap: break-word;word-break: break-all;'>"+e.data+"</span>","提示",{dangerouslyUseHTMLString:!0,confirmButtonText:"确定",callback:function(t){}}),t.getCustomerScheduleOrder(t.paramData))}))})).catch((function(){}))},getGoodsFactoyList:function(t){var e=this,a={skuCode:t};Object(n["n"])(a).then((function(t){200===t.code&&(e.goodsFactoryDialg.sync=!0,e.goodsFactoryDialg.factoryList=t.data)}))},setGoodsFactory:function(){var t=this;if(""!==this.goodsFactoryDialg.factoryId){var e={id:this.addFactoryDialg.row.id,factoryId:this.goodsFactoryDialg.factoryId};Object(d["q"])(e).then((function(e){200===e.code&&(e.data?(t.goodsFactoryDialg.sync=!1,t.ClickMapping(t.addFactoryDialg.row)):t.$message({message:"操作失败",type:"warning"}))}))}else this.$message({message:"请选择工厂",type:"warning"})},getfactoyList:function(t){var e=this;this.addFactoryDialg.sku=t,Object(u["m"])({skuCode:t}).then((function(t){200===t.code&&(e.addFactoryDialg.sync=!0,e.addFactoryDialg.factoryList=[],e.addFactoryDialg.factoryId="",t.data.forEach((function(t){1!==t.id&&e.addFactoryDialg.factoryList.push(t)})))}))},setFactory:function(){var t=this;if(""!==this.addFactoryDialg.factoryId){var e={factoryId:this.addFactoryDialg.factoryId,productId:this.addFactoryDialg.productid};Object(n["D"])(e).then((function(e){200===e.code&&(!0===e.data?(t.addFactoryDialg.sync=!1,t.ClickMapping(t.addFactoryDialg.row)):t.$message({message:"操作失败",type:"warning"}))}))}else this.$message({message:"请选择工厂",type:"warning"})},cellClickFactory:function(t){this.goodsBindFactory.bingFactoryId=t.factoryId},bingFactory:function(){},handleSelectionChange:function(t){this.batchList=t,this.multipleSelection=t;var e=[];this.batchList.forEach((function(t){e.push(t.id)})),this.idList=e},checkSelectable:function(t){return!t.isNone},ProductDialogClosed:function(){this.isEditingInput=!1},clickGenerate:function(t){var e=this,a=t.orderDetailId,i=t.productId,o=parseInt(t.preProduction),s={id:i,num:o};Object(n["u"])({orderDetailId:a,productInfoList:[s]}).then((function(t){200===t.code?e.$message({type:"success",message:t.message}):e.$message({type:"warning",message:t.message})}))},tishi:function(){this.$message({message:"当前状态不可修改工厂配置!",type:"warning"})},getInitChoose:function(){var t=this;if(this.chooseData){var e=this.ccdatatable.findIndex((function(e){return e.userUuid===t.chooseData.id}));e>-1&&(this.radio=e)}},handleCurrentChange:function(t){var e=this;if(t){this.currentRow=t;var a=this.ccdatatable.findIndex((function(t){return t.id===e.currentRow.id}));a>-1&&(this.radio=a),this.$emit("data",t.pkg)}},getCurrentRow:function(t){this.radio=t},ladderChange:function(t){},handleCurrentChange2:function(t){this.ccdata=t},updatecc2:function(){var t=this;if(null!=this.currentRow){var e={id:this.ccid,factoryId:this.currentRow.id};Object(d["q"])(e).then((function(e){200===e.code?(t.ccdatatable=e.data,t.$message({message:e.message,type:"success"}),t.dialogcc=!1,t.onSubmit()):t.$message({message:e.message,type:"warning"})}))}else this.$message({message:"未选中数据",type:"warning"})},getcc:function(t){var e=this;this.ccid=t.id,Object(p["a"])({sku:t.sku,factoryName:t.factoryName}).then((function(a){200===a.code?(e.ccdatatable=a.data,e.ccdatatable.length>0?e.dialogcc=!0:e.$message({message:"当前无可分配工厂，可前往商品管理页面进行配置",type:"warning"}),"无工厂"!==t.status&&1===a.data.length?e.btnvisble=!0:e.btnvisble=!1):e.$message({message:a.message,type:"warning"})}))},search:function(t){t.length>=2?this.getAllProductInfo(t):this.optionsGoods=[]},searchCle:function(t){t||(this.optionsGoods=[])},getAllProductInfo:function(t){var e=this,a={nodeType:100303,productName:t};Object(l["f"])(a).then((function(t){200===t.code?e.optionsGoods=t.data:e.$message({message:t.message,type:"warning"})}))},getFactoryList:function(){var t=this;Object(g["g"])().then((function(e){if(200===e.code){var a=[];e.data.forEach((function(t){1!==t.id&&a.push(t)})),t.FactoryNameList=a}}))},getCustomer:function(){var t=this;Object(n["g"])().then((function(e){200===e.code?t.optionsName=e.data:t.$message({message:e.message,type:"warning"})}))},getCustomerOrderDetailStatusList:function(){Object(n["j"])().then((function(t){t.code}))},getCustomerScheduleOrder:function(t){var e=this;Object.keys(t).forEach((function(e){var a=t[e];""===a&&delete t[e]})),this.paramData=t,Object(n["m"])(t).then((function(t){if(e.loadingQuery=!1,e.loadingWeb=!1,200===t.code){var a=t.data.list.map((function(t){return t.nodeTypeBool="待处理"===t.status?1:2,t.postil="",t.vdata&&(t.postil=t.vdata.postil||""),t}));e.loadingTab=!1,e.allTate=t.data.total,e.tableData=a,e.currentPage=t.data.pageNum}else e.$message({message:t.message,type:"warning"})}))},onSubmit:function(){var t=this.historyList,e=this.formQuery.productId,a=localStorage.getItem("data");t=a?JSON.parse(a):[],this.optionsGoods.forEach((function(a){a.id===e&&t.unshift(a)})),this.optionsGoods=this.removalDuplicate(t),localStorage.setItem("data",JSON.stringify(t));var i=this.formQuery;if(100501===i.status?this.searchCleOderBool=!1:this.searchCleOderBool=!0,i.timeData){if(i.timeData.length){var o=this.getTimeData(i.timeData[0]).split(" ")[0],s=this.getTimeData(i.timeData[1]).split(" ")[0];i.startDate=o,i.endDate=s}}else delete i.startDate,delete i.endDate;var n=Object(r["a"])({page:1,pageSize:24},i);delete n.timeData,n.customerName||delete n.customerName,n.customerId||delete n.customerId,n.productName||delete n.productName,n.factoryId||delete n.factoryId,n.status||delete n.status,n.sku||delete n.sku,n.orderNo||delete n.orderNo,this.paramData=n,this.getCustomerScheduleOrder(n)},clickSizeChange:function(t){this.paramData.pageSize=t,this.clickCurrentChange(1)},clickCurrentChange:function(t){this.paramData.page=t,this.getCustomerScheduleOrder(this.paramData)},getTimeData:function(t){var e=new Date(t),a=e.getFullYear()+"-"+this.p(e.getMonth()+1)+"-"+this.p(e.getDate()),i=this.p(e.getHours())+":"+this.p(e.getMinutes())+":"+this.p(e.getSeconds());return a+" "+i},p:function(t){return t<10?"0"+t:t},checkSelectable2:function(t){return!t.isNone&&t},handleSelectionChange2:function(t){this.num1>0&&this.num1++;var e=this.ccdatatable[0];this.$refs.multipleTable2.toggleRowSelection(e),this.$refs.multipleTable2.clearSelection(),this.datass2=t},clickBatch:function(){var t=this.batchList;0===t.length&&this.$message({message:"警告哦，请选择需要处理的数据",type:"warning"})},clickPrint:function(){this.$message({message:"正在开发中",type:"warning"})},clickProduction:function(){var t=this;if(0===this.idList.length)return this.$message.warning("请选择数据进行操作 ^_^");this.idList=this.idList.toString();var e={I_optType:2,I_ids:this.idList,I_optuser:this.name};Object(n["t"])(e).then((function(e){if(t.loading=!1,200===e.code){t.successTitle="生成生产计划成功",t.productionSuccessDialog=!0;var a={page:1,pageSize:24,status:100501};t.getCustomerScheduleOrder(a)}else t.$message({message:e.message,type:"warning"})}))},clickFactoryP:function(){var t=this;if(0===this.idList.length)return this.$message.warning("请选择数据进行操作 ^_^");var e=[];this.batchList.forEach((function(t){e.push(t.factoryId)})),e=e.toString();var a={I_optType:1,I_ids:e,I_optuser:this.name};Object(n["t"])(a).then((function(e){if(t.loading=!1,200===e.code){t.successTitle="生成当前工厂生产计划成功",t.productionSuccessDialog=!0;var a={page:1,pageSize:24,status:100501};t.getCustomerScheduleOrder(a)}else t.$message({message:e.message,type:"warning"})}))},clickOnekey:function(){var t=this;if(0===this.idList.length)return this.$message.warning("请选择数据进行操作 ^_^");var e=[];this.batchList.forEach((function(t){e.push(t.factoryId)})),e=e.toString();var a={I_optType:0,I_ids:e,I_optuser:this.name};Object(n["t"])(a).then((function(e){if(t.loading=!1,200===e.code){t.successTitle="一键自动成功",t.productionSuccessDialog=!0;var a={page:1,pageSize:24,status:100501};t.getCustomerScheduleOrder(a)}else t.$message({message:e.message,type:"warning"})}))},clickPackaging:function(t){this.dialogPackaging=!0,this.packagingId=t;var e={page:1,pageSize:24,associateId:t};this.getPackaging(e)},getPackaging:function(t){var e=this;Object(n["q"])(t).then((function(t){200===t.code?(e.PackagingList=t.data.list,e.allTatePack=t.data.total,e.currentPagePack=t.data.pageNum):e.$message({type:"warning",message:t.message})}))},clickSizeChangePack:function(t){this.loadingTab=!0},clickCurrentChangePack:function(t){this.loadingTab=!0;var e={page:t,pageSize:24,associateId:this.packagingId};this.getPackaging(e)},clickManufactureOrder:function(t){this.factureOrderId=t,this.dialogProduction=!0;var e={page:1,pageSize:24,associateId:t};this.getProduction(e)},getProduction:function(t){var e=this;Object(n["s"])(t).then((function(t){e.ProductionList=t.data.list,e.allTateOrder=t.data.total,e.currentPageOrder=t.data.pageNum}))},clickSizeChangeOrder:function(t){this.loadingTab=!0},clickCurrentChangeOrder:function(t){this.loadingTab=!0;var e={page:t,pageSize:24,associateId:this.factureOrderId};this.getProduction(e)},clickDate:function(t,e,a){this.statyNum=e,this.dialogVisibleDate=!0,this.latestDataTimeId=t,this.rownew=a,this.stateName=2===e?"备注":"最迟交货期"},clickDates:function(){var t=this,e=this.statyNum;if(1===e){var a={targetId:this.latestDataTimeId,lastDeliveryDate:this.latestDataTime};Object(g["A"])(a).then((function(e){if(200===e.code){for(var a=t.tableData,i=0;i<a.length;i++)a[i].id===t.latestDataTimeId&&(a[i].lastdate=t.latestDataTime);t.dialogVisibleDate=!1,t.$message({type:"success",message:"成功设置最迟交货时间"})}}))}else{var i={id:this.latestDataTimeId,remarks:this.rownew.vdata.message+this.stateInput,postscript:this.rownew.vdata||{}};i.postscript.postil=this.stateInput,Object(n["E"])(i).then((function(e){if(200===e.code){for(var a=t.tableData,i=0;i<a.length;i++)a[i].id===t.latestDataTimeId&&(a[i].script=t.stateInput);t.dialogVisibleDate=!1,t.$message({type:"success",message:"添加备注成功"})}}))}},clickInvoice:function(t){this.dialogPackagingKK=!0,this.invoiceId=t;var e={associateId:t,page:1,pageSize:24};this.getGoodsOutboundListByAssociateId(e)},getGoodsOutboundListByAssociateId:function(t){var e=this;Object(n["o"])(t).then((function(t){e.PackagingKKList=t.data.list,e.allTateKK=t.data.total,e.currentPageKK=t.data.pageNum}))},clickSizeChangeKK:function(t){this.loadingTab=!0},clickCurrentChangeKK:function(t){this.loadingTab=!0;var e={page:t,pageSize:24,associateId:this.invoiceId};this.getGoodsOutboundListByAssociateId(e)},clickExport:function(){var t=this,e=this.formQuery;e.timeData?e.timeData.length&&(e.startDate=this.getTimeData(e.timeData[0]),e.endDate=this.getTimeData(e.timeData[1]),this.formQuery.paramStr="开始时间："+e.startDate+",结束时间："+e.endDate):(delete e.startDate,delete e.endDate);var a=Object(r["a"])({},e);delete a.timeData,a.customerName||delete a.customerName,a.productName||delete a.productName,a.status||delete a.status,a.factoryId||delete a.factoryId,e.timeData?Object(n["k"])(a).then((function(e){t.ExportHints=e.data,t.dialogExport=!0})):this.$message({type:"warning",message:"请选择导出的时间跨度 ^_^"})},dialogExportClick:function(){this.dialogExport=!1,this.$message({type:"success",message:"操作成功"})},clickGoods:function(t){this.outerVisible=!0;var e={orderDetailId:t};this.getProductStockByOrderDetailId(e),this.gridData=[]},tableRowClassName:function(t){var e=t.row,a=t.rowIndex;e.index=a},tableCellClassName:function(t){var e=t.column,a=t.columnIndex;e.index=a},dbclick:function(t,e,a,i){this.isEditingInput=!0,"预生产量"===e.label&&(this.rowIndex=t.index,this.columnIndex=e.index,this.$nextTick((function(){var t=a.children[0].children[0].children[0].children[0];t.focus()})))},inputBlur:function(){this.rowIndex=-1,this.columnIndex=-1},saveClick:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.idLists.forEach((function(e){if(e.prodQuantity>e.num)t.dialogProcurement=!0;else{for(var a in e)"productId"!==a&&"num"!==a&&"associationIds"!==a&&delete e[a],e.id=e.productId;t.array.push(e),t.array.forEach((function(t){delete t.productId}))}})),a={confirmType:2,productInfoList:t.array},Object(n["v"])(a).then((function(e){if(200===e.code){t.$message({type:"success",message:e.message}),t.dialogProductionPlan=!1;var a={page:1,pageSize:24,status:100501};t.getCustomerScheduleOrder(a)}else t.$message({type:"warning",message:e.message})}));case 3:case"end":return e.stop()}}),e)})))()},dialogMinimumQuantity:function(){var t=this,e={confirmType:1,productInfoList:[{id:this.idLists[0].productId,num:this.idLists[0].num,associationIds:this.idLists[0].associationIds}]};Object(n["v"])(e).then((function(e){if(200===e.code){t.$message({type:"success",message:e.message}),t.dialogProcurement=!1,setTimeout((function(){t.dialogProductionPlan=!1}),1e3);var a={page:1,pageSize:24,status:100501};t.getCustomerScheduleOrder(a)}else t.$message({type:"warning",message:e.message})}))},dialogDemand:function(){var t=this,e={confirmType:2,productInfoList:[{id:this.idLists[0].productId,num:this.idLists[0].num,associationIds:this.idLists[0].associationIds}]};Object(n["v"])(e).then((function(e){if(200===e.code){t.$message({type:"success",message:e.message}),t.dialogProcurement=!1,setTimeout((function(){t.dialogProductionPlan=!1}),1e3);var a={page:1,pageSize:24,status:100501};t.getCustomerScheduleOrder(a)}else t.$message({type:"warning",message:e.message})}))},getProductStockByOrderDetailId:function(t){var e=this;Object(n["r"])(t).then((function(t){e.loadingQuery=!1,200===t.code?e.gridData.push(t.data):e.$message({message:t.message,type:"warning"})}))},GoodsFocus:function(){var t=localStorage.getItem("data");t&&(this.optionsGoods=JSON.parse(t),this.historydata(JSON.parse(t)))},removalDuplicate:function(t){for(var e=0;e<t.length;e++){var a=t[e];if(""!==a)for(var i=e+1;i<t.length;i++)t[e].id===t[i].id&&t.splice(e,1)}return t},historydata:function(t){this.optionsGoods=[];var e=localStorage.getItem("data");this.optionsGoods=JSON.parse(e),t.length>this.max_history&&this.optionsGoods.splice(this.max_history)},add:function(){this.$router.push({path:"BOMadd"})}},mounted:function(){}},f=h,b=(a("1fd2"),a("2877")),y=Object(b["a"])(f,i,o,!1,null,"7f23f420",null);e["default"]=y.exports}}]);