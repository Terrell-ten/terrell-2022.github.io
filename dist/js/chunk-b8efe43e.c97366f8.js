(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b8efe43e"],{"7a1c":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main-conent main-conent-minheight flex-main-conent"},[n("div",{staticClass:"flex-box"},[n("div",{staticClass:"flex-top"},[n("div",{attrs:{slot:"header"},slot:"header"},[n("el-form",{attrs:{"label-width":"100px"}},[n("el-row",{staticClass:"flex-wrap-wrap",attrs:{type:"flex",justify:"space-between"}},[n("el-col",{attrs:{span:18}},[n("el-col",{attrs:{span:7}},[n("el-form-item",{attrs:{label:"用户名称："}},[n("el-input",{model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)],1),n("el-col",{attrs:{span:5}},[n("el-form-item",{attrs:{label:"状态："}},[n("el-select",{staticStyle:{width:"100%"},attrs:{clearable:""},model:{value:e.nodetype,callback:function(t){e.nodetype=t},expression:"nodetype"}},[n("el-option",{attrs:{label:"启用",value:"6"}}),n("el-option",{attrs:{label:"停用",value:"8"}})],1)],1)],1),n("el-col",{attrs:{span:7}},[n("el-form-item",{attrs:{label:"所属应用："}},[n("el-select",{attrs:{"value-key":"roleType",placeholder:"请选择"},model:{value:e.app,callback:function(t){e.app=t},expression:"app"}},e._l(e.appList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.namecode,value:e.id}})})),1)],1)],1)],1),n("el-col",{staticClass:"text-right",attrs:{span:6}},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.findList(0)}}},[e._v("查询")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.add()}}},[e._v("添加用户")])],1)],1)],1)],1)]),n("div",{staticClass:"flex-cont"},[n("v-list",{staticStyle:{height:"100%"},attrs:{lists:e.lists,info:e.info},on:{edit:e.edit,findrole:e.findrole,editauth:e.editauth}})],1),n("div",{staticClass:"flex-button"},[n("div",{staticClass:"margin-t16 text-right"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.findList(0)}}},[e._v("第一页")]),e.pageNo>1?n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.findList(-1)}}},[e._v("上一页")]):e._e(),e.lists.length>=24?n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.findList(1)}}},[e._v("下一页")]):e._e(),e.lists.length<24?n("el-button",{attrs:{type:"primary"}},[e._v("已经是最后一页")]):e._e()],1)])]),n("v-add",{ref:"aaa",attrs:{info:e.info}}),n("v-findlist",{attrs:{info:e.info}}),n("v-authlist",{attrs:{info:e.info}})],1)},a=[],o=n("5530"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-dialog",{attrs:{title:e.info.isShow?"添加用户":"修改用户",visible:e.info.isTrue,width:"50%"},on:{"update:visible":function(t){return e.$set(e.info,"isTrue",t)},close:function(t){return e.hide()},opened:e.hideOpened}},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.form,rules:e.rules,"label-width":"120px"}},[n("el-form-item",{attrs:{label:"登录账号：",prop:"username"}},[n("el-input",{attrs:{disabled:0==e.info.isShow},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),n("el-form-item",{attrs:{label:"账号昵称：",prop:"newNickname"}},[n("el-input",{model:{value:e.form.newNickname,callback:function(t){e.$set(e.form,"newNickname",t)},expression:"form.newNickname"}})],1),n("el-form-item",{attrs:{label:"联系电话：",prop:"phone"}},[n("el-input",{model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}})],1),n("el-form-item",{attrs:{label:"密码："}},[n("el-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),n("el-form-item",{attrs:{label:"确认密码："}},[n("el-input",{attrs:{type:"password"},model:{value:e.form.confirmpassword,callback:function(t){e.$set(e.form,"confirmpassword",t)},expression:"form.confirmpassword"}})],1),0==e.info.isShow?n("el-form-item",{attrs:{label:"状态：",prop:"nodetype"}},[n("el-select",{staticStyle:{width:"20%"},attrs:{clearable:""},model:{value:e.form.nodetype,callback:function(t){e.$set(e.form,"nodetype",t)},expression:"form.nodetype"}},[n("el-option",{attrs:{label:"有效",value:"6"}}),n("el-option",{attrs:{label:"禁用",value:"8"}})],1)],1):e._e()],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.userEdit("ruleForm")}}},[e._v("保存")]),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.hide()}}},[e._v("取 消")])],1)],1)],1)},s=[],l=(n("d3b7"),n("159b"),n("b64b"),n("2f62")),c=n("b418"),d=n("2cd9"),u=n("373f"),f={props:["info"],data:function(){return{uploadUrl:d["b"],form:{username:"",newNickname:"",phone:"",password:"",nodetype:"6",confirmpassword:""},rules:{nodetype:[{required:!0,message:"请选择状态",trigger:"change"}],newNickname:[{required:!0,message:"请输入用户昵称",trigger:"change"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],username:[{required:!0,message:"请输入用户名称",trigger:"change"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}]}}},computed:Object(o["a"])({},Object(l["c"])({list:"userList/list"})),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])({reqChangeList:"userList/reqChangeList"})),{},{hideOpened:function(){this.info.isShow&&this.$refs["ruleForm"].resetFields()},reset:function(){this.form={username:"",newNickname:"",phone:"",nodetype:"",password:"",confirmpassword:""}},hide:function(){this.info.isTrue=!1,this.reset()},getId:function(e){var t=this;Object(c["H"])({getColumns:[{nameCode:"id"},{nameCode:"nodetype"},{nameCode:"namecode",vdata:{DISPNAME:"username"}},{nameCode:"phone"},{nameCode:"username",vdata:{DISPNAME:"newNickname"}}],Condition:[{nameCode:"id",data:e}]}).then((function(e){if(200===e.code){var n=e.data[0];n.password="",n.confirmpassword="",t.form=n}else Object(u["b"])(e.message)}))},userEdit:function(e){var t=this;this.info.isShow?this.register(e):this.$refs[e].validate((function(e){if(!e)return!1;if(t.form.password!==t.form.confirmpassword)return Object(u["b"])("两次输入密码不一致!"),!1;var n=Object(o["a"])({},t.form);Object.keys(n).forEach((function(e){var t=n[e];""===t&&delete n[e]})),Object(c["B"])(n).then((function(e){200===e.code&&(Object(u["a"])(e.message),t.$parent.findList(),t.hide())}))}))},register:function(e){var t=this;this.$refs[e].validate((function(e){if(!e)return!1;if(""===t.form.password||""===t.form.confirmpassword)return Object(u["b"])("密码及确认密码不能为空!"),!1;if(t.form.password!==t.form.confirmpassword)return Object(u["b"])("两次输入密码不一致!"),!1;var n=Object(o["a"])(Object(o["a"])({},t.form),{},{nickName:t.form.newNickname});Object(c["s"])(n).then((function(e){200===e.code&&(Object(u["a"])(e.message),t.$parent.findList(),t.hide())}))}))}}),mounted:function(){}},p=f,m=n("2877"),h=Object(m["a"])(p,r,s,!1,null,"e640d61e",null),b=h.exports,v=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.lists,border:"",height:"100%"}},[n("el-table-column",{attrs:{prop:"id",label:"标识",width:"100",align:"center"}}),n("el-table-column",{attrs:{prop:"username",label:"登录账号",width:"180",align:"center"}}),n("el-table-column",{attrs:{prop:"appname",label:"所属应用",align:"center",width:"200"}}),n("el-table-column",{attrs:{prop:"newNickname",label:"昵称",align:"center",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s("未设置昵称"===t.row.newNickname?"-":t.row.newNickname))])]}}])}),n("el-table-column",{attrs:{prop:"phone",label:"联系电话",align:"center",width:"200"}}),n("el-table-column",{attrs:{prop:"nodetype",label:"状态",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[6==t.row.nodetype?n("span",[e._v(" 有效")]):e._e(),8==t.row.nodetype?n("span",[e._v(" 禁用")]):e._e()])]}}])}),n("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",[n("el-button",{attrs:{type:"primary"},on:{click:function(n){return e.findRoleList(t.row)}}},[e._v("角色授权")]),n("el-button",{attrs:{type:"primary"},on:{click:function(n){return e.edit(t.row.id)}}},[e._v("修改")]),n("el-button",{attrs:{type:"danger"},on:{click:function(n){return e.del(t.row.id)}}},[e._v("删除")])],1)]}}])})],1)],1)},g=[],y=n("c733"),w={props:["lists","info"],components:{},data:function(){return{}},computed:{},methods:{edit:function(e){this.$emit("edit",e)},editauth:function(e){if("admin"===e.username)return Object(u["b"])("不允许操作系统管理员!"),!1;y["a"].$emit("myFun2",e),this.$emit("editauth",e)},findRoleList:function(e){if("admin"===e.username)return Object(u["b"])("不允许操作系统管理员!"),!1;y["a"].$emit("find",e),this.$emit("findrole",e)},del:function(e){var t=this;this.$confirm("确认要删除用户吗!","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["D"])(e).then((function(e){200===e.code&&(Object(u["a"])(e.message),t.$parent.findList())}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}},mounted:function(){}},k=w,x=Object(m["a"])(k,v,g,!1,null,"819a25da",null),O=x.exports,j=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-dialog",{attrs:{title:"用户-授权角色",visible:e.info.roleDis,width:"40%"},on:{"update:visible":function(t){return e.$set(e.info,"roleDis",t)}}},[n("el-form",{ref:"form",staticStyle:{margin:"0 30px","max-height":"600px",overflow:"auto"},attrs:{"label-width":"100px"}},[n("el-checkbox-group",{staticStyle:{display:"flex","flex-wrap":"wrap","justify-content":"space-between"},model:{value:e.roleList,callback:function(t){e.roleList=t},expression:"roleList"}},[2==e.version?e._l(e.list2,(function(t){return n("div",{key:t.title,staticStyle:{display:"block",width:"100%","margin-bottom":"15px"}},[n("div",{staticStyle:{"font-size":"16px",margin:"0px 0 8px"}},[e._v(" "+e._s(t.title)+" ")]),n("div",{staticStyle:{"margin-left":"20px"}},e._l(t.list,(function(t){return n("el-checkbox",{key:t.id,attrs:{label:t.id},on:{change:function(n){return e.changeCheckbox(n,t)}},model:{value:e.roleList,callback:function(t){e.roleList=t},expression:"roleList"}},[e._v(e._s(t.namecode))])})),1)])})):e._l(e.list,(function(t){return n("div",{key:t.namecode,staticStyle:{"margin-bottom":"8px",width:"48%"}},[n("el-checkbox",{attrs:{label:t.id},on:{change:function(n){return e.changeCheckbox(n,t)}},model:{value:e.roleList,callback:function(t){e.roleList=t},expression:"roleList"}},[e._v(" "+e._s(t.namecode)+" "),n("span",{staticStyle:{"margin-left":"20px",color:"#999"}},[e._v("("+e._s(t.lastname)+")")])])],1)}))],2)],1)],1)],1)},C=[],_=(n("b0c0"),n("25f0"),{props:["info"],components:{},data:function(){return{version:2,roleList:[],list:[],list2:[],id:"",defaultProps:{children:"children",label:"label"}}},computed:{},created:function(){},mounted:function(){var e=this;this.authList(),y["a"].$on("find",(function(t){e.id=t.id,e.name=t.namecode,e.userFindRoleList(e.id)}))},updated:function(){},methods:{authList:function(){var e=this,t={largeId:"0",nodetype:"101201"};Object(c["c"])(t).then((function(t){var n=[];t.data.forEach((function(e){var t="";n.forEach((function(n,i){n.lastId===e.data&&(t=i)})),n[t]?(n[t].list.push(e),n[t].idr.push(e.id),n[t].ids=n[t].idr.toString()):n.push({title:e.lastname,lastId:e.data,ids:e.id+"",idr:[e.id],list:[e]})})),e.list2=n,e.list=t.data}))},changeCheckbox:function(e,t){if("超级管理员"==t.namecode)return Object(u["b"])("不允许操作超级管理员!"),!1;if(e){var n={rela:this.id,namecode:t.namecode,data:t.id,nodetype:101101};Object(c["G"])(n).then((function(e){200==e.code&&Object(u["a"])(e.message)}))}else{var i={userId:this.id,typeId:101101,data:t.id};Object(c["F"])(i,0).then((function(e){Object(c["E"])(e.data[0].id).then((function(e){Object(c["r"])()}))}))}},getList:function(){},userFindRoleList:function(e){var t=this,n={userId:e,typeId:101101};Object(c["F"])(n,0).then((function(e){var n=[];e.data.forEach((function(e){n.push(e.data)})),t.roleList=n}))}}}),L=_,S=Object(m["a"])(L,j,C,!1,null,"47f3958a",null),$=S.exports,N=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-dialog",{attrs:{title:"用户授权",visible:e.infoAuthDis,width:"60%"},on:{"update:visible":function(t){e.infoAuthDis=t}}},[n("div",{attrs:{id:"app"}},[n("el-tree",{ref:"tree",attrs:{"check-strictly":!1,"default-expand-all":"",data:e.data,"show-checkbox":"","node-key":"id"},on:{"check-change":e.checkChange}})],1)])],1)},E=[],D={props:["info"],components:{},data:function(){return{infoAuthDis:!1,data:[],name:"",defaultProps:{children:"children",label:"label"}}},computed:{},created:function(){},mounted:function(){var e=this;y["a"].$on("myFun2",(function(t){e.id=t.id,e.name=t.username,e.infoAuthDis=!0,e.getList(),e.setCheckedKeys()}))},methods:{setCheckedKeys:function(){var e=this;Object(c["F"])({userId:this.id},0).then((function(t){var n=[];t.data.forEach((function(e){n.push(e.data)})),e.$refs.tree.setCheckedKeys(n)}))},getList:function(){var e=this,t={nodetype1:101201,nodetype2:101206,largeId:0};Object(c["c"])(t,0).then((function(t){var n=[];t.data.forEach((function(e){var t={id:e.id,label:e.namecode,nodetype:e.nodetype,url:e.url,parentid:e.data,children:[]};n.push(t)}));var i=e.listToTree("id","parentid",n);e.data=i}))},getCheckedKeys:function(){},exists:function(e,t){for(var n=0;n<e.length;n++)if(e[n].id===t)return!0;return!1},listToTree:function(e,t,n){for(var i=[],a=0;a<n.length;a++){var o=n[a];this.exists(n,o[t])||i.push(o)}for(var r=[],s=0;s<i.length;s++)r.push(i[s]);while(r.length)for(var l=r.shift(),c=0;c<n.length;c++){var d=n[c];d[t]===l[e]&&(l.children?l.children.push(d):l.children=[d],r.push(d))}return i},checkChange:function(e,t,n){if(this.isOut){var i=this.$refs.tree.getNode(e);if(i.checked){var a={rela:this.id,namecode:this.name+":"+e.label,data:e.id,nodetype:101301};Object(c["p"])(a)}else{var o={rela:this.id,data:e.id};Object(c["F"])(o).then((function(e){e.data.length>0&&Object(c["g"])(e.data[0].id)}))}}},handleSelectionChange:function(e){this.multipleSelection=e}},updated:function(){}},T=D,I=Object(m["a"])(T,N,E,!1,null,"44889af2",null),F=I.exports,A={components:{vAdd:b,vList:O,vFindlist:$,vAuthlist:F},data:function(){return{username:"",nodetype:"6",pageNo:1,lists:[],app:10005,info:{isTrue:!1,isShow:!0,roleDis:!1,authDis:!1}}},computed:Object(o["a"])({},Object(l["c"])({appList:"roleTypeList/appList"})),methods:Object(o["a"])(Object(o["a"])({},Object(l["b"])({reqChangeList:"roleTypeList/reqChangeList"})),{},{findrole:function(){this.info.roleDis=!0},add:function(){this.info.isTrue=!0,this.info.isShow=!0},edit:function(e){this.info.isShow=!1,this.info.isTrue=!0,this.$refs.aaa.getId(e)},editauth:function(){this.info.authDis=!0},findList:function(e){var t=this;0===e?this.pageNo=1:e>0?this.pageNo++:e<0&&this.pageNo--;var n=[];if(""!==this.nodetype){var i={nameCode:"nodetype",data:this.nodetype};n.push(i)}if(""!==this.app){var a={nameCode:"rela",data:this.app};n.push(a)}if(""!==this.username){var o={nameCode:"namecode",data:"%"+this.username+"%",nodeType:"LIKE"};n.push(o)}var r={getColumns:[{nameCode:"id"},{nameCode:"nodetype"},{nameCode:"username",vdata:{DISPNAME:"newNickname"}},{nameCode:"namecode",vdata:{DISPNAME:"username"}},{rela:"unif",nodeType:"rela",nameCode:"namecode",vdata:{DISPNAME:"appname"}},{nameCode:"phone"},{nameCode:"id",nodeType:"ORDER DESC"}],Condition:n};Object(c["H"])(r,this.pageNo).then((function(e){t.lists=e.data}))}}),mounted:function(){this.reqChangeList(),this.findList(0)}},q=A,P=Object(m["a"])(q,i,a,!1,null,null,null);t["default"]=P.exports},c733:function(e,t,n){"use strict";var i=n("2b0e");t["a"]=new i["default"]}}]);