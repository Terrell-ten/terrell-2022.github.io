(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e01d97de"],{"0b29":function(t,e,a){"use strict";a("a299")},"2a02":function(t,e,a){"use strict";a.d(e,"j",(function(){return o})),a.d(e,"p",(function(){return r})),a.d(e,"i",(function(){return i})),a.d(e,"b",(function(){return s})),a.d(e,"f",(function(){return l})),a.d(e,"g",(function(){return u})),a.d(e,"h",(function(){return d})),a.d(e,"e",(function(){return c})),a.d(e,"n",(function(){return m})),a.d(e,"k",(function(){return f})),a.d(e,"a",(function(){return p})),a.d(e,"q",(function(){return h})),a.d(e,"c",(function(){return g})),a.d(e,"d",(function(){return b})),a.d(e,"o",(function(){return y})),a.d(e,"l",(function(){return w})),a.d(e,"m",(function(){return _}));var n=a("83c3");function o(t){return Object(n["a"])({url:"/admin/shopper/warehouse/list/page",method:"post",data:t})}function r(t){return Object(n["a"])({url:"/admin/shopper/warehouse/update",method:"post",data:t})}function i(t){return Object(n["a"])({url:"/admin/shopper/warehouse/get",method:"get",params:t})}function s(t){return Object(n["a"])({url:"/admin/shopper/warehouse/delete",method:"POST",data:t})}function l(t){return Object(n["a"])({url:"/admin/factory/list/page",method:"POST",data:t})}function u(t){return Object(n["a"])({url:"/admin/factory/getFactoryList",method:"get",data:t})}function d(t){return Object(n["a"])({url:"/admin/shopper/warehouse/list",method:"GET",data:t})}function c(t){return Object(n["a"])({url:"/admin/factory/get",method:"get",params:t})}function m(t){return Object(n["a"])({url:"/admin/factory/update",method:"post",data:t})}function f(t){return Object(n["a"])({url:"/admin/factory/insert",method:"post",data:t})}function p(t){return Object(n["a"])({url:"/admin/factory/delete",method:"post",data:t})}function h(t){return Object(n["a"])({url:"/admin/customer/detail/schedule/factory/update",method:"post",data:t})}function g(t){return Object(n["a"])({url:"/admin/user/findUserList",method:"get",params:t})}function b(t){return Object(n["a"])({url:"/admin/factory/list/sku",method:"get",params:t})}function y(t){return Object(n["a"])({url:"/admin/factory/updateProductTaxRate",method:"post",data:t})}function w(t){return Object(n["a"])({url:"/admin/officer/saveDutyOfficer",method:"post",data:t})}function _(t){return Object(n["a"])({url:"/admin/officer/updateDutyOfficerStatus",method:"post",data:t})}},4795:function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"a",(function(){return o}));a("a434");function n(t){var e=new Date(t),a=e.getMonth()+1,n=e.getDate();a>=1&&a<=9&&(a="0"+a),n>=0&&n<=9&&(n="0"+n);var o=e.getFullYear()+"-"+a+"-"+n+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds();return o}function o(t,e){for(var a=t.length,n=0;n<a;n++)if(t[n].id===e)return 0===n?(t.shift(),t):n===a-1?(t.pop(),t):(t.splice(n,1),t)}},"85ec":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.state?a("div",[a("el-pagination",{attrs:{"page-sizes":[10,50,100,200],"page-size":t.pageSize,"current-page":t.currentPage,layout:" prev, next",total:t.allTate},on:{"current-change":t.handleCurrentChange}})],1):t._e(),t.state?t._e():a("div",[a("el-pagination",{attrs:{"page-sizes":[10,50,100,200],"current-page":t.currentPage,"page-size":t.pageSize,background:"",layout:" prev,pager, next",total:t.allTate},on:{"current-change":t.handleCurrentChange}})],1)])},o=[],r=(a("a9e3"),{props:{allTate:{type:Number,default:10},state:{type:Number,default:1},pageSize:{type:Number,default:24},currentPage:{type:Number,default:1}},components:{},data:function(){return{}},computed:{},methods:{handleCurrentChange:function(t){this.$emit("handleCurrentChange",t)}},mounted:function(){}}),i=r,s=a("2877"),l=Object(s["a"])(i,n,o,!1,null,"f05975ba",null);e["a"]=l.exports},a299:function(t,e,a){},a80d:function(t,e,a){"use strict";a.d(e,"e",(function(){return o})),a.d(e,"m",(function(){return r})),a.d(e,"j",(function(){return i})),a.d(e,"f",(function(){return s})),a.d(e,"n",(function(){return l})),a.d(e,"c",(function(){return u})),a.d(e,"l",(function(){return d})),a.d(e,"a",(function(){return c})),a.d(e,"d",(function(){return m})),a.d(e,"h",(function(){return f})),a.d(e,"i",(function(){return p})),a.d(e,"b",(function(){return h})),a.d(e,"k",(function(){return g})),a.d(e,"g",(function(){return b}));var n=a("83c3");function o(t){return Object(n["a"])({url:"/outturnPlan/selectOutturnPlanList",method:"get",params:t})}function r(t){return Object(n["a"])({url:"/outturnPlan/saveOutturnPlan",method:"post",data:t})}function i(t){return Object(n["a"])({url:"/admin/shopper/warehouse/list",method:"get",params:t})}function s(t){return Object(n["a"])({url:"/outturnPlan/getOutturnPlanListList",method:"get",params:t})}function l(t){return Object(n["a"])({url:"/outturnPlan/updateOutturnPlanList",method:"post",data:t})}function u(t,e){return Object(n["a"])({url:"/outturnPlan/deleteOutturnPlanList?id=".concat(e),method:"post",data:t})}function d(t){return Object(n["a"])({url:"/outturnPlan/auditOutturnPlan",method:"POST",data:t})}function c(t){return Object(n["a"])({url:"/admin/data/deleteById/I_outturn_plan_list?dataId="+t,method:"post",data:[]})}function m(t){return Object(n["a"])({url:"/product/getAllProductInfo",method:"get",params:t})}function f(t){return Object(n["a"])({url:"/product/getProductIdAndName",method:"get",params:t})}function p(t){return Object(n["a"])({url:"/product/getProductIdAndNameTwo",method:"get",params:t})}function h(t,e){return Object(n["a"])({url:"/outturnPlan/deleteOutturnPlan?id="+e,method:"post",data:t})}function g(t){return Object(n["a"])({url:"/admin/excel/operationCausticExcessive2",method:"get",params:t})}function b(t){return Object(n["a"])({url:"/product/getProduct",method:"get",params:t})}},b973:function(t,e,a){"use strict";a.d(e,"i",(function(){return o})),a.d(e,"h",(function(){return r})),a.d(e,"e",(function(){return i})),a.d(e,"g",(function(){return s})),a.d(e,"f",(function(){return l})),a.d(e,"l",(function(){return u})),a.d(e,"d",(function(){return d})),a.d(e,"b",(function(){return c})),a.d(e,"c",(function(){return m})),a.d(e,"o",(function(){return f})),a.d(e,"a",(function(){return p})),a.d(e,"k",(function(){return h})),a.d(e,"j",(function(){return g})),a.d(e,"m",(function(){return b})),a.d(e,"n",(function(){return y}));var n=a("83c3");function o(t,e){return Object(n["a"])({url:"/admin/data/selectByCond/I_transfet_plan/findTransferPlanList?pageNo=".concat(e),method:"post",data:t})}function r(t){return Object(n["a"])({url:"/admin/transfer/getTransferProductList",method:"get",params:t})}function i(t){return Object(n["a"])({url:"/admin/data/execProcedure/find_kdbmx?pageNo=0",method:"POST",data:t})}function s(t){return Object(n["a"])({url:"/admin/transfer/insert",method:"post",data:t})}function l(t,e){return Object(n["a"])({url:"/admin/data/selectByCond/I_transfer_plan_records/findTransferPlanRecords?pageNo=".concat(e),method:"POST",data:t})}function u(t){return Object(n["a"])({url:"/admin/transfer/audit",method:"post",data:t})}function d(t){return Object(n["a"])({url:"/product/existProductTheFactory",method:"GET",params:t})}function c(t){return Object(n["a"])({url:"/product/copyProductToNewFactoryTwo",method:"post",data:t})}function m(t){return Object(n["a"])({url:"/admin/data/execProcedure/exec_allot?pageNo=0",method:"post",data:t})}function f(t){return Object(n["a"])({url:"/admin/transfer/updateTransferNum",method:"post",data:t})}function p(t){var e={getColumns:[{nameCode:"id"},{nameCode:"namecode"},{nameCode:"specif"},{nameCode:"data"},{nameCode:"unit"},{nameCode:"unit1"},{nameCode:"unitbit"},{nameCode:"unitbit1"},{nameCode:"getnum"},{nameCode:"getnum1"},{nameCode:"sku"},{nameCode:"producedate"}],Condition:[{nameCode:"mainwareid",data:t.warehouseId},{nameCode:"nodetype",data:100303},{nameCode:"namecode",nodetype:"LIKE",data:"%"+t.goodsName+"%"}]};return Object(n["a"])({url:"/admin/data/selectByCond/查询仓库可调拨行?pageNo=0",method:"post",data:e})}function h(t){return Object(n["a"])({url:"/admin/data/execProcedure/指定行锁单?pageNo=0",method:"POST",data:t})}function g(t){return Object(n["a"])({url:"/admin/data/execProcedure/指定行解锁?pageNo=0",method:"POST",data:t})}function b(t){return Object(n["a"])({url:"/admin/data/execProcedure/调拨单审核确认?pageNo=0",method:"POST",data:t})}function y(t){return Object(n["a"])({url:"/admin/data/execProcedure/报损单审核确认?pageNo=0",method:"POST",data:t})}},cd76:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-conent main-conent-minheight"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.formQuery}},[a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"日期从："}},[a("div",{staticClass:"block"},[a("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",align:"right",placeholder:"开始日期","value-format":"yyyy-MM-dd","picker-options":{disabledDate:t.starDataMax}},model:{value:t.formQuery.beginDate,callback:function(e){t.$set(t.formQuery,"beginDate",e)},expression:"formQuery.beginDate"}}),t._v(" - "),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",align:"right",placeholder:"结束时间","value-format":"yyyy-MM-dd","picker-options":{disabledDate:t.endDataMin}},model:{value:t.formQuery.endDate,callback:function(e){t.$set(t.formQuery,"endDate",e)},expression:"formQuery.endDate"}})],1)]),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"从："}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:function(e){return t.change_left2(t.formQuery.fromId,t.formQuery.toId)}},model:{value:t.formQuery.fromId,callback:function(e){t.$set(t.formQuery,"fromId",e)},expression:"formQuery.fromId"}},t._l(t.fromData,(function(t){return a("el-option",{key:t.id,attrs:{label:t.namecode,value:t.id}})})),1)],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"调到："}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.formQuery.toId,callback:function(e){t.$set(t.formQuery,"toId",e)},expression:"formQuery.toId"}},t._l(t.toData,(function(t){return a("el-option",{key:t.id,attrs:{disabled:t.disabled2,label:t.namecode,value:t.id}})})),1)],1),a("el-form-item",{attrs:{label:"状态："}},[a("el-select",{attrs:{placeholder:"状态"},on:{change:t.onSubmit},model:{value:t.formQuery.nodetype,callback:function(e){t.$set(t.formQuery,"nodetype",e)},expression:"formQuery.nodetype"}},[a("el-option",{attrs:{label:"申请",value:"100601"}}),a("el-option",{attrs:{label:"批准",value:"100609"}}),a("el-option",{attrs:{label:"拒绝",value:"100602"}})],1)],1),a("el-form-item",{staticClass:"overall",staticStyle:{"margin-right":"30px"}},[a("el-button",{attrs:{type:"primary",disabled:t.loadingQuery},on:{click:t.onSubmit}},[t._v("查询")])],1),a("el-form-item",{staticClass:"overall",staticStyle:{"margin-right":"30px"}},[t.buttonPermissions.indexOf(10087)>=0?a("el-button",{attrs:{type:"primary",disabled:t.loadingQuery},on:{click:t.clickTransfers}},[t._v("添加调拨单")]):t._e()],1),t.buttonPermissions.indexOf(10086)>=0?a("el-button",{attrs:{type:"primary",disabled:t.searchCleOderBool||t.loadingQuery},on:{click:function(e){return t.clickAudit(1)}}},[t._v("审核通过")]):t._e(),a("el-dialog",{attrs:{title:"审核提示",visible:t.dialogVisibleAudit,width:"400px"},on:{"update:visible":function(e){t.dialogVisibleAudit=e}}},[a("div",{staticStyle:{"text-align":"center"}},[a("span",[t._v("请问要对已选的"+t._s(this.batchList.length)+"条申请进行以下什么操作！")])]),a("div",{staticStyle:{"margin-top":"24px","text-align":"center"}},[a("el-button",{staticStyle:{"margin-right":"8%"},attrs:{type:"danger"},on:{click:function(e){return t.clickAudit(2)}}},[t._v("拒 绝 申 请")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.clickAudit(1)}}},[t._v("同 意 申 请")])],1),a("div",{staticStyle:{"margin-top":"24px","text-align":"right"}},[a("el-button",{on:{click:function(e){t.dialogVisibleAudit=!1}}},[t._v("取消")])],1)])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingTab,expression:"loadingTab"}],ref:"TableData",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:"",stripe:"","tooltip-effect":"dark","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[t.searchCleOderBool?t._e():a("el-table-column",{attrs:{type:"selection",selectable:t.checkSelectable,width:"55",align:"center"}}),a("el-table-column",{attrs:{property:"id",label:"标识",width:"50",align:"center"}}),a("el-table-column",{attrs:{property:"namecode",label:"调拨单号",align:"center"}}),a("el-table-column",{attrs:{property:"beginWarehouseName",label:" 调出仓库名称",align:"center"}}),a("el-table-column",{attrs:{property:"endWarehouseName",label:"调入仓库名称",align:"center"}}),a("el-table-column",{attrs:{property:"optdate",label:"时间",align:"center",width:"170"}}),a("el-table-column",{attrs:{prop:"nodetype",label:"状态",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(100601==e.row.nodetype?"申请":100609==e.row.nodetype?"批准":"拒绝"))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary"},nativeOn:{click:function(a){return t.clickParticulars(e.row)}}},[t._v("调拨单明细")])]}}])})],1),a("div",{staticClass:"margin-t16 text-right"},[a("AppPage",{attrs:{allTate:t.allTate,currentPage:t.pageNo,pageSize:t.pageSize},on:{handleSizeChange:t.clickSizeChange,handleCurrentChange:t.clickCurrentChange}})],1),a("el-dialog",{attrs:{title:"调拨单明细",width:"80%",visible:t.dialogParticulars},on:{"update:visible":function(e){t.dialogParticulars=e}}},[a("el-table",{attrs:{data:t.particularsData,border:"",stripe:""}},[a("el-table-column",{attrs:{property:"id",label:"ID",width:"60",align:"center"}}),a("el-table-column",{attrs:{property:"namecode",label:"名称",width:"250","show-overflow-tooltip":!0}}),a("el-table-column",{attrs:{property:"specif",label:"规格"}}),a("el-table-column",{attrs:{property:"skuCode",label:"SKU",width:"200"}}),a("el-table-column",{attrs:{property:"inventory",label:"库存",width:"100"}}),a("el-table-column",{attrs:{property:"unit",label:"单位",width:"80"}}),a("el-table-column",{attrs:{property:"saleNum",label:"调拨数量",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.saleNum)+" ")])]}}])}),a("el-table-column",{attrs:{property:"producedate",label:"生产日期"}}),a("el-table-column",{attrs:{property:"optdate",label:"申请时间(调拨时间)",width:"180",align:"center"}}),a("el-table-column",{attrs:{property:"nodetypeName",label:"状态"}}),a("el-table-column",{attrs:{property:"--",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"danger",disabled:"100601"!=e.row.nodetype||"100601"!=t.tableRownodetype||"不成功"===e.row.nodetypeName},on:{click:function(a){return t.set_click_Unlock(e.row)}}},[t._v("撤销")])]}}])})],1)],1),a("el-dialog",{attrs:{visible:t.modifyNumData.sync,title:"修改调拨数量",width:"400px","destroy-on-close":"",center:""},on:{"update:visible":function(e){return t.$set(t.modifyNumData,"sync",e)}}},[a("el-form",{attrs:{model:t.modifyNumData}},[a("el-form-item",{staticStyle:{width:"100%",margin:"auto","line-height":"1.6"}},[a("el-input-number",{staticStyle:{width:"100%"},attrs:{"controls-position":"right",min:1},model:{value:t.modifyNumData.num,callback:function(e){t.$set(t.modifyNumData,"num",e)},expression:"modifyNumData.num"}})],1),a("div",{staticStyle:{color:"red","margin-top":"20px"}},[t._v("当前可调拨数量最大为："+t._s(t.modifyNumData.max))]),a("el-form-item",{staticStyle:{"margin-top":"30px"}},[a("div",{staticStyle:{width:"100%","margin-left":"auto","margin-right":"auto","text-align":"center"}},[a("el-button",{on:{click:function(e){t.modifyNumData.sync=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",disabled:t.modifyNumData.num>t.modifyNumData.max},on:{click:function(e){return t.modifyNumGet()}}},[t._v("确定")])],1)])],1)],1),a("el-dialog",{attrs:{title:"添加调拨单",width:"86%",visible:t.innerVisibleGoods},on:{"update:visible":function(e){t.innerVisibleGoods=e}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0},model:{value:t.formManual,callback:function(e){t.formManual=e},expression:"formManual"}},[a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"从："}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择",disabled:t.newDataManual.length>0},on:{change:function(e){return t.change_left(t.formManual.fromId,t.formManual.toData)}},model:{value:t.formManual.fromId,callback:function(e){t.$set(t.formManual,"fromId",e)},expression:"formManual.fromId"}},t._l(t.formManual.fromData,(function(t){return a("el-option",{key:t.id,attrs:{label:t.namecode,value:t.id}})})),1)],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"调到："}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择",disabled:t.newDataManual.length>0},model:{value:t.formManual.toId,callback:function(e){t.$set(t.formManual,"toId",e)},expression:"formManual.toId"}},t._l(t.formManual.toData,(function(t){return a("el-option",{key:t.id,attrs:{label:t.namecode,value:t.id,disabled:t.disabled}})})),1)],1),a("div",{staticStyle:{display:"inline-block","margin-left":"30px"}},[a("el-button",{attrs:{type:"primary",disabled:1!=t.allocationData.I_opType&&t.newDataManual.length>0},on:{click:function(e){return t.clicklGoods(1)}}},[t._v("添加商品")])],1)],1),a("el-table",{key:t.allocationData.I_opType,attrs:{data:t.newDataManual,border:"",stripe:""}},[1===t.allocationData.I_opType?a("el-table-column",{attrs:{property:"id",width:"50",label:"ID",align:"center"}}):a("el-table-column",{attrs:{type:"index",label:"ID",width:"50",align:"center"}}),a("el-table-column",{attrs:{property:"productName",width:"300",label:"名称"}}),a("el-table-column",{attrs:{property:"specification",label:"规格"}}),a("el-table-column",{attrs:{property:"sku",label:"SKU",width:"200"}}),a("el-table-column",{attrs:{property:"unit1",label:"单位",width:"80"}}),2===t.allocationData.I_opType?a("el-table-column",{attrs:{property:"stock",label:"库存"}}):t._e(),1===t.allocationData.I_opType?a("el-table-column",{attrs:{property:"getnum1",label:"可调拨数量"}}):t._e(),a("el-table-column",{attrs:{property:"num",label:"调拨数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:e.row.getnum1,size:"mini"},model:{value:e.row.num,callback:function(a){t.$set(e.row,"num",a)},expression:"scope.row.num"}})]}}])}),1===t.allocationData.I_opType?a("el-table-column",{attrs:{property:"producedate",label:"生产日期"}}):t._e(),2===t.allocationData.I_opType?a("el-table-column",{attrs:{property:"price",label:"单价"}}):t._e(),2===t.allocationData.I_opType?a("el-table-column",{attrs:{property:"",label:"金额（元）"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(Math.floor(e.row.num*e.row.price*100)/100||0))])]}}],null,!1,757191154)}):t._e(),a("el-table-column",{attrs:{property:"name",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{cursor:"pointer"},attrs:{type:"danger"},on:{click:function(a){return t.delePurchase(e.row.id)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.innerVisibleGoods=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",disabled:0===t.newDataManual.length},on:{click:t.putPurchase}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{width:"70%",title:2===t.allocationData.I_opType?"添加包材":"添加商品",visible:t.innerVisibleGoodsDeailt,"append-to-body":""},on:{"update:visible":function(e){t.innerVisibleGoodsDeailt=e}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"物品名称:"}},[a("el-select",{attrs:{clearable:"",filterable:"",placeholder:"请选择"},on:{change:function(e){return t.goods_get()}},model:{value:t.allocationDataGoodsId,callback:function(e){t.allocationDataGoodsId=e},expression:"allocationDataGoodsId"}},t._l(t.optionsGoods,(function(t){return a("el-option",{key:t.id,attrs:{label:t.namecode,value:t.id}})})),1)],1)],1),a("el-table",{attrs:{data:t.goodsData,border:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",label:"ID",align:"center"}}),a("el-table-column",{attrs:{property:"productName",width:"300",label:"名称"}}),a("el-table-column",{attrs:{property:"specification",label:"规格"}}),a("el-table-column",{attrs:{property:"sku",label:"SKU",width:"200"}}),a("el-table-column",{attrs:{property:"unit",label:"单位",width:"80"}}),a("el-table-column",{attrs:{property:"stock",label:"库存"}}),a("el-table-column",{attrs:{property:"num",label:"调拨数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{disabled:e.row.states,type:"number",min:"0",max:e.row.stock},on:{blur:function(a){return t.blur_number_max(e.row)}},model:{value:e.row.num,callback:function(a){t.$set(e.row,"num",a)},expression:"scope.row.num"}})]}}])}),a("el-table-column",{attrs:{property:"price",label:"单价"}}),a("el-table-column",{attrs:{property:"",label:"金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(Math.floor(e.row.num*e.row.price*100)/100||0))])]}}])}),a("el-table-column",{attrs:{property:"name",width:"100",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{cursor:"pointer"},attrs:{type:"primary",disabled:e.row.states},on:{click:function(a){return t.clicPlanGoods(e.row)}}},[t._v("添加")])]}}])})],1)],1),a("el-dialog",{attrs:{width:"70%",title:2===t.allocationData.I_opType?"添加包材":"添加商品",visible:t.addGoods.sync,"append-to-body":""},on:{"update:visible":function(e){return t.$set(t.addGoods,"sync",e)}}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"物品名称:"}},[a("el-input",{model:{value:t.addGoods.value,callback:function(e){t.$set(t.addGoods,"value",e)},expression:"addGoods.value"}})],1),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.get_getProductIdAndNameTwo({warehouseId:t.formManual.fromId,type:100303})}}},[t._v("搜索")])],1),a("el-table",{attrs:{data:t.addGoods.listTable,border:"",stripe:"","max-height":"480px"}},[a("el-table-column",{attrs:{property:"id",width:"50",label:"标识",align:"center"}}),a("el-table-column",{attrs:{property:"namecode",width:"300",label:"名称"}}),a("el-table-column",{attrs:{property:"specif",label:"规格"}}),a("el-table-column",{attrs:{property:"sku",label:"SKU",width:"200"}}),a("el-table-column",{attrs:{property:"unit1",label:"单位",width:"80"}}),a("el-table-column",{attrs:{property:"getnum1",label:"可调拨数"}}),a("el-table-column",{attrs:{property:"num",label:"调拨数量",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,max:e.row.getnum1,size:"mini"},model:{value:e.row.num,callback:function(a){t.$set(e.row,"num",a)},expression:"scope.row.num"}})]}}])}),a("el-table-column",{attrs:{property:"producedate",label:"生产日期"}}),a("el-table-column",{attrs:{property:"name",width:"100",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{staticStyle:{cursor:"pointer"},attrs:{type:"primary",disabled:e.row.states},on:{click:function(a){return t.clicPlanGoods(e.row)}}},[t._v("添加")])]}}])})],1)],1)],1)},o=[],r=a("5530"),i=(a("d3b7"),a("25f0"),a("159b"),a("c740"),a("d81d"),a("2f62")),s=a("b973"),l=a("4795"),u=a("2a02"),d=a("a80d"),c=a("85ec"),m={components:{AppPage:c["a"]},data:function(){return{scrollTop:0,scrollLeft:0,tableRown:"",tableRowId:"",tableRownodetype:"",addGoods:{sync:!1,listTable:[],push:[],value:""},loadingTab:!1,loadingQuery:!1,allTate:1,tableData:[],searchCleOderBool:!1,formQuery:{value2:"",fromId:"",toId:"",nodetype:"100601",beginWareshouseId:"",endWareshouseId:"",namecode:""},paramData:{},fromDataQuery:[],toDataQuery:[],dialogParticulars:!1,particularsData:[],innerVisibleGoods:!1,gridData:[],formManual:{fromData:[],toData:[]},innerVisibleGoodsDeailt:!1,goodsName:"",fromData:[],toData:[],goodsData:[],batchList:[],dialogVisibleAudit:!1,newDataManual:[],optionsGoods:[],allocationData:{},allocationDataGoodsId:"",formGoods:{productId:""},modifyNumData:{id:"",num:0,sync:!1,row:null},buttonPermissions:[],pageSize:24,pageNo:1}},computed:Object(r["a"])({},Object(i["c"])({roles:"roles",userId:"user/userId",name:"user/name"})),created:function(){this.buttonPermissions=this.roles[0].buttonPermissions,this.getShopperList();var t={nodetype:"100601"};this.paramData=t,this.pageNo=1,this.getTransfersList(this.paramData,this.pageNo)},methods:{set_click_Unlock:function(t){var e=this,a={I_ids:t.sourceid+"-"+t.num,I_optuser:this.userId,I_sId:t.id,I_inType:100602};this.$confirm("你确定要撤销吗？","提示",{confirmButtonText:"确定"}).then((function(){e.set_goods_Unlock(a)})).catch((function(){}))},set_goods_Unlock:function(t){var e=this;this.loadingQuery=!0,Object(s["j"])(t).then((function(t){e.loadingQuery=!1,200===t.code&&(t.data[0].flag>0?(e.$message.success(t.data[0].result),e.getTransfersList(e.paramData,1),e.clickParticulars(e.tableRown,1)):e.$message.warning(t.data[0].result))}))},to_examine:function(t){var e=this,a={I_ids:t.toString(),I_optuser:this.userId};this.$confirm("你确定要对已选的"+t.length+"条数据进行审核通过吗？","提示",{confirmButtonText:"确定"}).then((function(){e.set_to_Examine(a)})).catch((function(){}))},set_to_Examine:function(t){var e=this;this.loadingQuery=!0,Object(s["m"])(t).then((function(t){e.loadingQuery=!1,200===t.code&&(t.data[0].flag>0?(e.$message.success(t.data[0].result),e.getTransfersList(e.paramData,1)):e.$message.warning(t.data[0].result))}))},putPurchase_goods:function(){var t=this,e={I_ids:"",I_optuser:this.userId,I_sId:this.formManual.toId,I_outType:100601},a=[],n=!1;for(var o in this.newDataManual){var r=this.newDataManual[o];if(r.num<=0){n=!0;break}var i=this.count_price2(r.num,r.unitbit1);a.push(r.id+"-"+i)}n?this.$message.warning("输入调拨数不能为0"):(e.I_ids=a.toString(),this.$confirm("你确定要生成新的调拨单吗？生成后对应的仓库与数量将会被锁单.","提示",{confirmButtonText:"确定"}).then((function(){t.get_goods_lock_list(e)})).catch((function(){})))},get_goods_lock_list:function(t){var e=this;Object(s["k"])(t).then((function(t){200===t.code&&(t.data[0].flag>0?(e.$message.success("添加成功!"),e.innerVisibleGoods=!1,e.pageNo=1,e.getTransfersList(e.paramData,e.pageNo)):e.$message.warning(t.data[0].result))}))},starDataMax:function(t){if(this.formQuery.endDate)return t.getTime()>=Date.parse(this.formQuery.endDate)},endDataMin:function(t){if(this.formQuery.beginDate)return t.getTime()<=Date.parse(this.formQuery.beginDate)-864e5},blur_number_max:function(t){t.num>t.stock&&(t.num=t.stock),("e"===t.num||t.num<0)&&(t.num=0)},get_getProductIdAndNameTwo:function(t){var e=this,a={goodsName:this.addGoods.value,warehouseId:t.warehouseId};Object(s["a"])(a).then((function(t){if(200===t.code){var a=t.data;a.forEach((function(t){t.num=0,t.states=!1,e.newDataManual.forEach((function(e){t.id===e.id&&(t.states=!0)}))})),e.addGoods.listTable=a,e.addGoods.sync=!0}}))},getTransfersList:function(t,e){var a=this;this.loadingTab=!0,this.allTate--,Object(s["i"])(t,e).then((function(t){if(a.loadingWeb=!1,a.loadingQuery=!1,a.loadingTab=!1,200===t.code){var e=t.data;e.length>0?(a.tableData=e,1===a.pageNo&&(a.pageSize=e.length),a.allTate=(a.pageNo-1)*a.pageSize+e.length,e.length===a.pageSize&&a.allTate++):(a.pageNo>1?a.$message({type:"success",message:"这是最后一页了!"}):a.tableData=[],a.pageNo--)}else a.$message({message:t.message,type:"warning"})}))},change_left:function(t,e){e.forEach((function(e){e.id===t?e.disabled=!0:e.disabled=!1})),this.formManual.toId===this.formManual.fromId&&(this.formManual.toId="")},change_left2:function(t){this.toData.forEach((function(e){e.id===t?e.disabled2=!0:e.disabled2=!1})),this.formQuery.toId===this.formQuery.fromId&&(this.formQuery.toId="")},onSubmit:function(){var t={nodetype:"100601"},e=this.formQuery;"100601"===e.nodetype?this.searchCleOderBool=!1:this.searchCleOderBool=!0,e.beginWareshouseId&&(t.beginWareshouseId=e.beginWareshouseId),e.endWareshouseId&&(t.endWareshouseId=e.endWareshouseId),e.namecode&&(t.namecode=e.namecode),e.nodetype&&(t.nodetype=e.nodetype),e.fromId&&(t.beginWarehouseId=e.fromId),e.toId&&(t.endWarehouseId=e.toId),this.paramData=t,this.pageNo=1,this.getTransfersList(this.paramData,this.pageNo)},clickParticulars:function(t,e){this.tableRowId=t.id,this.tableRownodetype=t.nodetype,this.tableRown=t,this.dialogParticulars=!0;var a={rela:this.tableRowId};this.particulars_paramData=a,this.getFindTransferPlanRecords(a,1,e)},modifyNum:function(t){this.modifyNumData.row=t,this.modifyNumData.max=t.inventory,this.modifyNumData.num=t.num,this.modifyNumData.id=t.id,this.modifyNumData.sync=!0},modifyNumGet:function(){var t=this,e={id:this.modifyNumData.id,num:this.modifyNumData.num,productId:this.modifyNumData.row.productId,skuCode:this.modifyNumData.row.skuCode,warehouseId:this.modifyNumData.row.beginWarehouseId};Object(s["o"])(e).then((function(e){200===e.code&&(t.$message({message:"修改成功",type:"success"}),t.modifyNumData.sync=!1,t.getFindTransferPlanRecords(t.particulars_paramData,1),t.getTransfersList(t.paramData,t.pageNo))}))},getFindTransferPlanRecords:function(t,e,a){var n=this;Object(s["f"])(t,e).then((function(t){if(200===t.code){n.particularsData=t.data;var e=n.particularsData.findIndex((function(t){return"100601"===t.nodetype}));1===a&&e<0&&(n.dialogParticulars=!1,n.$message.warning("已全部撤销"))}else n.$message({message:t.message,type:"warning"})}))},Copy_data:function(t){return this.toDataQuery},clickTransfers:function(){var t=this;this.innerVisibleGoods=!0,this.newDataManual=[],this.formManual={fromId:"",toId:1,toData:[],fromData:[]},this.toDataQuery.forEach((function(e){t.formManual.fromData.push(e),1===e.data&&t.formManual.toData.push(e)}))},clickAudit:function(t){for(var e=this,a=this.batchList,n=[],o=0;o<a.length;o++)n.push(a[o].id);if(n.length)if(1!==t)if(3!==t){var r={idList:n,auditType:t},i=2===t?"你确定拒绝已选"+a.length+"条申请吗！":"你确定审核通过已选"+a.length+"条申请吗！";this.$confirm(i,{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){2!==t?e.postAudit(r):e.postAudit_No(r)}))}else this.dialogVisibleAudit=!0;else this.to_examine(n);else this.$message({message:"请选择审核内容",type:"warning"})},postAudit_No:function(t){var e=this;Object(s["l"])(t).then((function(t){if(200===t.code){var a="完成审核";t.data.errorMessage&&(a=t.data.errorMessage),e.$message({type:"success",message:a}),e.dialogVisibleAudit=!1,e.pageNo=1,e.getTransfersList(e.paramData,e.pageNo)}}))},postAudit:function(t){var e=this,a=t.idList.length,n={I_ids:t.idList.toString(),I_userId:this.userId};Object(s["c"])(n).then((function(t){if(200===t.code){var n="完成审核";if(t.data){var o=t.data[0].suess;n=a<=o?"审核通过数量为"+o+"个":"审核通过数量为"+o+"个,失败个数为"+(a-o)+"个"}e.$message({type:"success",message:n}),e.dialogVisibleAudit=!1,e.pageNo=1,e.getTransfersList(e.paramData,e.pageNo)}}))},newDataManual_push:function(t){this.$message({type:"success",message:"添加成功!"}),100303===this.clicklGoods_type&&(t.productName=t.namecode,t.specification=t.specif),this.newDataManual.push(t),t.states=!0},clicPlanGoods:function(t){var e=this;100301===this.clicklGoods_type&&(t.id2=0,t.targetId=t.id2),t.id2||0===t.id2?this.newDataManual_push(t):Object(s["d"])({warehouseId:this.formManual.toId,skuCode:t.sku}).then((function(a){200===a.code&&(a.data?(t.id2=a.data,t.targetId=t.id2,e.newDataManual_push(t)):e.$confirm("目标仓库没有该商品，是否为仓库添加商品?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){e.$message({type:"success",message:"正在为你添加中!"}),e.copyProductToNewFactoryTwo({warehouseId:e.formManual.toId,skuCode:t.sku,nodeType:100303},t)})).catch((function(){})))}))},copyProductToNewFactoryTwo:function(t,e){var a=this;Object(s["b"])(t).then((function(t){200===t.code&&(e.id2=t.data,e.targetId=e.id2,a.newDataManual_push(e))}))},clicklGoods:function(t){if(this.formManual.fromId)if(this.formManual.toId){if(this.formManual.fromId===this.formManual.toId)return this.$message({message:"选择的两个仓库不能一样",type:"warning"}),void(this.formManual.toId="");this.goodsName="";var e={I_from_fid:this.formManual.fromId,I_to_fid:this.formManual.toId,I_goodid:0,I_opType:t};this.allocationDataGoodsId="",this.allocationData=e,1===t?(this.clicklGoods_type=100303,this.addGoods.value="",this.addGoods.warehouseId=this.formManual.fromId,this.get_getProductIdAndNameTwo({warehouseId:this.formManual.fromId,type:100303})):(this.clicklGoods_type=100301,this.getProductIdAndNameTwo({warehouseId:this.formManual.fromId,type:100301,Two:!0}),this.findKdbmx(e))}else this.$message({message:"请选择目标仓库",type:"warning"});else this.$message({message:"确定需要从什么调那里的商品厂家",type:"warning"})},getAllProductInfo:function(t){var e=this,a={factoryId:t.warehouseId,nodeType:100301};Object(d["d"])(a).then((function(t){200===t.code?e.optionsGoods=t.data:e.$message({message:t.message,type:"warning"})}))},getProductIdAndNameTwo:function(t){var e=this,a=Object(r["a"])({},t);Object(d["i"])(a).then((function(t){200===t.code?e.optionsGoods=t.data:e.$message({message:t.message,type:"warning"})}))},goods_get:function(){var t=this.allocationData;t.I_goodid=this.allocationDataGoodsId,t.I_goodid=""===t.I_goodid?0:t.I_goodid,this.findKdbmx(t)},delePurchase:function(t){var e=this;this.$confirm("此操作将删除商品信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["a"])(e.newDataManual,t),e.$message({type:"success",message:"删除成功!"})})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},getShopperList:function(){var t=this;Object(u["h"])().then((function(e){200===e.code?(t.toDataQuery=e.data,t.fromDataQuery=e.data,t.fromData=Object(r["a"])({},e.data),e.data.forEach((function(e){1===e.data&&t.toData.push(e)}))):t.$message({message:e.message,type:"warning"})}))},findKdbmx:function(t){var e=this;Object(s["e"])(t).then((function(a){e.loadingWeb=!1,e.loadingQuery=!1,200===a.code&&(a.data.length>0?(e.goodsData=a.data.map((function(t){return t.states=!1,e.newDataManual.forEach((function(e){t.sku===e.sku&&(t.states=!0)})),t.stock=t.maxnum?t.maxnum:t.stock,t.productName=t.namecode?t.namecode:t.productName,t.id=t.id1?t.id1:0===t.id1?0:t.id,(t.id2||0===t.id2)&&(t.targetId=t.id2),t})),e.innerVisibleGoodsDeailt=!0):e.$message({message:2===t.I_opType?"当前可调包材为空":"当前可调商品为空",type:"warning"}))}))},getTransferProductList:function(t){var e=this;Object(s["h"])(t).then((function(t){e.loadingWeb=!1,e.loadingQuery=!1,200===t.code?e.goodsData=t.data.map((function(t){return t.states=!1,t})):e.$message({message:t.message,type:"warning"})}))},onSubmitGoods:function(){var t=this.goodsName,e={warehouseId:this.formManual.fromId,targetWarehouseId:this.formManual.toId,productName:t};this.getTransferProductList(e)},putPurchase:function(){var t=this;if(100303!==this.clicklGoods_type){var e=[];this.newDataManual.forEach((function(a){var n={id:a.id,num:1*a.num,targetId:a.targetId,sku:a.sku};100301===t.clicklGoods_type&&(n.nodeType=t.clicklGoods_type),e.push(n)}));var a={beginWarehouseId:this.formManual.fromId,endWarehouseId:this.formManual.toId,productInfoList:e};this.getTransferInsert(a)}else this.putPurchase_goods()},getTransferInsert:function(t){var e=this;Object(s["g"])(t).then((function(t){e.loadingWeb=!1,e.loadingQuery=!1,200===t.code&&(e.$message({type:"success",message:"添加成功!"}),e.innerVisibleGoods=!1,e.pageNo=1,e.getTransfersList(e.paramData,e.pageNo))}))},clickExport:function(){this.$message({message:"正在开发中",type:"warning"})},clickSizeChange:function(t){this.loadingTab=!0},clickCurrentChange:function(t){this.pageNo=t,this.getTransfersList(this.paramData,this.pageNo)},paging:function(t){0===t?this.pageNo=1:t>0?this.pageNo++:t<0&&this.pageNo--,this.getTransfersList(this.paramData,this.pageNo)},handleSelectionChange:function(t){this.batchList=t},checkSelectable:function(t){return"100601"!==t.stateNum},clickDetail:function(){this.innerVisibleGoods=!0},add:function(){this.info.isTrue=!0,this.info.isShow=!0},viewDetail:function(){this.info.isTrue=!0,this.info.isShow=!0}},mounted:function(){},activated:function(){var t=this;setTimeout((function(){t.$refs.TableData.bodyWrapper.scrollTop=t.scrollTop,t.$refs.TableData.bodyWrapper.scrollLeft=t.scrollLeft}),60)},beforeRouteLeave:function(t,e,a){this.scrollTop=this.$refs.TableData.bodyWrapper.scrollTop,this.scrollLeft=this.$refs.TableData.bodyWrapper.scrollLeft,a()}},f=m,p=(a("0b29"),a("2877")),h=Object(p["a"])(f,n,o,!1,null,"c7e985a6",null);e["default"]=h.exports}}]);