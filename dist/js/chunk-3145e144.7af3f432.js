(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3145e144"],{"221e":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-conent main-conent-minheight flex-main-conent"},[a("div",{staticClass:"flex-box"},[a("div",{staticClass:"flex-top"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0},model:{value:t.formQuery,callback:function(e){t.formQuery=e},expression:"formQuery"}},[a("div",{staticClass:"block"},[a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"日期从："}},[a("div",{staticClass:"block"},[a("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",align:"right",placeholder:"开始日期","value-format":"yyyy-MM-dd","picker-options":{disabledDate:t.starDataMax}},model:{value:t.formQuery.startDate,callback:function(e){t.$set(t.formQuery,"startDate",e)},expression:"formQuery.startDate"}}),t._v(" - "),a("el-date-picker",{staticStyle:{width:"140px"},attrs:{type:"date",align:"right",placeholder:"结束时间","value-format":"yyyy-MM-dd","picker-options":{disabledDate:t.endDataMin}},model:{value:t.formQuery.endDate,callback:function(e){t.$set(t.formQuery,"endDate",e)},expression:"formQuery.endDate"}})],1)]),t.userRoles_type?a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"收货区域："}},[a("AppRegion",{ref:"child",attrs:{state:101},on:{valueRegion:t.chengRegion}})],1):t.userRoles_type2?a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"负责收货区:"}},[a("AppRegiongMy",{ref:"child",attrs:{state:101,userId:t.userId},on:{valueRegion:t.chengRegion}})],1):t._e()],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"承运公司："}},[a("el-input",{attrs:{clearable:""},model:{value:t.formQuery.logisticsName,callback:function(e){t.$set(t.formQuery,"logisticsName",e)},expression:"formQuery.logisticsName"}})],1),a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"物流单号："}},[a("el-input",{attrs:{clearable:""},model:{value:t.formQuery.logisticsNum,callback:function(e){t.$set(t.formQuery,"logisticsNum",e)},expression:"formQuery.logisticsNum"}})],1),a("el-form-item",{staticStyle:{"margin-right":"70px"},attrs:{label:"状态："}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},on:{change:t.onSubmit},model:{value:t.formQuery.nodeType,callback:function(e){t.$set(t.formQuery,"nodeType",e)},expression:"formQuery.nodeType"}},[a("el-option",{attrs:{label:"出库待确认",value:"103000"}},[t._v("出库待确认")]),a("el-option",{attrs:{label:"出库已确认",value:"103001"}},[t._v("出库已确认")]),a("el-option",{attrs:{label:"已发货",value:"103002"}},[t._v("已发货")])],1)],1),a("el-button",{staticStyle:{"margin-right":"30px"},attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("查询")])],1)],1),a("div",{staticClass:"flex-cont"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingTab,expression:"loadingTab"}],ref:"TableData",staticStyle:{width:"100%"},attrs:{data:t.tableData,stripe:"",border:"",height:"100%","tooltip-effect":"dark","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{property:"id",label:"标识",width:"50",align:"center"}}),a("el-table-column",{attrs:{property:"namecode",label:"发货单号",align:"center"}}),a("el-table-column",{attrs:{property:"tracking",label:"物流单号/车牌号",align:"center"}}),a("el-table-column",{attrs:{property:"logisticsName",label:"承运公司",align:"center"}}),a("el-table-column",{attrs:{property:"snum",label:"总件数",align:"center"}}),a("el-table-column",{attrs:{property:"vdata.consigneeName",label:"收货人",align:"center"}}),a("el-table-column",{attrs:{property:"receivingArea",label:"收货区域",align:"center"}}),a("el-table-column",{attrs:{property:"nodetype",label:"状态",align:"center"}}),a("el-table-column",{attrs:{property:"vdata.logisticsDocuments",label:"物流凭证",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["准备发货"!=e.row.nodetype&&e.row.vdata.logisticsDocuments.length?a("div",t._l(e.row.vdata.logisticsDocuments,(function(t,i){return a("el-image",{key:i,staticStyle:{width:"40px",height:"40px"},attrs:{src:t,"preview-src-list":e.row.vdata.logisticsDocuments,fit:"contain"}})})),1):a("p",[t._v("-")])]}}])}),a("el-table-column",{attrs:{property:"optdate",label:"发货时间",align:"center",width:"95px"}}),a("el-table-column",{attrs:{property:"getdate",label:"收货时间",align:"center",width:"95px"}}),a("el-table-column",{attrs:{label:"操作",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return["103001"==e.row.type?a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.ManagementAddressUpdate(e.row,1)}}},[t._v("发货")]):t._e(),["103001"].indexOf(e.row.type)<0?a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.viewdetail(e.row)}}},[t._v("查看明细")]):t._e()]}}])})],1)],1),a("div",{staticClass:"flex-button"},[a("div",{staticClass:"margin-t16 text-right"},[a("AppPaging",{attrs:{total:t.allTate,pageSize:t.paramData.pageSize,currentPage:t.paramData.page},on:{handleCurrentChange:t.handleCurrentChange,handleSizeChange:t.handleSizeChange}})],1)])]),a("el-dialog",{attrs:{title:"物流发货单明细","append-to-body":"",visible:t.AddAddressVisible4,width:"85%"},on:{"update:visible":function(e){t.AddAddressVisible4=e}}},[a("el-descriptions",[a("el-descriptions-item",{attrs:{label:"承运公司"}},[t._v(t._s(t.tableData10.logisticsName))]),a("el-descriptions-item",{attrs:{label:"物流单号/车牌号"}},[t._v(t._s(t.tableData10.tracking))]),a("el-descriptions-item",{attrs:{label:"收货地址"}},[t._v(t._s(t.tableData10.receivingArea))]),a("el-descriptions-item",{attrs:{label:"发货人"}},[t._v(t._s(t.consignernew1))]),a("el-descriptions-item",{attrs:{label:"发货人手机号"}},[t._v(t._s(t.consignerPhonenew1))])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingTab,expression:"loadingTab"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData11,stripe:"",border:"","max-height":"350px","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{property:"id",label:"标识",align:"center"}}),a("el-table-column",{attrs:{property:"",label:"订单明细",align:"center","min-width":"500"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"shipping-tr-box"},[a("div",{staticClass:"tr-li-flex"},[a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("客户名称：")]),t._v(t._s(e.row.vdata&&e.row.vdata.customerName||""))])])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("商品名称：")]),a("el-tooltip",{attrs:{content:e.row.namecode,placement:"top",effect:"light"}},[a("el-button",{staticClass:"namecode",attrs:{type:"text"}},[t._v(t._s(e.row.namecode))])],1)],1)]),a("div",{staticClass:"tr-li-flex"},[a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("规格：")]),t._v(t._s(e.row.specif))])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("单位：")]),t._v(t._s(e.row.unit))])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("出货仓库：")]),t._v(t._s(e.row.warehouseName))])])]),a("div",{staticClass:"tr-li-flex"},[a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("订单数量：")]),t._v(t._s(e.row.productNum))])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("拼车费：")]),t._v(t._s(e.row.carpool))])]),a("div",{staticClass:"tr-li",staticStyle:{"min-width":"80px"}},[a("div",{staticClass:"tr-name"},[a("span",[t._v("运费：")]),t._v(t._s(e.row.freight||0))])])]),a("div",{staticClass:"tr-li",staticStyle:{"min-width":"80px"}},[a("div",{staticClass:"tr-name"},[a("span",[t._v("详细收货地址：")]),t._v(t._s(e.row.vdata.address||0))])])])]}}])}),a("el-table-column",{attrs:{property:"num",label:"发货数量",align:"center"}}),a("el-table-column",{attrs:{property:"sendNum",label:"已发货数量",align:"center",width:"100"}}),a("el-table-column",{attrs:{property:"snum",label:"运输数量",align:"center"}}),a("el-table-column",{attrs:{property:"actualCarpool",label:"实际拼车费",align:"center",width:"95"}}),a("el-table-column",{attrs:{property:"--",label:"厂家单号",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.factoryNum,(function(e,i){return a("div",{key:i,staticStyle:{"margin-bottom":"5px","line-height":"1.2","text-align":"left"}},[t._v(" "+t._s(e)+" ")])}))}}])}),a("el-table-column",{attrs:{property:"--",label:"厂家相关图片",align:"center","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"max-height":"130px",overflow:"auto"}},t._l(e.row.factoryDocuments,(function(t,i){return a("div",{key:i,staticStyle:{"margin-bottom":"5px",position:"relative"}},[a("el-image",{staticClass:"image_box",staticStyle:{width:"40px",height:"40px",border:"1px solid #dedede","background-color":"#fff","border-radius":"3px"},attrs:{src:t,"preview-src-list":e.row.factoryDocuments,fit:"contain"}})],1)})),0)]}}])}),a("el-table-column",{attrs:{property:"",label:"更多信息",align:"center","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"shipping-tr-box shipping-tr-box2"},[a("div",{staticClass:"tr-li-flex"},[a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name carNum-c"},[a("span",[t._v("车牌号：")]),a("el-input",{staticStyle:{border:"none"},attrs:{value:e.row.carNum,size:"mini"}})],1)]),a("div",{staticClass:"tr-li",staticStyle:{margin:"10px 0px 10px 10px",width:"auto","padding-right":"46px"}},[a("div",{staticClass:"tr-name"},[a("span",[t._v("物流单：")]),t._v(" "+t._s(1===e.row.isReceipt?"有":"无")+" ")])])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name",staticStyle:{"line-height":"1.4"}},[a("span",[t._v("备注：")]),t._v(" "+t._s(e.row.remarks||"（无备注）")+" ")])])])]}}])})],1),"准备发货"!=t.tableData10.nodetype?a("div",{staticClass:"url",staticStyle:{display:"flex","margin-top":"10px"}},[t._v(" 物流凭证： "),t.tableData10.logisticsDocuments?a("div",t._l(t.tableData10.logisticsDocuments,(function(e,i){return a("el-image",{key:i,staticStyle:{width:"100px",height:"100px","margin-right":"10px"},attrs:{src:e,"preview-src-list":t.tableData10.logisticsDocuments,fit:"contain"}})})),1):t._e()]):t._e(),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.AddAddressVisible4=!1}}},[t._v("返回")]),"已收货"!=t.tableData10.nodetype?a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.affirm(1)}}},[t._v("确认收货")]):t._e()],1)],1),a("el-dialog",{attrs:{title:"物流单发货","append-to-body":"",visible:t.AddAddressVisible,width:"90%","max-height":"400px"},on:{"update:visible":function(e){t.AddAddressVisible=e}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingTab,expression:"loadingTab"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.tableData3,stripe:"",border:"","tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{property:"id",label:"标识",width:"50",align:"center"}}),a("el-table-column",{attrs:{property:"",label:"订单明细",align:"center","min-width":"500"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"shipping-tr-box"},[a("div",{staticClass:"tr-li-flex"},[a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("客户名称：")]),t._v(t._s(e.row.vdata&&e.row.vdata.customerName||""))])])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("商品名称：")]),a("el-tooltip",{attrs:{content:e.row.namecode,placement:"top",effect:"light"}},[a("el-button",{staticClass:"namecode",attrs:{type:"text"}},[t._v(t._s(e.row.namecode))])],1)],1)]),a("div",{staticClass:"tr-li-flex"},[a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("规格：")]),t._v(t._s(e.row.specif))])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("单位：")]),t._v(t._s(e.row.unit))])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("出货仓库：")]),t._v(t._s(e.row.warehouseName))])])]),a("div",{staticClass:"tr-li-flex"},[a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("订单数量：")]),t._v(t._s(e.row.productNum))])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("发货数量：")]),t._v(t._s(e.row.cop_num))])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("拼车费：")]),t._v(t._s(e.row.carpool))])]),a("div",{staticClass:"tr-li",staticStyle:{"min-width":"80px"}},[a("div",{staticClass:"tr-name"},[a("span",[t._v("运费：")]),t._v(t._s(e.row.freight||0))])])])])]}}])}),a("el-table-column",{attrs:{property:"--",label:"实际发货数量",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{display:"flex"}},[a("el-input",{staticStyle:{width:"100%"},attrs:{min:0,type:"number",disabled:!0},on:{input:t.sumchange},model:{value:e.row.num,callback:function(a){t.$set(e.row,"num",a)},expression:"scope.row.num"}}),a("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.choice_get(e.row,e.$index)}}},[t._v("选择")])],1)]}}])}),a("el-table-column",{attrs:{property:"sendNum",label:"已发货数量",align:"center",width:"94"}}),a("el-table-column",{attrs:{property:"actualCarpool",label:"实际拼车费",align:"center","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{staticStyle:{display:"none"},attrs:{min:0},model:{value:e.row.actualCarpool,callback:function(a){t.$set(e.row,"actualCarpool",a)},expression:"scope.row.actualCarpool"}}),a("el-input",{staticStyle:{width:"100%"},attrs:{min:0,type:"number"},on:{input:t.sumchange},model:{value:e.row.actualCarpool,callback:function(a){t.$set(e.row,"actualCarpool",a)},expression:"scope.row.actualCarpool"}})]}}])}),a("el-table-column",{attrs:{property:"--",label:"厂家单号",align:"center","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.factoryNum,(function(e,i){return a("div",{key:i,staticStyle:{"margin-bottom":"5px","line-height":"1.2","text-align":"left"}},[t._v(" "+t._s(e)+" ")])}))}}])}),a("el-table-column",{attrs:{property:"--",label:"厂家相关图片",align:"center","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticStyle:{"max-height":"120px",overflow:"auto"}},t._l(e.row.factoryDocuments,(function(t,i){return a("div",{key:i,staticStyle:{"margin-bottom":"5px",position:"relative"}},[a("el-image",{staticClass:"image_box",staticStyle:{width:"40px",height:"40px",border:"1px solid #dedede","background-color":"#fff","border-radius":"3px"},attrs:{src:t,"preview-src-list":e.row.factoryDocuments,fit:"contain"}})],1)})),0)]}}])}),a("el-table-column",{attrs:{property:"",label:"更多信息",align:"center","min-width":"300"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"shipping-tr-box shipping-tr-box2"},[a("div",{staticClass:"tr-li-flex"},[a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name"},[a("span",[t._v("车牌号：")]),t._v(" "+t._s(e.row.carNum)+" ")])]),a("div",{staticClass:"tr-li",staticStyle:{margin:"10px 0px 10px 10px",width:"auto","padding-right":"46px"}},[a("div",{staticClass:"tr-name"},[a("span",[t._v("物流单：")]),t._v(" "+t._s(1===e.row.isReceipt?"有":"无")+" ")])])]),a("div",{staticClass:"tr-li"},[a("div",{staticClass:"tr-name",staticStyle:{"line-height":"1.4"}},[a("span",[t._v("备注：")]),t._v(" "+t._s(e.row.remarks||"（无备注）")+" ")])])])]}}])})],1),a("el-form",{staticClass:"demo-form-inline",staticStyle:{"margin-bottom":"5px","margin-top":"20px"},attrs:{inline:!0},model:{value:t.tableData4,callback:function(e){t.tableData4=e},expression:"tableData4"}},[a("el-form-item",{staticStyle:{"margin-right":"30px"},attrs:{label:"*物流单号/车牌号:"}},[a("el-input",{attrs:{placeholder:""},model:{value:t.tableData4.tracking,callback:function(e){t.$set(t.tableData4,"tracking",e)},expression:"tableData4.tracking"}})],1),a("el-form-item",{attrs:{label:"*承运公司:"}},[a("LogisticsSearch",{ref:"LogisticsSearch",attrs:{value:t.tableData4.logisticsIdstr},on:{change:t.output_logistics}}),a("el-button",{attrs:{type:"primary"},on:{click:t.carrierInfoList2}},[t._v("选择物流公司")])],1),a("div"),a("el-row",[a("el-col",{attrs:{span:6}},[a("span",[t._v("* 上传物流清单凭证(JPG或PNG格式 不能大于300k):")])]),t.AddAddressVisible?a("el-col",{attrs:{span:16}},[a("ManyUploadUrl",{ref:"ManyUploadUrl",attrs:{setfileList:this.imageUrl},on:{change:t.getImgUrl}})],1):t._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.confirmDelivery}},[t._v("确定发货")])],1)],1),a("ChoiceLogistics",{ref:"ChoiceLogistics",attrs:{logisticsSync:t.AddAddressVisible2},on:{output_logistics:t.output_logistics}}),a("ShippingLogisticsBatch",{ref:"ShippingLogisticsBatch",on:{getIdNum:t.getIdNum,ToUpDate:t.ShippingLogisticsBatch_ToUpDate}})],1)},s=[],n=a("5530"),r=(a("d3b7"),a("159b"),a("b64b"),a("25f0"),a("a434"),a("2f62")),o=a("da87"),l=a("95a0"),c=a("3f39"),u=a("970d"),d=a("9dce"),m=a("cd7f"),h=a("645b"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"returnStock suit-box"},[a("el-dialog",{attrs:{visible:t.sync,title:"发货选择",width:"50%","destroy-on-close":""},on:{"update:visible":function(e){t.sync=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span",{staticClass:"dialog-footer"},[a("el-button",{on:{click:function(e){t.sync=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submitSuppler}},[t._v("确认")])],1)]},proxy:!0}])},[t.rowData?a("div",{staticClass:"p_demo",staticStyle:{"font-size":"16px","margin-bottom":"15px"}},[a("div",[a("p",[a("span",{},[t._v("商品名称：")]),t._v(t._s(t.rowData.namecode))])]),a("div",{staticStyle:{display:"flex"}},[a("p",{staticStyle:{width:"25%"}},[a("span",{},[t._v("规格：")]),t._v(t._s(t.rowData.specif))]),a("p",{staticStyle:{width:"15%"}},[a("span",{},[t._v("订单数量：")]),t._v(t._s(t.rowData.productNum))]),a("p",{staticStyle:{width:"10%"}},[a("span",{},[t._v("单位：")]),t._v(t._s(t.rowData.unit))]),a("p",{staticStyle:{width:"18%"}},[a("span",{},[t._v("计划待发货数：")]),t._v(t._s(t.rowData.cop_num))]),a("p",{staticStyle:{width:"18%"}},[a("span",{},[t._v("可发货数：")]),t._v(t._s(t.num_2))])]),a("div",{staticStyle:{display:"flex"}})]):t._e(),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loadingTab,expression:"loadingTab"}],ref:"supplerTable",staticStyle:{},attrs:{data:t.tableData,stripe:"",border:"","max-height":"360"},on:{"selection-change":t.ShuntSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",selectable:t.shipmentSelec}}),a("el-table-column",{attrs:{property:"warehouseName",label:"仓库名称"}}),a("el-table-column",{attrs:{property:"optdate",label:"锁单时间",align:"center",width:"160px"}}),a("el-table-column",{attrs:{property:"producedDate",label:"生产日期",align:"center"}}),a("el-table-column",{attrs:{property:"maxNum",label:"可发货数"}}),a("el-table-column",{attrs:{property:"unit_C",label:"本次实际发货数",width:"220px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{key:e.row.id,class:{numberRed:!e.row.isSlection&&t.num>t.num_2},staticStyle:{width:"100%"},attrs:{type:"number",disabled:e.row.isSlection,"controls-position":"right"},on:{change:function(e){return t.countNum()}},model:{value:e.row.num2,callback:function(a){t.$set(e.row,"num2",a)},expression:"scope.row.num2"}}),a("el-input-number",{staticStyle:{display:"none"},attrs:{max:e.row.maxNum,min:0},model:{value:e.row.num2,callback:function(a){t.$set(e.row,"num2",a)},expression:"scope.row.num2"}}),e.row.num2>e.row.num&&!e.row.isSlection?a("span",{staticStyle:{"font-size":"12px",color:"red"}},[t._v("本次发货数不能大于可发货数")]):t._e()]}}])}),a("el-table-column",{attrs:{property:"unit",label:"单位",align:"center",width:"80"}})],1),a("div",{staticStyle:{display:"flex","align-items":"center","justify-content":"space-between","margin-top":"10px"}},[a("p",{style:t.num>t.num_2?"width: 20%;color:red;":"width: 20%;"},[a("span",{},[t._v("实际发货数合计：")]),t._v(t._s(t.num))])])],1)]),a("ModifyDataBox",{ref:"ModifyDataBox",attrs:{rowData:t.ModifyData},on:{ToUpDate:t.ToUpDate}})],1)},g=[],f=(a("c740"),a("b542")),b={components:{ModifyDataBox:f["a"]},props:{},data:function(){return{ModifyData:{},rowData:{namecode:"",sku:"",specif:"",scalnum:"",scalprice:"",unit1:"",outnum:"",sendnum:"",backnum:"",num2:0,num:0},total:0,num:0,num_2:0,radioIdex:"",formQuery:{productName:"",skuCode:""},loadingTab:!1,paramData:{page:1,pageSize:24},sync:!1,row_Index:"",tableData:[],supplerData:{},ShuntSelecArr:[],ShuntSelecId:[]}},created:function(){},computed:Object(n["a"])({},Object(r["c"])({roles:"roles",userId:"user/userId",name:"user/name"})),methods:{ToUpDate:function(t){3===t&&this.get_rowData_list()},get_rowData_list:function(){var t=this,e={trackingDeliveryId:this.rowData.trackingDeliveryId};Object(u["g"])(e).then((function(a){if(200===a.code)for(var i in a.data){var s=a.data[i];if(s.id===t.rowData.id){t.rowData=Object(n["a"])(Object(n["a"])({},e),s),t.rowData.cop_num=t.rowData.num,t.num_2=(1e4*t.rowData.num-1e4*t.rowData.unLockNum)/1e4,t.rowData.actualOutInfos=t.rowData.actualOutInfos||[],t.$emit("getIdNum",t.rowData.id,t.rowData),t.getTabel();break}}}))},modify_Data:function(t){if(t)this.ModifyData=Object(n["a"])(Object(n["a"])({},t),{},{detailId:this.rowData.id,unitbit:this.rowData.unitbit,orderId:this.rowData.orderDetailId,warehouseId:this.rowData.warehouseId,num_2:this.num_2}),this.$refs["ModifyDataBox"].UnlockData.sync=!0;else{var e=(1e4*this.rowData.productNum-1e4*this.num_2-1e4*this.rowData.sendNum)/1e4;this.ModifyData=Object(n["a"])(Object(n["a"])({},this.rowData),{},{num_3:e,num_2:this.num_2,detailId:this.rowData.id,orderId:this.rowData.orderDetailId,warehouseId:this.rowData.warehouseId}),this.$refs["ModifyDataBox"].sync=!0}},shipmentSelec:function(t){return t.num>t.backcount},init:function(t,e){var a=t;this.row_Index=e,a.actualOutInfos=a.actualOutInfos||[],this.num_2=(1e4*t.cop_num-1e4*t.unLockNum)/1e4,this.rowData=a,this.getTabel()},getTabel:function(t){var e=this;Object(l["j"])({orderDetailId:this.rowData.orderDetailId}).then((function(a){if(200===a.code){e.tableData=[];var i=e.num_2,s=[];a.data.forEach((function(t,a){t.num2=t.noBackNum,t.num2=t.num2>e.num_2?e.num_2:t.num2,t.isSlection=!0,t.maxNum=t.noBackNum,i>0&&(t.num2=i>t.maxNum?t.maxNum:i,i=(1e4*i-1e4*t.num2)/1e4,s.push(a))})),e.rowData.actualOutInfos.length&&(s=[],e.rowData.actualOutInfos.forEach((function(t){var e=a.data.findIndex((function(e){return e.id===t.outDetailId}));e>=0&&(a.data[e].num2=t.actualNum,s.push(e))}))),e.tableData=a.data;var n=e;e.tableData.length>0&&s.length>0&&setTimeout((function(){s.forEach((function(t){n.$refs.supplerTable.toggleRowSelection(n.tableData[t])}))}),t||120),e.sync=!0}}))},ShuntSelectionChange:function(t){var e=this;this.ShuntSelecArr=t||[],this.ShuntSelecId=[],this.num=0,this.tableData.forEach((function(t){t.isSlection=!0})),this.ShuntSelecArr.forEach((function(t){e.ShuntSelecId.push(t.id),t.isSlection=!1})),this.countNum()},submitSuppler:function(){var t=this;if(this.ShuntSelecId.length<=0)this.$message.error("请选择要操作的数据");else{var e=[];for(var a in this.ShuntSelecArr){var i=this.ShuntSelecArr[a];if(0===i.num2){e.push("填写数量不能为0");break}}if(e.length)this.$message.error(e.toString());else{var s=[],n=0,r=[];this.ShuntSelecArr.forEach((function(e){n=Math.round(t.count_price2(e.num2,t.rowData.unitbit)),e.num2===e.maxNum&&(n=e.standardNum),s.push(e.id+"-"+n),r.push({outDetailId:e.id,actualNum:e.num2,productDate:e.producedDate})}));s.toString(),this.userId,this.rowData.id;this.num>this.num_2?this.$confirm("输入的值总和比出库未发货的数量还大，无法发货","警告",{confirmButtonText:"确定",type:"warning",showCancelButton:!1}).then((function(){})).catch((function(){})):(this.$emit("ToUpDate",r,this.row_Index,this.num),this.sync=!1)}}},count_price2:function(t,e){return t<=0||0===e?0:1===e?t:e>0?Math.ceil(t*e*1e4)/1e4:Math.ceil(t/e*1e4)/1e4*-1},set_Return_stock_api:function(t){var e=this;Object(l["d"])(t).then((function(t){200===t.code&&(t.data[0].flag>0?(t.data[0].flag>=e.ShuntSelecArr.length?e.$message.success("操作成功"):e.$message.success(t.data[0].result),e.sync=!1,e.$emit("ToUpDate")):e.$message.success(t.data[0].result))}))},countNum:function(){var t=this,e=0,a=0;this.tableData.length&&this.tableData.forEach((function(i){if(!i.isSlection){var s=Math.round(t.count_price2(i.num2,t.rowData.unitbit));i.num2===i.maxNum&&(s=i.standardNum),a=(1e5*a+1e5*s)/1e5,e=(1e5*e+1e5*i.num2)/1e5}})),this.num=e},supplerRadio:function(t){},handleSizeChange:function(t){this.paramData.pageSize=t,this.clickCurrentChange(1)},clickCurrentChange:function(t){this.paramData.page=t,this.getTabel(this.paramData)},onSubmit:function(){var t=Object(n["a"])(Object(n["a"])({},this.paramData),this.formQuery);Object.keys(t).forEach((function(e){var a=t[e];""===a&&delete t[e]})),this.getTabel(t)}}},v=b,y=(a("5d65"),a("2877")),D=Object(y["a"])(v,p,g,!1,null,"66bec880",null),w=D.exports,_=a("2f88"),S=a("c814"),x={components:{ShippingLogisticsBatch:w,LogisticsSearch:h["a"],ManyUploadUrl:m["a"],ChoiceLogistics:d["a"],AppPaging:_["a"],AppRegiongMy:S["a"],AppRegion:c["a"]},data:function(){return{scrollTop:0,scrollLeft:0,returnStockrow:{},snum:0,isReturn:!1,userAreaList:[],AreaId:"",isSubmit:!1,consignernew1:"",consignerPhonenew1:"",userlist:[],rowid:0,currentRow2:[],tableData11:[],AddAddressVisible4:!1,tableData10:[],logourl:"",imageUrl:"",currentRow1:"",tableData3:[],tableData4:{carNum:"",factoryNum:"",logisticsIdstr:null,parcel:"1",phoneNumber:null,tracking:null,userid:null},tableData5:[],tableData6:[],ManagementAddressVisible:!1,ManagementLogisticsVisible:!1,AddAddressVisible:!1,AddAddressVisible2:!1,location:[],options:[],batchList:[],tableData:[],formQuery:{customerName:"",value2:"",productName:"",nodeType:"103001",skuCode:"",logisticsNum:"",logisticsName:""},paramData:{page:1,pageSize:24},loadingTab:!1,optionsGoods:[],chengRegionObje:{},chengRegionObje2:{},allTate:24,currentPage:1,outerVisible:!1,dialogExport:!1,ExportHints:"",idList:[],dialogPromptDelivery:!1,DeliveryForm:{outcount:""},optionsName:[],outcount:"",DeliveryList:[],DeliveryInput:!1,dialogDelivery:!1,max_history:10,historyList:[],dialogTableVisible:!1,gridData:[],buttonPermissions:[],trackingDeliveryId:"",trackingDeliveryIdData:{trackingDeliveryId:"",status:""}}},computed:Object(n["a"])({},Object(r["c"])({roles:"roles",userId:"user/userId",name:"user/name"})),created:function(){var t=this.roles[0].buttonPermissions;this.buttonPermissions=this.roles[0].buttonPermissions,this.isReturn=t.indexOf(10036)>=0,this.userRoles_type=!1,this.userRoles_type2=!1,t.indexOf(10035)>=0&&(this.userRoles_type=!0),t.indexOf(10042)>=0&&(this.userRoles_type2=!0),this.provinceList=this.data,this.userRoles_type?this.onSubmit():this.getTables_isuser(),this.selectUserList()},methods:{getIdNum:function(t,e){for(var a in this.tableData3)if(this.tableData3[a].id===t){this.tableData3[a].cop_num=e.num,this.tableData3[a].unLockNum=e.unLockNum,this.tableData3[a].num=0;break}},starDataMax:function(t){if(this.formQuery.endDate)return t.getTime()>=Date.parse(this.formQuery.endDate)},endDataMin:function(t){if(this.formQuery.startDate)return t.getTime()<=Date.parse(this.formQuery.startDate)-864e5},choice_get:function(t,e){var a=Object(n["a"])(Object(n["a"])({},t),{},{trackingDeliveryId:this.rowid});this.$refs["ShippingLogisticsBatch"].init(a,e)},ShippingLogisticsBatch_ToUpDate:function(t,e,a){this.tableData3[e].actualOutInfos=t,this.tableData3[e].num=a},getTables_isuser:function(){this.formQuery.userId=this.userId,this.onSubmit()},onSubmit:function(){var t=this.formQuery,e=Object(n["a"])({page:1,pageSize:this.paramData.pageSize,cityId:this.chengRegionObje.cityId,provinceId:this.chengRegionObje.provinceId,countyId:this.chengRegionObje.countyId},t);this.paramData=e,this.getTable(e)},ToUpDate:function(){this.getTable(this.paramData)},getTable:function(t){var e=this;Object.keys(t).forEach((function(e){var a=t[e];""===a&&delete t[e]})),this.loadingTab=!0,Object(u["f"])(t).then((function(t){e.loadingWeb=!1,e.loadingQuery=!1,e.loadingTab=!1,200===t.code?(e.allTate=t.data.total,e.currentPage=t.data.pageNum,t.data.list.forEach((function(t){"string"===typeof t.vdata.logisticsDocuments&&(""===t.vdata.logisticsDocuments?t.vdata.logisticsDocuments=[]:t.vdata.logisticsDocuments=[t.vdata.logisticsDocuments]),t.logisticsDocuments=t.vdata.logisticsDocuments})),e.tableData=t.data.list):e.$message({message:t.message,type:"warning"})}))},handleSelectionChange:function(t){this.batchList=t,this.multipleSelection=t},handleSizeChange:function(t){this.paramData.pageSize=t,this.handleCurrentChange(1)},handleCurrentChange:function(t){this.paramData.page=t,this.getTable(this.paramData)},chengRegion3:function(t){this.chengRegionObje.provinceId="",this.chengRegionObje.cityId="",this.chengRegionObje.countyId="",this.formQuery.areaId=t||""},getImgUrl:function(t){this.imageUrl=t,this.logourl=t.toString(),this.logourl=t,this.tableData4.logisticsId=this.currentRow1.id},affirm:function(t){var e=this;this.trackingDeliveryIdData["trackingDeliveryId"]=1*this.trackingDeliveryId,this.trackingDeliveryIdData["status"]=t,Object(u["a"])(this.trackingDeliveryIdData).then((function(t){200===t.code?(e.tableData11=t.data,e.AddAddressVisible4=!1,e.getTable(e.paramData)):e.$message({message:t.message,type:"warning"})}))},selectUserList:function(){var t=this;Object(u["j"])().then((function(e){200===e.code&&(t.userlist=e.data)}))},sumchange:function(){},viewdetail:function(t){var e=this;this.trackingDeliveryId=t.id,this.tableData10=t,this.consignernew1=this.tableData10.vdata.consigner,this.consignerPhonenew1=this.tableData10.vdata.consignerPhone,this.AddAddressVisible4=!0,Object(u["g"])({trackingDeliveryId:t.id}).then((function(t){200===t.code?e.tableData11=t.data:e.$message({message:t.message,type:"warning"})}))},tableCurrentChange:function(t){this.currentRow1=t,this.tableData4.logisticsId=this.currentRow1.id},confirmDelivery:function(){var t=this,e="信息填写不完整：";null!=this.tableData4.tracking&&""!==this.tableData4.tracking||(e+="物流单号；"),null!=this.currentRow2.id&&""!==this.currentRow2.id||(e+="承运公司；"),null!=this.logourl&&""!==this.logourl||(e+="物流清单凭证；");var a=[],i=[];if(this.tableData3.forEach((function(t){i.push({actualOutInfos:t.actualOutInfos,actualCarpool:t.actualCarpool,freight:t.freight,id:t.id,num:t.num,sunit:t.sunit,warehouseId:t.warehouseId}),""!==t.num&&0!==t.num||a.push("实际发货数量；")})),a=this.distinct(a),a.length&&a.forEach((function(t){e+=t})),"信息填写不完整："!==e)this.$message({message:e,type:"warning"});else{var s="";this.userlist.length>0&&this.userlist.forEach((function(e){e.id===t.tableData4.userid&&(s=e.namecode)}));var n=this.tableData4,r={logisticsDocuments:this.logourl,consigner:s,consignerPhone:this.tableData4.phoneNumber,consigneeName:this.tableData4.vdata.consigneeName||this.tableData3[0].vdata.consigneeName,consigneeMobile:this.tableData4.vdata.consigneeMobile||this.tableData3[0].vdata.consigneeMobile,address:this.tableData4.vdata.address||this.tableData3[0].vdata.address},o={id:this.rowid,logisticsDeliveryDetailList:i,logisticsId:this.currentRow2.id,logisticsName:this.currentRow2.namecode,parcel:n.parcel,snum:n.snum,totel:n.totel,tracking:n.tracking,userid:this.tableData4.userid,vdata:r};this.get_confirmDelivery(o)}},distinct:function(t){var e,a,i=[],s=t.length;for(e=0;e<s;e++){for(a=e+1;a<s;a++)t[e]===t[a]&&(a=++e);i.push(t[e])}return i},get_confirmDelivery:function(t){var e=this;Object(l["f"])(t).then((function(t){200===t.code?(e.$message({message:t.message,type:"success"}),e.AddAddressVisible=!1,e.getTable(e.paramData)):e.$message({message:t.message,type:"warning"})}))},output_logistics:function(t,e){this.AddAddressVisible2=!1,2!==e&&(this.currentRow2=t,this.tableData4.logisticsIdstr=this.currentRow2.namecode,this.$refs["LogisticsSearch"].init_value(t.namecode))},carrierInfoList2:function(){this.AddAddressVisible2=!0,this.$refs["ChoiceLogistics"].init_carrierInfoList2()},submin_logistics:function(){var t=this,e=this,a={page:0,pageSize:24,businessArea:e.tableData6.businessArea,provinceId:e.chengRegionObje2.provinceId,cityId:e.chengRegionObje2.cityId,countyId:e.chengRegionObje2.countyId};Object(u["d"])(a).then((function(e){200===e.code?t.tableData5=e.data.list:t.$message({message:e.message,type:"warning"})}))},chengRegion:function(t){var e=t;this.chengRegionObje=e},ManagementAddressUpdate:function(t,e){var a=this;this.snum=0,this.tableData4.vdata=t.vdata,this.tableData4.carNum=t.carNum||"",this.tableData4.userid=t.userid?t.userid:null,this.tableData4.phoneNumber=t.vdata.consignerPhone,this.tableData4.tracking=t.tracking,this.tableData4.parcel=null==t.parcel?1:t.parcel,this.tableData4.logisticsIdstr=t.logisticsName,this.currentRow2.id=t.rela,this.currentRow2.namecode=t.logisticsName,this.imageUrl=t.vdata.logisticsDocuments,this.logourl=this.imageUrl,this.$refs["LogisticsSearch"]&&(this.$refs["LogisticsSearch"].removeData(),this.$refs["LogisticsSearch"].init_value(this.tableData4.logisticsIdstr)),2===e&&(this.tableData10=t),this.AddAddressVisible=!0,this.rowid=t.id,this.$refs["ManyUploadUrl"]&&this.$refs["ManyUploadUrl"].file_list_init(t.vdata.logisticsDocuments);var i={trackingDeliveryId:t.id};Object(u["g"])(i).then((function(t){200===t.code?(t.data.forEach((function(t){t.cop_num=t.num,t.carpool2=t.actualCarpool,t.num=0})),a.snum=t.data.length||0,a.snumMax=t.data.length||0,a.tableData3=t.data,a.sumchange()):a.$message({message:t.message,type:"warning"})}))},inputing:function(t){t.snum=1},selectchange:function(t){var e=this;this.userlist.forEach((function(a){a.id===t&&(e.tableData4.phoneNumber=a.phone)}))},finfUserId:function(t){var e=this.userlist,a=0;return e.forEach((function(e){t===e.namecode&&(a=e.id)})),a},handleCurrentChange2:function(t){this.currentRow2=t,this.tableData4.logisticsIdstr=this.currentRow2.namecode},chengRegion2:function(t){var e=t;this.chengRegionObje2=e},search:function(t){t.length>=2?this.getAllProductInfo(t):this.optionsGoods=[]},searchCle:function(t){t||(this.optionsGoods=[])},getAllProductInfo:function(t){var e=this,a={nodeType:100303,productName:t};Object(o["f"])(a).then((function(t){200===t.code?e.optionsGoods=t.data:e.$message({message:t.message,type:"warning"})}))},checkSelectable:function(t){return 1!==t.nodeTypeBoolean},clickOutboundShipments:function(){var t=this;this.batchList;this.idList=this.batchList;for(var e=[],a=0;a<this.idList.length;a++){var i={};i.orderDetailsId=this.idList[a].id,i.outcount=this.idList[a].outcount,i.warehouseId=this.idList[a].factoryid,e.push(i)}this.batchList.length?this.$confirm("是否确认发货出库?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={deliverGoodsList:e,optId:t.userId};Object(l["m"])(a).then((function(e){200===e.code?(t.$message({type:"success",message:e.message}),t.getTable(t.paramData)):t.$message({type:"warning",message:e.message})}))})).catch((function(){t.$message({type:"info",message:"已取消出库发货"})})):this.$notify({title:"友情提醒 ^_^",message:"请选择(批量)发货出库",type:"warning"})},OutboundShipments:function(t){var e=this;this.dialogPromptDelivery=!0,this.DeliveryList=t,this.DeliveryForm.outcount=t.noOutcount,t.noOutcount>0?this.DeliveryForm.outcount-t.noOutcount>0?this.DeliveryForm.outcount=t.noOutcount:this.outcount=this.DeliveryForm.outcount:0===t.noOutcount&&(t.outnum>0?(setTimeout((function(){e.dialogDelivery=!0}),800),this.DeliveryInput=!0,this.DeliveryForm.outcount=0):this.$alert("该订单已全部发货出库","提示",{confirmButtonText:"确定",callback:function(t){e.dialogPromptDelivery=!1}}))},ClickPromptDelivery:function(){var t=this;this.$confirm("是否确认发货出库?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if(t.DeliveryList.noOutcount>0)if(t.DeliveryForm.outcount-t.DeliveryList.noOutcount>0){var e={deliverGoodsList:[{orderDetailsId:t.DeliveryList.id,outcount:t.DeliveryList.noOutcount,warehouseId:t.DeliveryList.factoryid}],optId:t.userId};Object(l["m"])(e).then((function(e){200===e.code?(t.$message({type:"success",message:e.data}),t.getTable(t.paramData),t.dialogPromptDelivery=!1):t.$message({type:"warning",message:e.data})}))}else{var a={deliverGoodsList:[{orderDetailsId:t.DeliveryList.id,outcount:t.outcount,warehouseId:t.DeliveryList.factoryid}],optId:t.userId};Object(l["m"])(a).then((function(e){200===e.code?(t.$message({type:"success",message:e.data}),t.getTable(t.paramData),t.dialogPromptDelivery=!1):t.$message({type:"warning",message:e.data})}))}else if(0===t.DeliveryList.noOutcount&&t.DeliveryList.outnum>0){var i={deliverGoodsList:[{orderDetailsId:t.DeliveryList.id,outcount:0,warehouseId:t.DeliveryList.factoryid}],optId:t.userId};Object(l["m"])(i).then((function(e){200===e.code?(t.$message({type:"success",message:e.data}),t.getTable(t.paramData),t.dialogPromptDelivery=!1):t.$message({type:"warning",message:e.data})}))}})).catch((function(){t.$message({type:"info",message:"已取消出库发货"})}))},clickExport:function(){var t=this,e=this.formQuery;e.paramStr="开始时间："+e.startDate+",结束时间："+e.endDate;var a=Object(n["a"])({},e);delete a.value2,a.customerName||delete a.customerName,e.startDate&&e.endDate?Object(l["n"])(a).then((function(e){200===e.code&&(t.ExportHints=e.data,t.dialogExport=!0)})):this.$message({type:"warning",message:"请选择导出的时间跨度 ^_^"})},dialogExportClick:function(){this.dialogExport=!1,this.$message({type:"success",message:"操作成功"})},GoodsFocus:function(){var t=localStorage.getItem("data");t&&(this.optionsGoods=JSON.parse(t),this.historydata(JSON.parse(t)))},removalDuplicate:function(t){for(var e=0;e<t.length;e++){var a=t[e];if(""!==a)for(var i=e+1;i<t.length;i++)t[e].id===t[i].id&&t.splice(e,1)}return t},historydata:function(t){this.optionsGoods=[];var e=localStorage.getItem("data");this.optionsGoods=JSON.parse(e),t.length>this.max_history&&this.optionsGoods.splice(this.max_history)},init:function(){}},mounted:function(){},name:"CustomerManagement-ShippingLogistics",activated:function(){var t=this;setTimeout((function(){t.$refs.TableData.bodyWrapper.scrollTop=t.scrollTop,t.$refs.TableData.bodyWrapper.scrollLeft=t.scrollLeft}),60)},beforeRouteLeave:function(t,e,a){this.scrollTop=this.$refs.TableData.bodyWrapper.scrollTop,this.scrollLeft=this.$refs.TableData.bodyWrapper.scrollLeft,a()}},I=x,k=(a("6807"),Object(y["a"])(I,i,s,!1,null,"153600f1",null));e["default"]=k.exports},"322b":function(t,e,a){"use strict";a("f917")},"5d65":function(t,e,a){"use strict";a("8b70")},6807:function(t,e,a){"use strict";a("ab34")},"8b70":function(t,e,a){},ab34:function(t,e,a){},b542:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ModifyItem"},[a("el-dialog",{attrs:{visible:t.sync,title:"发货锁单",width:"45%","destroy-on-close":""},on:{"update:visible":function(e){t.sync=e},open:t.init},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span",{staticClass:"dialog-footer"},[a("el-button",{on:{click:function(e){t.sync=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submitSuppler}},[t._v("发货锁单")])],1)]},proxy:!0}])},[a("el-form",[a("div",{staticStyle:{display:"flex"}},[a("p",{staticStyle:{width:"60%",margin:"0","margin-right":"15px"}},[a("span",{},[t._v("商品名称：")]),t._v(t._s(t.rowData.namecode))]),a("p",{staticStyle:{width:"30%",margin:"0"}},[a("span",{},[t._v("规格：")]),t._v(t._s(t.rowData.specif))]),a("p",{staticStyle:{width:"30%",margin:"0"}},[a("span",{},[t._v("单位：")]),t._v(t._s(t.rowData.unit))])]),a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("p",{staticStyle:{width:"200px"}},[a("span",{},[t._v("计划锁单数：")]),t._v(t._s(t.rowData.unLockNum))]),a("p",{staticStyle:{width:"200px"},style:{color:t.ShuntData.num!==t.rowData.unLockNum?"red":"#999"}},[a("span",[t._v("已选数量：")]),t._v(t._s(t.ShuntData.num||0))])])]),a("div",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.ShuntData.load,expression:"ShuntData.load"}],ref:"ShuntDataTable",staticStyle:{},attrs:{data:t.tableData,stripe:"",border:"","max-height":"400"},on:{"selection-change":t.ShuntSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{property:"optdate",label:"入库时间","min-width":"140"}}),a("el-table-column",{attrs:{property:"producedDate",label:"生产日期","min-width":"140"}}),a("el-table-column",{attrs:{property:"unit",label:"单位"}}),a("el-table-column",{attrs:{property:"inventory",label:"库存数"}}),a("el-table-column",{attrs:{property:"--",label:"发货锁单数量",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{key:e.row.id,class:{numberRed:!e.row.isSlection&&t.ShuntData.num>t.rowData.num_3},staticStyle:{width:"100%"},attrs:{type:"number",disabled:e.row.isSlection,"controls-position":"right"},on:{input:t.countNum},model:{value:e.row.num,callback:function(a){t.$set(e.row,"num",a)},expression:"scope.row.num"}}),a("el-input-number",{staticStyle:{display:"none"},attrs:{min:0,max:e.row.Maxnum},model:{value:e.row.num,callback:function(a){t.$set(e.row,"num",a)},expression:"scope.row.num"}}),e.row.num>e.row.inventory&&!e.row.isSlection?a("span",{staticStyle:{"font-size":"12px",color:"red"}},[t._v("填写值不能大于库存数")]):t._e()]}}])})],1)],1)],1),a("el-dialog",{attrs:{visible:t.UnlockData.sync,title:"发货解锁",width:"38%","destroy-on-close":""},on:{"update:visible":function(e){return t.$set(t.UnlockData,"sync",e)},open:t.init2},scopedSlots:t._u([{key:"footer",fn:function(){return[a("span",{staticClass:"dialog-footer",attrs:{center:""}},[a("el-button",{on:{click:function(e){t.UnlockData.sync=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.toUnlock}},[t._v("确认")])],1)]},proxy:!0}])},[a("el-form",[a("div",{staticStyle:{display:"flex"}},[a("p",{staticStyle:{width:"100%",margin:"0","margin-right":"15px"}},[a("span",{},[t._v("商品名称：")]),t._v(t._s(t.rowData.namecode))])]),a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("p",{staticStyle:{width:"35%",margin:"0"}},[a("span",{},[t._v("规格：")]),t._v(t._s(t.rowData.specif))]),a("p",{staticStyle:{width:"25%",margin:"0"}},[a("span",{},[t._v("单位：")]),t._v(t._s(t.rowData.unit))]),a("p",{staticStyle:{width:"160px"}},[a("span",{},[t._v("待发货数：")]),t._v(t._s(t.rowData.num))]),a("p",{staticStyle:{width:"160px"}},[a("span",{},[t._v("可解锁最大值：")]),t._v(t._s(t.num_2))])])]),a("div",[a("el-form",[a("el-form-item",{attrs:{label:"解锁数量:"}},[a("el-input-number",{class:{numberRed:t.num_2<t.UnlockData.num},staticStyle:{width:"200px"},attrs:{min:0,label:"请输入解锁数量"},on:{change:t.change_maxNum},model:{value:t.UnlockData.num,callback:function(e){t.$set(t.UnlockData,"num",e)},expression:"UnlockData.num"}})],1)],1)],1)],1)],1)},s=[],n=a("5530"),r=(a("d3b7"),a("159b"),a("99af"),a("b64b"),a("95a0")),o=a("2f62"),l={components:{},props:{rowData:{type:Object||Array,default:{}}},data:function(){return{UnlockData:{sync:!1,row:{},num:0,maxNum:1/0},num_2:"",ShuntSelecArr:[],ShuntSelecId:[],ShuntData:{sync:!1,row:{},goods:{},factory:{},list:[],seleId:[],load:!1,num:0},total:0,radioIdex:"",formQuery:{productName:"",skuCode:""},loadingTab:!1,paramData:{},sync:!1,tableData:[],supplerData:{}}},created:function(){},computed:Object(n["a"])({},Object(o["c"])({roles:"roles",userId:"user/userId",name:"user/name"})),methods:{change_maxNum:function(t){},countNum:function(){var t=0;this.tableData.length&&this.tableData.forEach((function(e){e.isSlection||(t=(1e4*t+1e4*e.num)/1e4)})),this.ShuntData.num=t},toUnlock:function(){var t=this;if(this.UnlockData.num<=0)this.$message.error("填写数量不能为0");else if(this.num_2<this.UnlockData.num)this.$message.error("填写数量不能大于可解锁最大数");else{var e=Math.round(this.count_price2(this.UnlockData.num,this.rowData.unitbit)),a={I_ids:this.rowData.id+"-"+e,I_optuser:this.userId,I_sId:this.rowData.orderId,I_inType:100705};this.$confirm("你确定要对当前的锁单发货进行解锁吗？","提示",{confirmButtonText:"确定",type:"warning"}).then((function(){t.set_Return_stock_api(a,e)})).catch((function(){}))}},set_Return_stock_api:function(t,e){var a=this,i={detailId:this.rowData.detailId,num:e};Object(r["d"])(t).then((function(t){200===t.code&&(t.data[0].flag>0&&t.data[0].flag>=a.ShuntSelecArr.length?(a.$message.success("操作成功"),a.set_updateDeliveryDetail(i)):a.$message.success(t.data[0].result))}))},set_updateDeliveryDetail:function(t){var e=this;Object(r["y"])(t).then((function(t){200===t.code&&(e.UnlockData.sync=!1,e.$emit("ToUpDate",3))}))},ShuntSelectionChange:function(t){var e=this;this.ShuntSelecArr=t||[],this.ShuntSelecId=[],this.ShuntData.num=0,this.tableData.forEach((function(t){t.isSlection=!0})),this.ShuntSelecArr.forEach((function(t){e.ShuntSelecId.push(t.id),t.isSlection=!1})),this.countNum()},supplerRadio:function(t){},submitSuppler:function(){var t=this;if(this.ShuntSelecArr.length)if(this.ShuntData.num<=0)this.$message.error("已选数量不能为0！");else{var e={deliverDetailId:this.rowData.detailId,optId:this.userId,orderDetailId:this.rowData.orderId,outboundInfos:[],warehouseId:this.rowData.warehouseId},a=[],i="";this.ShuntSelecArr.forEach((function(e){e.inventory<e.num&&(i="填写数量不能大于库存");var s=Math.round(t.count_price2(e.num,t.rowData.unitbit));a.push({id:e.id,num:s})})),i?this.$message.error(i):(e.outboundInfos=e.outboundInfos.concat(a),this.$confirm("你确定要进行发货锁单操作吗？","提示",{confirmButtonText:"确定",type:"warning"}).then((function(){t.set_outboundDeliver(e)})))}else this.$message.error("请选择要发货锁单的数据！")},set_outboundDeliver:function(t){var e=this;Object(r["v"])(t).then((function(t){200===t.code&&(e.sync=!1,e.$emit("ToUpDate",3))}))},handleSizeChange:function(t){this.paramData.pageSize=t,this.clickCurrentChange(1)},clickCurrentChange:function(t){this.paramData.page=t,this.getTabel(this.paramData)},onSubmit:function(){var t=Object(n["a"])(Object(n["a"])({},this.paramData),this.formQuery);Object.keys(t).forEach((function(e){var a=t[e];""===a&&delete t[e]})),this.getTabel(t)},getTabel:function(t){var e=this;this.paramData=t,this.loadingTab=!0,Object(r["k"])(t).then((function(t){if(e.loadingTab=!1,200===t.code){t.data.length||e.$message.error("没有查找到对应的记录！"),e.total=t.data.total;e.rowData.num_3;t.data.forEach((function(t,e){t.Maxnum=1/0,t.num=0,t.isSlection=!0})),e.tableData=t.data}}))},init2:function(){this.UnlockData.row=this.rowData,this.UnlockData.num=0,this.num_2=this.rowData.num_2>this.rowData.maxNum?this.rowData.maxNum:this.rowData.num_2},init:function(){this.paramData.orderId=this.rowData.orderId,this.paramData.warehouseId=this.rowData.warehouseId,this.paramData.productId=this.rowData.productId||"",this.onSubmit()}}},c=l,u=(a("bb4e"),a("2877")),d=Object(u["a"])(c,i,s,!1,null,null,null);e["a"]=d.exports},bb4e:function(t,e,a){"use strict";a("dc29")},cd7f:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{display:"inline-block"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.uploadUrl,multiple:!0,"list-type":t.list_type,name:"multipartFiles","file-list":t.fileList,limit:t.NumMax,"on-preview":t.handlePictureCardPreview,"on-remove":t.handleRemove,"on-exceed":t.limitExceed,"on-success":t.handleAvatarSuccess,"show-file-list":t.showFileList,"before-upload":t.beforeAvatarUpload}},["text"===t.list_type?a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})],1),a("el-dialog",{attrs:{"append-to-body":"",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1)},s=[],n=(a("a9e3"),a("d3b7"),a("159b"),a("b0c0"),a("99af"),a("2cd9")),r={props:{showFileList:{type:Boolean,default:!0},NumMax:{type:Number,default:3},ImgIndex:{type:Number,default:0},setfileList:{type:Array||String,default:[]},width_max:{type:String,default:"148"},list_type:{type:String,default:"picture-card"}},data:function(){return{dialogImageUrl:"",dialogVisible:!1,logourl:!1,imageUrl:"",uploadUrl:n["b"],fileList:[],imageurlArr:[]}},created:function(){this.file_list_init(this.setfileList)},methods:{file_list_init:function(t){var e=this;this.fileList=[],t.forEach((function(t){e.fileList.push({name:t,url:t,response:{data:t}})}))},limitExceed:function(){this.$message.error("当前最多只能上传"+this.NumMax+"张图片")},handleRemove:function(t,e){var a=this;this.imageurlArr=[],e.forEach((function(t){a.imageurlArr.push(t.response.data[0])})),this.$emit("change",this.imageurlArr,1,this.ImgIndex)},handlePictureCardPreview:function(t,e){this.dialogImageUrl=t.url,this.dialogVisible=!0},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type,a=t.size/1024/1024<2,i=t.name.indexOf(",");return i>=0?(this.$message.error("检查到文件名包含了，号"),!1):(e||this.$message.error("上传图片只能是 JPG 或 PNG格式!"),a||this.$message.error("上传图片大小不能超过 2MB!"),e&&a)},getCaption:function(t){var e=t.lastIndexOf(".");return t=t.substring(e+1,t.length),t},getName:function(){for(var t="",e=0;e<4;e++)t+=Math.floor(10*Math.random());return t=(new Date).getTime()+t,t},handleAvatarSuccess:function(t){this.imageurlArr=this.imageurlArr.concat(t.data),this.$emit("change",this.imageurlArr,1,this.ImgIndex)}}},o=r,l=(a("322b"),a("2877")),c=Object(l["a"])(o,i,s,!1,null,null,null);e["a"]=c.exports},dc29:function(t,e,a){},f917:function(t,e,a){}}]);